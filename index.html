<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://yoursite.com">
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="GoatWu">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/assets/images/timg.jpeg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/">GoatWu</a></h1>
		</hgroup>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/tags/ACM/">ACM</a></li>
	        
				<li><a href="/tags/%E6%95%B0%E5%AD%A6%E6%A8%A1%E7%89%88/">数学模版</a></li>
	        
				<li><a href="/tags/%E6%AF%94%E8%B5%9B%E9%A2%98%E8%A7%A3/">比赛题解</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/GoatWu" title="github"><i class="icon-github"></i></a>
		        
					<a class="mail" target="_blank" href="mailto: goatwu@qq.com" title="mail"><i class="icon-mail"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/assets/images/timg.jpeg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">GoatWu</h1>
			</hgroup>
			
			
			
				
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/GoatWu" title="github"><i class="icon-github"></i></a>
			        
						<a class="mail" target="_blank" href="mailto: goatwu@qq.com" title="mail"><i class="icon-mail"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 25%"><a href="/">主页</a></li>
		        
					<li style="width: 25%"><a href="/tags/ACM/">ACM</a></li>
		        
					<li style="width: 25%"><a href="/tags/%E6%95%B0%E5%AD%A6%E6%A8%A1%E7%89%88/">数学模版</a></li>
		        
					<li style="width: 25%"><a href="/tags/%E6%AF%94%E8%B5%9B%E9%A2%98%E8%A7%A3/">比赛题解</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-2019银川区域赛题解" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/12/2019%E9%93%B6%E5%B7%9D%E5%8C%BA%E5%9F%9F%E8%B5%9B%E9%A2%98%E8%A7%A3/">2019银川区域赛题解</a>
    </h1>
  

        
        <a href="/2020/03/12/2019%E9%93%B6%E5%B7%9D%E5%8C%BA%E5%9F%9F%E8%B5%9B%E9%A2%98%E8%A7%A3/" class="archive-article-date">
  	<time datetime="2020-03-11T20:29:06.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2020-03-12</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="2019-ICPC银川区域赛题解"><a href="#2019-ICPC银川区域赛题解" class="headerlink" title="2019 ICPC银川区域赛题解"></a>2019 ICPC银川区域赛题解</h1><p>——大概是史上最全的版本！</p>
<h3 id="A-Girls-Band-Party"><a href="#A-Girls-Band-Party" class="headerlink" title="A. Girls Band Party"></a>A. Girls Band Party</h3><p><a href="https://nanti.jisuanke.com/t/42381" target="_blank" rel="noopener">题目链接</a></p>
<h5 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h5><p>You are currently playing a game called “Garupa”. In an event of the game, you are trying to get more event points. You have nn cards, each with its own name, color, and power. When you play the game, you can put five cards of different names into your deck. The base point of this event is the sum of the power of the cards in your deck. On top of that, the event publishes a color and five names as bonus attributes, which means that each time you have a card with a bonus color in the deck, you end up with a $20%$ increase in event point. And each time you have a card with a bonus name in the deck, you will eventually get $10%$ of the event point (bonus values are calculated by addition, and we round down when calculating the final event point). Please find the maximum event point you will eventually get.</p>
<h5 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h5><p>The first line is an integer $T(1 \leq T \leq 50)$, which is the number of test cases.</p>
<p>For each set of input data, input a positive integer $n(5 \leq n \leq 100000)$ in the first line to indicate the number of cards you have.</p>
<p>The next nn lines, the ii-th line input two strings $name_i$, $color_i$ and a positive integer $power_i(1 \leq power_i \leq 50000)$ separated by spaces, indicating the name, color, and power of the $i$-th card. The input data ensures that there are at least five cards with different names.</p>
<p>The next line input five strings representing the five bonus names. The input data guarantees that the bonus names are different.</p>
<p>The last line input a string representing a bonus color.</p>
<p>The input data ensures that all strings consist of only uppercase and lowercase letters and the max length of them is $10$, and the sum of $n$ in all sets of input data does not exceed $1500000$.</p>
<h5 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h5><p>每个卡片有一个名字、一个颜色和一个权值。有5种名字的卡片能带来$10%$的加成，有1种颜色的卡片能带来$20%$的加成。<br>让你从n张卡片里选择<strong>名字不同</strong>的5张卡片。总加成初始为1，若选择的卡片名字出现在5种加成名字中，则总加成$+10%$，若选择的卡片颜色与加成颜色一样，则总加成$+20%$；基础得分为5张卡片的权值之和，$总得分=基础得分 * 总加成之和$，求最大总得分。</p>
<h5 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h5><p>For each set of data, output only one line of a positive integer, indicating the maximum number of bonus points that you will eventually get.</p>
<h5 id="样例输入"><a href="#样例输入" class="headerlink" title="样例输入"></a>样例输入</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">6</span><br><span class="line">Saaya Power 45000</span><br><span class="line">Kokoro Happy 45000</span><br><span class="line">Kasumi Cool 45000</span><br><span class="line">Rimi Power 45000</span><br><span class="line">Aya Pure 45000</span><br><span class="line">Aya Power 2000</span><br><span class="line">Saaya Tae Kasumi Rimi Arisa</span><br><span class="line">Power</span><br></pre></td></tr></table></figure>
<h5 id="样例输出"><a href="#样例输出" class="headerlink" title="样例输出"></a>样例输出</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">382500</span><br></pre></td></tr></table></figure>
<h5 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h5><p>所有的牌都可以分为4类<br>1：名字没有加成，颜色没有加成<br>2：名字有加成，颜色没有加成<br>3：名字没有加成，颜色有加成<br>4：名字有加成，颜色有加成</p>
<p>把类别相同的都放在同一个数组中，把每个数组都按照power从大到小排序。对每个数组去重，每个名字只保留power最高的。<br>设最后的四个数组为V[1],V[2],V[3],V[4]，然后爆搜即可：<br>每次从V[0],V[1],V[2],V[3]中选取一张牌，优先选power最高的，如果名字重复就跳过。<br>详细过程见代码与注释。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> T, n;</span><br><span class="line"><span class="keyword">double</span> ans;</span><br><span class="line"><span class="comment">//totn为不同的name个数，totc为不同的color个数</span></span><br><span class="line"><span class="keyword">int</span> totn, totc;</span><br><span class="line"><span class="built_in">string</span> ss;</span><br><span class="line"><span class="comment">//mpn, mpc分别用来把name、color用数字进行映射代替</span></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; mpn, mpc;</span><br><span class="line"><span class="keyword">int</span> rwdn[<span class="number">6</span>], tr, rwdc;<span class="comment">//记录加成名字的标号、加成颜色的标号</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Info</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> nam, col, pwr;</span><br><span class="line">&#125;a[MAXN], v[<span class="number">5</span>][MAXN];</span><br><span class="line"><span class="keyword">int</span> tot[<span class="number">5</span>];</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> 1: none;</span></span><br><span class="line"><span class="comment"> 2: name;</span></span><br><span class="line"><span class="comment"> 3: color;</span></span><br><span class="line"><span class="comment"> 4: both;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp1</span><span class="params">(Info a, Info b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.nam == b.nam ? a.pwr &gt; b.pwr : a.nam &lt; b.nam;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp2</span><span class="params">(Info a, Info b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.pwr &gt; b.pwr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; usd;</span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;::iterator it;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> dep, <span class="keyword">int</span> cntn, <span class="keyword">int</span> cntc, <span class="keyword">int</span> pwr, <span class="keyword">int</span> i1, <span class="keyword">int</span> i2, <span class="keyword">int</span> i3, <span class="keyword">int</span> i4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//参数意义：搜索深度，name加成个数，color加成个数，当前总power，四个数组选择到了哪里</span></span><br><span class="line">    <span class="keyword">if</span>(dep == <span class="number">6</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ans = max(ans, (<span class="number">1.0</span> + <span class="number">0.1</span> * cntn + <span class="number">0.2</span> * cntc) * pwr);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(i1 &lt;= tot[<span class="number">1</span>] &amp;&amp; usd.find(v[<span class="number">1</span>][i1].nam) == usd.end())</span><br><span class="line">    &#123;</span><br><span class="line">        usd.insert(v[<span class="number">1</span>][i1].nam);</span><br><span class="line">        dfs(dep+<span class="number">1</span>, cntn, cntc, pwr+v[<span class="number">1</span>][i1].pwr, i1+<span class="number">1</span>, i2, i3, i4);</span><br><span class="line">        usd.erase(v[<span class="number">1</span>][i1].nam);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(i1+<span class="number">1</span> &lt;= tot[<span class="number">1</span>]) dfs(dep, cntn, cntc, pwr, i1+<span class="number">1</span>, i2, i3, i4);</span><br><span class="line">    <span class="keyword">if</span>(i2 &lt;= tot[<span class="number">2</span>] &amp;&amp; usd.find(v[<span class="number">2</span>][i2].nam) == usd.end())</span><br><span class="line">    &#123;</span><br><span class="line">        usd.insert(v[<span class="number">2</span>][i2].nam);</span><br><span class="line">        dfs(dep+<span class="number">1</span>, cntn+<span class="number">1</span>, cntc, pwr+v[<span class="number">2</span>][i2].pwr, i1, i2+<span class="number">1</span>, i3, i4);</span><br><span class="line">        usd.erase(v[<span class="number">2</span>][i2].nam);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(i2+<span class="number">1</span> &lt;= tot[<span class="number">2</span>]) dfs(dep, cntn, cntc, pwr, i1, i2+<span class="number">1</span>, i3, i4);</span><br><span class="line">    <span class="keyword">if</span>(i3 &lt;= tot[<span class="number">3</span>] &amp;&amp; usd.find(v[<span class="number">3</span>][i3].nam) == usd.end())</span><br><span class="line">    &#123;</span><br><span class="line">        usd.insert(v[<span class="number">3</span>][i3].nam);</span><br><span class="line">        dfs(dep+<span class="number">1</span>, cntn, cntc+<span class="number">1</span>, pwr+v[<span class="number">3</span>][i3].pwr, i1, i2, i3+<span class="number">1</span>, i4);</span><br><span class="line">        usd.erase(v[<span class="number">3</span>][i3].nam);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(i3+<span class="number">1</span> &lt;= tot[<span class="number">3</span>]) dfs(dep, cntn, cntc, pwr, i1, i2, i3+<span class="number">1</span>, i4);</span><br><span class="line">    <span class="keyword">if</span>(i4 &lt;= tot[<span class="number">4</span>] &amp;&amp; usd.find(v[<span class="number">4</span>][i4].nam) == usd.end())</span><br><span class="line">    &#123;</span><br><span class="line">        usd.insert(v[<span class="number">4</span>][i4].nam);</span><br><span class="line">        dfs(dep+<span class="number">1</span>, cntn+<span class="number">1</span>, cntc+<span class="number">1</span>, pwr+v[<span class="number">4</span>][i4].pwr, i1, i2, i3, i4+<span class="number">1</span>);</span><br><span class="line">        usd.erase(v[<span class="number">4</span>][i4].nam);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(i4+<span class="number">1</span> &lt;= tot[<span class="number">4</span>]) dfs(dep, cntn, cntc, pwr, i1, i2, i3, i4+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    totn = totc = tr = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(tot, <span class="number">0</span>, <span class="keyword">sizeof</span>(tot));</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    mpn.clear(); mpc.clear();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">        	<span class="comment">//对名字、颜色进行映射标号</span></span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; ss;</span><br><span class="line">            <span class="keyword">if</span>(mpn[ss]) a[i].nam = mpn[ss];</span><br><span class="line">            <span class="keyword">else</span> a[i].nam = mpn[ss] = ++totn;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; ss;</span><br><span class="line">            <span class="keyword">if</span>(mpc[ss]) a[i].col = mpc[ss];</span><br><span class="line">            <span class="keyword">else</span> a[i].col = mpc[ss] = ++totc;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i].pwr);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">        	<span class="comment">//对加成name进行标号（未出现过则无意义，不标号）</span></span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; ss;</span><br><span class="line">            <span class="keyword">if</span>(mpn[ss]) rwdn[++tr] = mpn[ss];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; ss;</span><br><span class="line">        <span class="comment">//对加成color标号，若不存在则标-1</span></span><br><span class="line">        rwdc = mpc[ss] ? mpc[ss] : <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">        	<span class="comment">//将每张卡片分类（标准见上）</span></span><br><span class="line">            <span class="keyword">int</span> flag = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tr; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(a[i].nam == rwdn[j])</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(a[i].col == rwdc) v[<span class="number">4</span>][++tot[<span class="number">4</span>]] = a[i];</span><br><span class="line">                    <span class="keyword">else</span> v[<span class="number">2</span>][++tot[<span class="number">2</span>]] = a[i];</span><br><span class="line">                    flag = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(flag)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(a[i].col == rwdc) v[<span class="number">3</span>][++tot[<span class="number">3</span>]] = a[i];</span><br><span class="line">                <span class="keyword">else</span> v[<span class="number">1</span>][++tot[<span class="number">1</span>]] = a[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">4</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> sz = tot[i];</span><br><span class="line">            tot[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//按照name优先、power次优的顺序排序，这样相同的名字都排在了一起，第一个为power最大的</span></span><br><span class="line">            sort(v[i]+<span class="number">1</span>, v[i]+<span class="number">1</span>+sz, cmp1);</span><br><span class="line">            <span class="comment">//去重：同类型且同名的，power较小的肯定不选</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= sz; j++) <span class="keyword">if</span>(v[i][j].nam != v[i][j<span class="number">-1</span>].nam) v[i][++tot[i]] = v[i][j];</span><br><span class="line">            <span class="comment">//按照power从小到大重新排序</span></span><br><span class="line">            sort(v[i]+<span class="number">1</span>, v[i]+<span class="number">1</span>+tot[i], cmp2);</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> opt = <span class="keyword">int</span>(ans);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, opt);</span><br><span class="line">        clear();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="B-So-Easy"><a href="#B-So-Easy" class="headerlink" title="B. So Easy"></a>B. So Easy</h3><p><a href="https://nanti.jisuanke.com/t/42382" target="_blank" rel="noopener">题目链接</a></p>
<h5 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h5><p>Mr. G invents a new game whose rules are given as follows.</p>
<p>Firstly, he has a $n \times n$ matrix, all elements of which are $0$ initially. Then, he follows up with some operations: in each time he chooses a row or a column, and adds an arbitrary positive integer to all the elements in the selected row or column. When all operations have been finished, he hides an element in the matrix and the element is modified to $-1$.</p>
<p>Now given the final matrix, you are asked to find out what the hidden element should be before the very last hiding operation.</p>
<h5 id="题目大意-1"><a href="#题目大意-1" class="headerlink" title="题目大意"></a>题目大意</h5><p>一个初始为 $n\times n$ 的矩阵初始全为$0$，经过数次操作（每次操作可以将一行或者一列全都加上一个正整数）后得到了一个最终矩阵。现在把这个矩阵的一个元素改成$-1$后给你，求这个元素原先是多少。</p>
<h5 id="Input-1"><a href="#Input-1" class="headerlink" title="Input"></a>Input</h5><p>The first line contains a single integer $n(2 \leq n \leq 1000)$.</p>
<p>Next n lines represent the matrix after the operations. Each element in the matrix satisfies $-1 \leq a_{i,j} \leq 1000000$, and exactly one element is $-1$.</p>
<h5 id="Output-1"><a href="#Output-1" class="headerlink" title="Output"></a>Output</h5><p>Output a single integer, the hidden element.</p>
<h5 id="样例输入-1"><a href="#样例输入-1" class="headerlink" title="样例输入"></a>样例输入</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">1 2 1</span><br><span class="line">0 -1 0</span><br><span class="line">0 1 0</span><br></pre></td></tr></table></figure>
<h5 id="样例输出-1"><a href="#样例输出-1" class="headerlink" title="样例输出"></a>样例输出</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure>
<h5 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h5><p>设最终矩阵为A。先将A每行都减去其最小值，得到B；再将B每列都减去其最小值，得到C。C应为零矩阵。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[MAXN][MAXN];</span><br><span class="line"><span class="keyword">int</span> x, y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i][j]);</span><br><span class="line">			<span class="keyword">if</span>(a[i][j] == <span class="number">-1</span>) &#123;x = i; y = j;&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	a[x][y] = INF;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> minn = <span class="number">1e9</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) minn = min(minn, a[i][j]);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) a[i][j] -= minn;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> minn = <span class="number">1e9</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) minn = min(minn, a[i][j]);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i][j] -= minn;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, INF - a[x][y]);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="D-Easy-Problem"><a href="#D-Easy-Problem" class="headerlink" title="D. Easy Problem"></a>D. Easy Problem</h3><p><a href="https://nanti.jisuanke.com/t/42384" target="_blank" rel="noopener">题目链接</a></p>
<h5 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h5><p>A sequence $(a_{1},a_{2},…,a_{n})$ is $(n,m,d)$-good if $1 \leq a_{i} \leq m(1 \le i \le n)$ and $\gcd(a_{1},a_{2},\cdots,a_{n})=d$.</p>
<p>Given four integers $n, m, d$ and $k$, you are asked to calculate the sum of $f(q, k)$ for each (n, m, d)-good sequence $q$, where $f((a_{1},a_{2},…a_{n}),k) = (a_{1}a_{2} \cdots a_{n})^{k}$ for the sequence $q = (a_{1},a_{2},…a_{n})$.</p>
<p>Since the answer could be very large, you only need to output the answer modulo $59964251$.</p>
<h5 id="Input-2"><a href="#Input-2" class="headerlink" title="Input"></a>Input</h5><p>The first line is an integer $T(1 \leq T \leq 20)$, which is the number of test cases.</p>
<p>For each test case, the first line contains four integers $n(1 \leq n \leq 10^{100000}), m(1 \leq m \leq 100000), d(1 \leq d \leq 100000), k(1 \leq k \leq 10^9)$, which are described in the problem description.</p>
<h5 id="Output-2"><a href="#Output-2" class="headerlink" title="Output"></a>Output</h5><p>For each test case, output a line containing a single integer.</p>
<h5 id="样例输入-2"><a href="#样例输入-2" class="headerlink" title="样例输入"></a>样例输入</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">3 3 3 1</span><br></pre></td></tr></table></figure>
<h5 id="样例输出-2"><a href="#样例输出-2" class="headerlink" title="样例输出"></a>样例输出</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">27</span><br></pre></td></tr></table></figure>
<h5 id="题解-2"><a href="#题解-2" class="headerlink" title="题解"></a>题解</h5><h6 id="step1"><a href="#step1" class="headerlink" title="step1"></a>step1</h6><p>由于 $\gcd(a_{1},a_{2},\cdots,a_{n})=d$，因此我们可以将每个数提出一个$d$，在式子外面乘上一个$(d^k)^n$。<br>剩下可选取的数：</p>
<p>$$\begin{bmatrix}\lfloor \frac{m}{d}\rfloor&amp;\lfloor \frac{m}{d}\rfloor&amp;…&amp;\lfloor \frac{m}{d}\rfloor &amp; \lfloor \frac{m}{d}\rfloor\cr …&amp;…&amp;…&amp;…&amp;… \cr 3 &amp; 3 &amp; … &amp; 3 &amp; 3 \cr 2 &amp; 2 &amp; … &amp; 2 &amp; 2\cr 1 &amp; 1 &amp; … &amp; 1 &amp; 1\cr \end{bmatrix}$$</p>
<h6 id="step2"><a href="#step2" class="headerlink" title="step2"></a>step2</h6><p>由分配律，<br>$$\sum(a_{1}a_{2} \cdots a_{n})^{k}=\bigg(\sum_{i=1}^{\lfloor \frac{m}{d}\rfloor}i^k\bigg)^n$$</p>
<h6 id="step3"><a href="#step3" class="headerlink" title="step3"></a>step3</h6><p>考虑到 $\gcd(a_{1},a_{2},\cdots,a_{n})\not= 1$ 的情况，我们容易发现这是一个和约数有关的容斥原理，即容斥系数应当是莫比乌斯函数！<br>详细证明见：<a href="https://blog.csdn.net/weixin_43061340/article/details/96931899" target="_blank" rel="noopener">XMU区域赛选拔 D.塔子哥数数</a><br>对于 $\gcd(a_{1},a_{2},\cdots,a_{n})= b$, 剩下可选的数：<br>$$\begin{bmatrix}\lfloor \frac{m}{bd}\rfloor&amp;\lfloor \frac{m}{bd}\rfloor&amp;…&amp;\lfloor \frac{m}{bd}\rfloor &amp; \lfloor \frac{m}{bd}\rfloor\cr …&amp;…&amp;…&amp;…&amp;… \cr 3b &amp; 3b &amp; … &amp; 3b &amp; 3b\cr 2b &amp; 2b &amp; … &amp; 2b &amp; 2b \cr b &amp; b &amp;…&amp; b &amp; b\cr \end{bmatrix}$$<br>$$\sum(a_{1}a_{2} \cdots a_{n})^{k}=\left(\bigg(\sum_{i=1}^{\lfloor \frac{m}{bd}\rfloor}i^k\bigg)b^k\right)^n$$</p>
<h6 id="step4"><a href="#step4" class="headerlink" title="step4"></a>step4</h6><p>$$ans=(d^k)^n\sum_{i=1}^{\lfloor \frac{m}{d}\rfloor}\mu(i)\left(\bigg(\sum_{j=1}^{\lfloor \frac{m}{id}\rfloor}j^k\bigg)i^k\right)^n$$<br>我们注意到$n$只出现于指数上，由扩展欧拉定理，可以在读入$n$时对$\varphi(mod)$取模；对于每次询问，我们可以$O(m)$预处理出 $k^1,k^2,…,k^m$ ，以及其前缀和。计算时，对于内层括号里的东西我们就可以$O(1)$求，再跑一个快速幂，总体复杂度$O(T * mlog_n)$。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">59964251</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> phi = <span class="number">59870352</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> T, n, m, d, k;</span><br><span class="line"><span class="keyword">char</span> s[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> maxup;</span><br><span class="line"><span class="keyword">int</span> powk[MAXN], sumpowk[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getmod</span><span class="params">(<span class="keyword">int</span> mo)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">0</span>; <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c = getchar()));</span><br><span class="line">    <span class="keyword">for</span>(; <span class="built_in">isdigit</span>(c); c = getchar())</span><br><span class="line">    &#123;</span><br><span class="line">        b = b * <span class="number">10</span> + c - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span>(b &gt;= mo) b %= mo;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = a + b;</span><br><span class="line">    <span class="keyword">if</span>(ret &gt; mod) ret -= mod;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1L</span>L * a * a % mod) <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ret = <span class="number">1L</span>L * ret * a % mod;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mu[MAXN], prime[MAXN], num[MAXN], tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!num[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[++tot] = i;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * prime[j] &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            num[i*prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j]) mu[i*prime[j]] = -mu[i];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                mu[i*prime[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    maxup = m / d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxup; i++) powk[i] = ksm(i, k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxup; i++) sumpowk[i] = add(sumpowk[i<span class="number">-1</span>], powk[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxup; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp1 = maxup / i;</span><br><span class="line">        <span class="keyword">int</span> tmp2 = <span class="number">1L</span>L * sumpowk[tmp1] * powk[i] % mod;</span><br><span class="line">        <span class="keyword">int</span> tmp3 = ksm(tmp2, n);</span><br><span class="line">        (sum += mod + tmp3 * mu[i]) %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">1L</span>L * n * k % phi;</span><br><span class="line">    sum = <span class="number">1L</span>L * sum * ksm(d, b) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    pre();</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        n = getmod(phi);</span><br><span class="line">        <span class="keyword">if</span>(!n) n = phi;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;m, &amp;d, &amp;k);</span><br><span class="line">        k %= phi;</span><br><span class="line">        <span class="keyword">if</span>(!k) k = phi;</span><br><span class="line">        init();</span><br><span class="line">        work();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="F-Function"><a href="#F-Function" class="headerlink" title="F. Function!"></a>F. Function!</h3><p><a href="https://nanti.jisuanke.com/t/42386" target="_blank" rel="noopener">题目链接</a></p>
<h5 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h5><p>Define the function</p>
<p>$$\displaystyle f_a\left( x \right) = a^x(a &gt; 0 \wedge a \neq 1)$$ for all $x \in (-\infty, +\infty)$.</p>
<p>You are asked to calculate the value of</p>
<p>$$\displaystyle \sum_{a=2}^n{\left( a \sum_{b=a}^n{\lfloor f_{a}^{-1}\left( b \right) \rfloor}\lceil f_{b}^{-1}\left( a \right) \rceil \right)} $$<br>where $f_a^{-1}\left( x \right)$ is the inverse function of $f_a\left( x \right)$, $\lfloor x \rfloor$ is the largest integer that is less than or equal to $x$, and $\lceil x \rceil$ is the smallest integer that is greater than or equal to $x$.</p>
<p>Since the value could be very large, please output the value modulo $998244353$.</p>
<h5 id="Input-3"><a href="#Input-3" class="headerlink" title="Input"></a>Input</h5><p>An integer $n(2 \leq n \leq 10^{12})$ described above.</p>
<h5 id="Output-3"><a href="#Output-3" class="headerlink" title="Output"></a>Output</h5><p>An integer denotes the value you have calculated modulo $998244353$.</p>
<h5 id="样例输入1"><a href="#样例输入1" class="headerlink" title="样例输入1"></a>样例输入1</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2</span><br></pre></td></tr></table></figure>
<h5 id="样例输出1"><a href="#样例输出1" class="headerlink" title="样例输出1"></a>样例输出1</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2</span><br></pre></td></tr></table></figure>
<h5 id="样例输入2"><a href="#样例输入2" class="headerlink" title="样例输入2"></a>样例输入2</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10</span><br></pre></td></tr></table></figure>
<h5 id="样例输出2"><a href="#样例输出2" class="headerlink" title="样例输出2"></a>样例输出2</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">236</span><br></pre></td></tr></table></figure>

<h5 id="题解-3"><a href="#题解-3" class="headerlink" title="题解"></a>题解</h5><h6 id="step1-1"><a href="#step1-1" class="headerlink" title="step1"></a>step1</h6><p> 由题意，$f_a^{-1}\left( x \right)=log_ax$。因此当 $a\leq b$ 时，$\lceil f_{b}^{-1}\left( a \right) \rceil=1$，即原式等于<br> $$\displaystyle \sum_{a=2}^n{\left( a \sum_{b=a}^n{\lfloor log_ab \rfloor}\right)} $$</p>
<h6 id="step2-1"><a href="#step2-1" class="headerlink" title="step2"></a>step2</h6><p>当$a&gt;\sqrt n$时，$\lfloor log_ab \rfloor=1$，<br>$$a \sum_{b=a}^n{\lfloor log_ab \rfloor}=a \sum_{b=a}^n{1} = a * (n-a+1)$$<br>设$x=\lfloor\sqrt n \rfloor$，则：<br>$$\sum_{a=x+1}^n{\left( a \sum_{b=a}^n{\lfloor log_ab \rfloor}\right)}$$</p>
<p>$$=\sum_{a=x+1}^n{a * (n-a+1)}$$</p>
<p>$$=\sum_{a=x+1}^n{(n+1)a-a^2}$$</p>
<p>$$=\frac{(n+1)(x+n+1)(n-x)}{2}-\frac{n(n+1)(2n+1)}{6}+\frac{x(x+1)(2x+1)}{6}$$</p>
<h6 id="step3-1"><a href="#step3-1" class="headerlink" title="step3"></a>step3</h6><p>当$a\leq\sqrt n$时，即$a\leq x$时，我们可以暴力统计每个$a$的答案：<br>设$a^k\leq n, a^{k+1}&gt;n$。<br>当$a\leq b \leq a^2-1$时，$\lfloor log_ab \rfloor=1$，共$a^2-a$个；<br>当$a^2\leq b \leq a^3-1$时，$\lfloor log_ab \rfloor=2$，共$a^3-a^2$个；<br>…<br>当$a^{k-1}\leq b \leq a^k-1$时，$\lfloor log_ab \rfloor=k-1$，共$a^k-a^{k-1}$个；<br>当$a^2\leq b \leq n$时，$\lfloor log_ab \rfloor=k$，共$n-a^k+1$个；<br>$$  \sum_{b=a}^n{\lfloor log_ab \rfloor}$$</p>
<p>$$=(k-1)a^k-(a+a^2+…+a^{k-1})+k(n-a^k+1)$$</p>
<p>$$=k(n+1)-\frac{a(a^k-1)}{a-1}$$</p>
<h6 id="step4-1"><a href="#step4-1" class="headerlink" title="step4"></a>step4</h6><p>$$ans=$$</p>
<p>$$\sum_{a=1}^{x}\left(k(n+1)-\frac{a(a^k-1)}{a-1}\right)+\\frac{(n+1)(x+n+1)(n-x)}{2}-\frac{n(n+1)(2n+1)}{6}+\frac{x(x+1)(2x+1)}{6}$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> inv2, inv6;</span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"><span class="keyword">int</span> b;</span><br><span class="line">ll n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1L</span>L * a * a % mod)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(b &amp; <span class="number">1</span>) ret = <span class="number">1L</span>L * ret * a % mod;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> ksm(a, mod - <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> tmp1 = (n+<span class="number">1</span>) % mod, tmp2 = (n+b+<span class="number">1</span>) % mod, tmp3 = (n-b+mod) % mod;</span><br><span class="line">	<span class="keyword">int</span> tmp4 = n % mod, tmp5 = (n+<span class="number">1</span>) % mod, tmp6 = (<span class="number">2</span>*n+<span class="number">1</span>) % mod;</span><br><span class="line">	ans = <span class="number">1L</span>L * tmp1 * tmp2 % mod * tmp3 % mod * inv2 % mod;</span><br><span class="line">	(ans += <span class="number">1L</span>L * b * (b+<span class="number">1</span>) % mod * (<span class="number">2</span>*b+<span class="number">1</span>) % mod * inv6 % mod) %= mod;</span><br><span class="line">	(ans += mod - <span class="number">1L</span>L * tmp4 * tmp5 % mod * tmp6 % mod * inv6 % mod) %= mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= b; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> k = <span class="number">1</span>; ll tmp = i;</span><br><span class="line">		<span class="keyword">while</span>(tmp &lt; n)</span><br><span class="line">		&#123;</span><br><span class="line">			tmp *= i;</span><br><span class="line">			k++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(tmp &gt; n) k--;</span><br><span class="line">		<span class="keyword">int</span> tmp1 = (n+<span class="number">1</span>) % mod * k % mod;</span><br><span class="line">		<span class="keyword">int</span> tmp2 = <span class="number">1L</span>L * i * (ksm(i, k) - <span class="number">1</span> + mod) % mod * ni(i<span class="number">-1</span>) % mod;</span><br><span class="line">		(ans += <span class="number">1L</span>L * (tmp1 - tmp2 + mod) * i % mod) %= mod;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	inv2 = ni(<span class="number">2</span>); inv6 = ni(<span class="number">6</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">	<span class="keyword">if</span>(n == <span class="number">2</span>) &#123;<span class="built_in">printf</span>(<span class="string">"2\n"</span>); <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">	<span class="keyword">if</span>(n == <span class="number">3</span>) &#123;<span class="built_in">printf</span>(<span class="string">"7\n"</span>); <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">	b = <span class="built_in">sqrt</span>(n);</span><br><span class="line">	init();</span><br><span class="line">	work();</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="G-Pot"><a href="#G-Pot" class="headerlink" title="G. Pot!!"></a>G. Pot!!</h3><p><a href="https://nanti.jisuanke.com/t/42387" target="_blank" rel="noopener">题目链接</a></p>
<h5 id="Description-4"><a href="#Description-4" class="headerlink" title="Description"></a>Description</h5><p>Little Q is very sleepy, and he really needs some coffee to make him awake. At this time, Little L brings a pot to Little Q, and he states the pot as follows.</p>
<p>For a prime number $p$, if $p^m | n$ and $p^{m+1}\not | n$, we say $pot_p(n)=m$.</p>
<p>The pot is very special that it can make everyone awake immediately.</p>
<p>Now Little L provides $n(1 \le n \le 10^5)$ integers $a_1, a_2, \cdots, a_n$ to Little Q, each of which is $1$ initially. After that, Little L shows $2$ types of queries:</p>
<p><strong>MULTIPLY l r x</strong> : For every $i \in [l,r]$ $(1\le l\le r\le n)$, multiply $a_i$  by $x$ $(2 \le x \le 10)$.</p>
<p><strong>MAX l r</strong> : Calculate the value of</p>
<p>$$\max_{l\le i\le r} \left( \sum_{p|a_i} \left( pot_p (a_i) \right) \right)\ (1 \le l \le r \le n)$$</p>
<p>where $p$ is prime.</p>
<p>Now you need to perform $q(1 \le q \le 10^5)$ queries of these two types of queries described above.</p>
<p>If you perform a “<strong>MULTIPLY</strong>” query, you don’t need to output anything.</p>
<p>If you perform a “<strong>MAX</strong>” query, you need to output a line like ==ANSWER y==, where $y$ the value you’ve calculated.</p>
<h5 id="题目大意-2"><a href="#题目大意-2" class="headerlink" title="题目大意"></a>题目大意</h5><p>给你$n$个初始值为$1$的数， 每次选取一个区间$[l, r]$, 进行其中一种操作：区间所有的数全都乘以$x$ $(2 \le x \le 10)$；求区间这些数中，分解质因数后单个质数的次数最高为多少。</p>
<h5 id="Input-4"><a href="#Input-4" class="headerlink" title="Input"></a>Input</h5><p>The first line contains two integers $n(1 \le n \le 10^5)$ and $q(1 \le q \le 10^5)$, the number of integers and the number of queries.</p>
<p>Each of the next $q$ lines contains one type of query described above.</p>
<p>Output<br>For each “<strong>MAX</strong>” query, output one line in the format of <strong>ANSWER y</strong>, where $y$ the value you have calculated.</p>
<h5 id="样例输入-3"><a href="#样例输入-3" class="headerlink" title="样例输入"></a>样例输入</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">5 6</span><br><span class="line">MULTIPLY 3 5 2</span><br><span class="line">MULTIPLY 2 5 3</span><br><span class="line">MAX 1 5</span><br><span class="line">MULTIPLY 1 4 2 </span><br><span class="line">MULTIPLY 2 5 5 </span><br><span class="line">MAX 3 5</span><br></pre></td></tr></table></figure>
<h5 id="样例输出-3"><a href="#样例输出-3" class="headerlink" title="样例输出"></a>样例输出</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ANSWER 1</span><br><span class="line">ANSWER 2</span><br></pre></td></tr></table></figure>
<h5 id="样例解释"><a href="#样例解释" class="headerlink" title="样例解释"></a>样例解释</h5><p>If $m$ and $n$ are non-zero integers, or more generally, non-zero elements of an integral domain, it is said that $m$ divides $n$ if there exists an integer $k$, or an element $k$ of the integral domain, such that $m \times k=n$, and this is written as $m \mid n$.</p>
<h5 id="题解-4"><a href="#题解-4" class="headerlink" title="题解"></a>题解</h5><p>注意到10以内的质数只有2,3,5,7，因此对它们分别维护一棵支持区间加法、区间取最大值的线段树即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> n, q;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (2*rt)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs (2*rt+1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l+r)&gt;&gt;1)</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> mx, tag;</span><br><span class="line">&#125;t[<span class="number">4</span>][MAXN &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> rt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t[p][rt].tag)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> x = t[p][rt].tag;</span><br><span class="line">		t[p][rt].tag = <span class="number">0</span>;</span><br><span class="line">		t[p][ls].tag += x;</span><br><span class="line">		t[p][rs].tag += x;</span><br><span class="line">		t[p][ls].mx += x;</span><br><span class="line">		t[p][rs].mx += x;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> rt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	t[p][rt].mx = max(t[p][ls].mx, t[p][rs].mx);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(r &lt; L || l &gt; R) <span class="keyword">return</span>;</span><br><span class="line">	<span class="keyword">if</span>(l &gt;= L &amp;&amp; r &lt;= R)</span><br><span class="line">	&#123;</span><br><span class="line">		t[p][rt].mx += x;</span><br><span class="line">		t[p][rt].tag += x;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	pushdown(p, rt);</span><br><span class="line">	add(p, ls, l, mid, L, R, x);</span><br><span class="line">	add(p, rs, mid+<span class="number">1</span>, r, L, R, x);</span><br><span class="line">	pushup(p, rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> rt, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(r &lt; L || l &gt; R) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(l &gt;= L &amp;&amp; r &lt;= R) <span class="keyword">return</span> t[p][rt].mx;</span><br><span class="line">	pushdown(p, rt);</span><br><span class="line">	<span class="keyword">return</span> max(ask(p, ls, l, mid, L, R), ask(p, rs, mid+<span class="number">1</span>, r, L, R));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x == <span class="number">2</span>) add(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">3</span>) add(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">4</span>) add(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">5</span>) add(<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">6</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		add(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">1</span>);</span><br><span class="line">		add(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">7</span>) add(<span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">8</span>) add(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">3</span>);</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">9</span>) add(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">10</span>) </span><br><span class="line">	&#123;</span><br><span class="line">		add(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">1</span>);</span><br><span class="line">		add(<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R, <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> m1, m2, m3, m4;</span><br><span class="line">	m1 = ask(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R);</span><br><span class="line">	m2 = ask(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R);</span><br><span class="line">	m3 = ask(<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R);</span><br><span class="line">	m4 = ask(<span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, n, L, R);</span><br><span class="line">	<span class="keyword">return</span> max(max(m1, m2), max(m3, m4));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;q);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= q; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> x, L, R;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">		<span class="keyword">if</span>(s[<span class="number">1</span>] == <span class="string">'U'</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;L, &amp;R, &amp;x);</span><br><span class="line">			update(x, L, R);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;L, &amp;R);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"ANSWER %d\n"</span>, query(L, R));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="H-Delivery-Route"><a href="#H-Delivery-Route" class="headerlink" title="H. Delivery Route"></a>H. Delivery Route</h3><p><a href="https://nanti.jisuanke.com/t/42388" target="_blank" rel="noopener">题目链接</a><br>BZOJ2200原题！样例都一样！<del>出题组锅背好！</del> </p>
<h5 id="Description-5"><a href="#Description-5" class="headerlink" title="Description"></a>Description</h5><p>Pony is the boss of a courier company. The company needs to deliver packages to $n$ offices numbered from $1$ to $n$. Especially, the ss-th office is the transfer station of the courier company.</p>
<p>There are $x$ ordinary two-way roads and $y$ one-way roads between these offices. The delivery vans will consume $c_i$ power if they pass through the $i$-th road. In general, the power consumption on one road must be non-negative. However, thanks to the experimental charging rail, the consumption may be negative on some one-way roads.</p>
<p>Besides, Pony got the following public information. The relevant department promised that if there is a one-way street from $a_i$ to $b_i$, it is impossible to return from $b_i$ to $a_i$.</p>
<p>To avoid the delivery vans anchoring on the road, Xiaodao wants to find these lowest power consumptions from the transfer station to these offices.</p>
<h5 id="题目大意-3"><a href="#题目大意-3" class="headerlink" title="题目大意"></a>题目大意</h5><p>给你一幅图，有$x$条无向边和$y$条有向边。其中无向变的权值均为正，有向边的权值可能为负。保证如果从$a_i$到$b_i$有一条有向边，则不存在$b_i$到$a_i$的路径。给你一个出发点，求单源最短路径。</p>
<h5 id="Input-5"><a href="#Input-5" class="headerlink" title="Input"></a>Input</h5><p>The first line contains four integers $n(1 \le n \le 25000), x, y(1 \le x, y \le 50000)$, and $s(1 \le s \le n)$. This is followed by $x+y$ lines, each line of which contains three integer $a_i, b_i(1 \le a_i, b_i \le n, a_i \neq b_i)$ and $c_i(-10000 \le c_i \le 10000)$ describing the roads. The first $x$ given roads are ordinary two-way roads, and the last $y$ given roads are one-way roads.</p>
<h5 id="Output-4"><a href="#Output-4" class="headerlink" title="Output"></a>Output</h5><p>The output should contain nn lines, the ii-th line represents the minimum energy consumption from ss-th to the ii-th office if possible, or output NO PATH if it is impossible to reach the $i$-th office.</p>
<h5 id="样例输入-4"><a href="#样例输入-4" class="headerlink" title="样例输入"></a>样例输入</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">6 3 3 4</span><br><span class="line">1 2 5 </span><br><span class="line">3 4 5</span><br><span class="line">5 6 10</span><br><span class="line">3 5 -100 </span><br><span class="line">4 6 -100 </span><br><span class="line">1 3 -10</span><br></pre></td></tr></table></figure>
<p>样例输出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NO PATH</span><br><span class="line">NO PATH</span><br><span class="line">5</span><br><span class="line">0</span><br><span class="line">-95 </span><br><span class="line">-100</span><br></pre></td></tr></table></figure>
<h5 id="题解-5"><a href="#题解-5" class="headerlink" title="题解"></a>题解</h5><p>首先，由于存在负权路径，直接Dijkstra显然不可取。考虑使用spfa，又很容易被卡掉。我们观察题目比起裸的单源最短路径有何区别：将无向图的每个联通块缩成点后，形成了一个拓扑图！</p>
<p>于是我们可以先用dfs对所有的联通块染色，按照拓扑排序的顺序，对每个联通块内部用Dijkstra。如果一条边连向另一个联通块，就更新其该点的最短路径（但不加入堆中），并且让目标联通块的入度$-1$。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> n, x, y, s;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2e5</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> head[MAXN], tot;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> nex, to, dis;</span><br><span class="line">&#125;eg[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	eg[++tot] = &#123;head[a], b, c&#125;;</span><br><span class="line">	head[a] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	addedge(a, b, c);</span><br><span class="line">	addedge(b, a, c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; bel[MAXN];</span><br><span class="line"><span class="keyword">int</span> co[MAXN], cnt;<span class="comment">//联通块的颜色、联通块的数量</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> col)</span><span class="comment">//dfs给联通块染色</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	co[v] = col;</span><br><span class="line">	bel[col].push_back(v);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = head[v]; i; i = eg[i].nex)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> to = eg[i].to;</span><br><span class="line">		<span class="keyword">if</span>(!co[to]) dfs(to, col);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> deg[MAXN], dis[MAXN];<span class="comment">//每个联通块的入度、单源最短路径</span></span><br><span class="line"><span class="keyword">int</span> vis[MAXN];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;<span class="comment">//拓扑排序：入度为0的联通块入队</span></span><br><span class="line">priority_queue&lt;pii, <span class="built_in">vector</span>&lt;pii&gt;, greater&lt;pii&gt; &gt; pq;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dijkstra</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(dis));</span><br><span class="line">	dis[s] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++) <span class="keyword">if</span>(!deg[i]) que.push(i);</span><br><span class="line">	<span class="keyword">while</span>(!que.empty())<span class="comment">//topological-sort</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> u = que.front(); que.pop();</span><br><span class="line">		<span class="keyword">int</span> sz = bel[u].size();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sz; i++) pq.push(mp(dis[bel[u][i]], bel[u][i]));</span><br><span class="line">		<span class="keyword">while</span>(!pq.empty())<span class="comment">//Dijkstra</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> x = pq.top().second; pq.pop();</span><br><span class="line">			<span class="keyword">if</span>(vis[x]) <span class="keyword">continue</span>;</span><br><span class="line">			vis[x] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = head[x]; i; i = eg[i].nex)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> to = eg[i].to;</span><br><span class="line">				<span class="keyword">if</span>(co[x] == co[to] &amp;&amp; dis[to] &gt; dis[x] + eg[i].dis)</span><br><span class="line">				&#123;</span><br><span class="line">					dis[to] = dis[x] + eg[i].dis;</span><br><span class="line">					pq.push(mp(dis[to], to));</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(co[x] != co[to])</span><br><span class="line">				&#123;</span><br><span class="line">					dis[to] = min(dis[to], dis[x] + eg[i].dis);</span><br><span class="line">					deg[co[to]]--;</span><br><span class="line">					<span class="keyword">if</span>(!deg[co[to]]) que.push(co[to]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;n, &amp;x, &amp;y, &amp;s);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, a, b, c; i &lt;= x; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">		add(a, b, c);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span>(!co[i]) dfs(i, ++cnt);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, a, b, c; i &lt;= y; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">		addedge(a, b, c);</span><br><span class="line">		deg[co[b]]++;</span><br><span class="line">	&#125;</span><br><span class="line">	Dijkstra();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;=n; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(dis[i] &gt; <span class="number">1e9</span>) <span class="built_in">puts</span>(<span class="string">"NO PATH"</span>);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dis[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="I-Base62"><a href="#I-Base62" class="headerlink" title="I. Base62"></a>I. Base62</h3><p><a href="https://nanti.jisuanke.com/t/42389" target="_blank" rel="noopener">题目链接</a></p>
<h5 id="Description-6"><a href="#Description-6" class="headerlink" title="Description"></a>Description</h5><p>As we already know, base64 is a common binary-to-text encoding scheme. Here we define a special series of positional systems that represent numbers using a base (a.k.a. radix) of $2$ to $62$. The symbols ‘$0$’ – ‘$9$’ represent zero to nine, and ‘A’ – ‘Z’ represent ten to thirty-five, and ‘a’ – ‘z’ represent thirty-six to sixty-one. Now you need to convert some integer $z$ in base $x$ into base $y$.</p>
<h5 id="题目大意-4"><a href="#题目大意-4" class="headerlink" title="题目大意"></a>题目大意</h5><p>高精度进制转换：给你三个数$x, y, z$，将一个$x$进制的数$z$转化为$y$进制。其中’$0$’ – ‘$9$’ 代表$0-9$, ‘A’ – ‘Z’ 代表$10-35$,  ‘a’ – ‘z’ 代表$36-61$。</p>
<h5 id="Input-6"><a href="#Input-6" class="headerlink" title="Input"></a>Input</h5><p>The input contains three integers $x, y<del>(2 \le x, y \le 62)$ and $z</del>(0 \le z &lt; x^{120})$, where the integer $z$ is given in base $x$.</p>
<h5 id="Output-5"><a href="#Output-5" class="headerlink" title="Output"></a>Output</h5><p>Output the integer $z$ in base $y$.</p>
<h5 id="样例输入-5"><a href="#样例输入-5" class="headerlink" title="样例输入"></a>样例输入</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">16 2 FB</span><br></pre></td></tr></table></figure>
<h5 id="样例输出-4"><a href="#样例输出-4" class="headerlink" title="样例输出"></a>样例输出</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">11111011</span><br></pre></td></tr></table></figure>
<h5 id="题解："><a href="#题解：" class="headerlink" title="题解："></a>题解：</h5><p>对于进制转换问题，我们可以利用短除法：重复记录$z%y$的值，并且将$z$除$y$。将得到的余数序列倒序输出即可。对于高进度取模，我们可以从高位算起依次将这一位对$y$的余数给到后一位。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1500</span>;</span><br><span class="line"><span class="keyword">int</span> x, y;</span><br><span class="line"><span class="keyword">char</span> s[MAXN], ans[MAXN];</span><br><span class="line"><span class="keyword">int</span> t[MAXN], res[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getnum</span><span class="params">(<span class="keyword">char</span> c)</span><span class="comment">//将字符转化为数字</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>) <span class="keyword">return</span> c - <span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">if</span>(c &gt;= <span class="string">'A'</span> &amp;&amp; c &lt;= <span class="string">'Z'</span>) <span class="keyword">return</span> c - <span class="string">'A'</span> + <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> c - <span class="string">'a'</span> + <span class="number">36</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">getch</span><span class="params">(<span class="keyword">int</span> num)</span><span class="comment">//将数字转化为字符</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(num &lt;= <span class="number">9</span>) <span class="keyword">return</span> num + <span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">if</span>(num &lt;= <span class="number">35</span>) <span class="keyword">return</span> num + <span class="string">'A'</span> - <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> num + <span class="string">'a'</span> - <span class="number">36</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = (<span class="keyword">int</span>)<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++) t[i] = getnum(s[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>, k = <span class="number">0</span>; j &lt;= len; )<span class="comment">//j为当前最高位</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = j; i &lt; len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            t[i+<span class="number">1</span>] += t[i] % y * x;</span><br><span class="line">            t[i] /= y;</span><br><span class="line">        &#125;</span><br><span class="line">        res[++k] = t[len] % y;<span class="comment">//得到此次除y的余数</span></span><br><span class="line">        t[len] /= y;</span><br><span class="line">        <span class="keyword">while</span>(j &lt;= len &amp;&amp; !t[j]) j++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i++) ans[i] = getch(res[k-i+<span class="number">1</span>]);</span><br><span class="line">        <span class="comment">//倒序输出</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%s"</span>, &amp;x, &amp;y, s+<span class="number">1</span>);</span><br><span class="line">    work();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, ans+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="K-Largest-Common-Submatrix"><a href="#K-Largest-Common-Submatrix" class="headerlink" title="K. Largest Common Submatrix"></a>K. Largest Common Submatrix</h3><p><a href="https://nanti.jisuanke.com/t/42391" target="_blank" rel="noopener">题目链接</a></p>
<h5 id="Description-7"><a href="#Description-7" class="headerlink" title="Description"></a>Description</h5><p>You are given two $n \times m$ matrices, and the elements of each matrix are ranged from $1$ to $n \times m$ and pairwise distinct. You need to find the common submatrix with the largest size between these two matrices.</p>
<p>Example:</p>
<p>Matrix A:</p>
<p>$$\displaystyle \begin{array}{ccc} 1 &amp; 2 &amp; 3\cr 4 &amp; 5 &amp; 6\cr 8 &amp; 7 &amp; 9\cr \end{array} $$<br>Matrix B:</p>
<p>$$\displaystyle \begin{array}{ccc} 5 &amp; 6 &amp; 1\cr 7 &amp; 9 &amp; 3\cr 2 &amp; 4 &amp; 8\cr \end{array} $$</p>
<p>Largest common submatrix:</p>
<p>$$\displaystyle \begin{array}{cc} 5 &amp; 6\cr 7 &amp; 9\cr \end{array} $$</p>
<h5 id="题目大意-5"><a href="#题目大意-5" class="headerlink" title="题目大意"></a>题目大意</h5><p>给你两个$n \times m$的矩阵，求它们的最大公共子矩阵。</p>
<h5 id="Input-7"><a href="#Input-7" class="headerlink" title="Input"></a>Input</h5><p>The first line of input contains two integers $n(1 \le n \le 1000)$ and $m(1 \le m \le 1000)$, denoting the number of rows and columns of each matrix.</p>
<p>Each of the next n lines contain mm integers per line, denoting the first matrix $A=(a_{i,j})<em>{n\times m}$. And again, each of the next $n$ lines contains m integers per line, denoting the second matrix $B=(b</em>{i,j}){n\times m}$</p>
<p>It is guaranteed that $1 \le a_{i,j}, b_{i,j} \le n \times m$, and $a_{i_1,j_1} \ne a_{i_2,j_2} \wedge b_{i_1,j_1} \ne b_{i_2,j_2}$ always holds for each pair of $(i_1, j_1)$ and $(i_2, j_2)$, where $i_1 \ne i_2 \vee j_1 \ne j_2$. </p>
<h5 id="Output-6"><a href="#Output-6" class="headerlink" title="Output"></a>Output</h5><p>Output an integer representing the size of the largest common submatrix.</p>
<h5 id="样例输入-6"><a href="#样例输入-6" class="headerlink" title="样例输入"></a>样例输入</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">3 4 </span><br><span class="line">5 6 7 8</span><br><span class="line">1 2 3 4</span><br><span class="line">9 10 11 12 </span><br><span class="line">5 6 8 7</span><br><span class="line">1 2 4 3</span><br><span class="line">12 11 10 9</span><br></pre></td></tr></table></figure>
<h5 id="样例输出-5"><a href="#样例输出-5" class="headerlink" title="样例输出"></a>样例输出</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4</span><br></pre></td></tr></table></figure>
<h5 id="样例解释-1"><a href="#样例解释-1" class="headerlink" title="样例解释"></a>样例解释</h5><p>Largest common submatrix in the sample test:<br>$$\displaystyle \begin{array}{cc} 5 &amp; 6\cr 1 &amp; 2\cr \end{array} $$</p>
<h5 id="题解-6"><a href="#题解-6" class="headerlink" title="题解"></a>题解</h5><h6 id="step1：问题的转化"><a href="#step1：问题的转化" class="headerlink" title="step1：问题的转化"></a>step1：问题的转化</h6><p>我们首先可以将两个矩阵建立一个映射关系：将第一个矩阵按照行优先的顺序从新标号，并且将第二个矩阵中的每个数变成矩阵1的相应新标号。如样例中，我们把第二个矩阵变成了：<br>$$\displaystyle \begin{array}{cc} 1&amp;2&amp;3&amp;4\cr 5&amp;6&amp;8&amp;7\cr 12&amp;11&amp;10&amp;9\cr \end{array} $$<br>问题就转化成得到的新矩阵中，满足“右边元素比左边元素大1，下边元素比上边元素大m”的最大子矩阵。这个问题可用悬线法解决。</p>
<h6 id="step2：悬线法"><a href="#step2：悬线法" class="headerlink" title="step2：悬线法"></a>step2：悬线法</h6><p>可以参考<a href="https://www.luogu.com.cn/problem/P1169" target="_blank" rel="noopener">这道题</a><br>定义:<br>$l[i][j]$: 代表从$(i,j)$能到达的最左位置<br>$r[i][j]$: 代表从$(i,j)$能到达的最右位置<br>$u[i][j]$: 代表从$(i,j)$向上扩展最长长度.</p>
<p>递推公式：<br>$l[i][j]=max(l[i][j], l[i-1][j])\<br>r[i][j]=min(r[i][j], r[i-1][j])\<br>u[i][j] = u[i-1][j] + 1;$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1005</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[MAXN][MAXN], b[MAXN * MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> l[MAXN][MAXN], r[MAXN][MAXN], u[MAXN][MAXN];</span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, x; i &lt;= n*m; i++) </span><br><span class="line">    &#123;</span><br><span class="line"> 	<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">	b[x] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line"> 	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>, x; j &lt;= m; j++)</span><br><span class="line">	&#123;</span><br><span class="line">	    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">	    a[i][j] = b[x];</span><br><span class="line">  	    l[i][j] = r[i][j] = j;</span><br><span class="line">	    u[i][j] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">2</span>; j &lt;= m; j++)</span><br><span class="line">	&#123;</span><br><span class="line">     	    <span class="keyword">if</span>(a[i][j] == a[i][j<span class="number">-1</span>] + <span class="number">1</span>) l[i][j] = l[i][j<span class="number">-1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = m<span class="number">-1</span>; j; j--)</span><br><span class="line">	&#123;</span><br><span class="line">	    <span class="keyword">if</span>(a[i][j] == a[i][j+<span class="number">1</span>] - <span class="number">1</span>) r[i][j] = r[i][j+<span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">	&#123;</span><br><span class="line">  	    <span class="keyword">if</span>(i &gt; <span class="number">1</span> &amp;&amp; a[i][j] == a[i<span class="number">-1</span>][j] + m)</span><br><span class="line">	    &#123;</span><br><span class="line">		l[i][j] = max(l[i][j], l[i<span class="number">-1</span>][j]);</span><br><span class="line">		r[i][j] = min(r[i][j], r[i<span class="number">-1</span>][j]);</span><br><span class="line">		u[i][j] = u[i<span class="number">-1</span>][j] + <span class="number">1</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">        <span class="keyword">int</span> x = r[i][j] - l[i][j] + <span class="number">1</span>;</span><br><span class="line">	ans = max(ans, x*u[i][j]);</span><br><span class="line">	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="N-Fibonacci-Sequence"><a href="#N-Fibonacci-Sequence" class="headerlink" title="N. Fibonacci Sequence"></a>N. Fibonacci Sequence</h3><p><a href="https://nanti.jisuanke.com/t/42394" target="_blank" rel="noopener">题目链接</a></p>
<h5 id="Description-8"><a href="#Description-8" class="headerlink" title="Description"></a>Description</h5><p>The Fibonacci sequence is a sequence of natural numbers, and is defined as follows:</p>
<p>$F_1=1$;<br>$F_2=1$; and<br>$F_n=F_{n-1}+F_{n-2}$ for $n&gt;2$.<br>Write a program to output the first $5$ numbers in the Fibonacci sequence.</p>
<h5 id="Input-8"><a href="#Input-8" class="headerlink" title="Input"></a>Input</h5><p>There is no input for this problem.</p>
<h5 id="Output-7"><a href="#Output-7" class="headerlink" title="Output"></a>Output</h5><p>Output 55 integers indicating the first 55 numbers in the Fibonacci sequence. Any two adjacent numbers in the output are separated by exactly one space and there is no extra space or symbol at the end of the line.</p>
<h5 id="样例输入-7"><a href="#样例输入-7" class="headerlink" title="样例输入"></a>样例输入</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(no input)</span><br></pre></td></tr></table></figure>
<h5 id="样例输出-6"><a href="#样例输出-6" class="headerlink" title="样例输出"></a>样例输出</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 1 2 3 5</span><br></pre></td></tr></table></figure>
<h5 id="题解-7"><a href="#题解-7" class="headerlink" title="题解"></a>题解</h5><p>签到题不多说。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"1 1 2 3 5"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      

      
    </div>
    <div class="article-info article-info-index">
      
        <div class="article-pop-out tagcloud">
          <i class="icon-tuding"></i>
          <a class="article-tag-list-link color3">置顶</a>
        </div>
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">ACM</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">比赛题解</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2020/03/12/2019%E9%93%B6%E5%B7%9D%E5%8C%BA%E5%9F%9F%E8%B5%9B%E9%A2%98%E8%A7%A3/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-1-1-1-最大公约数" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/12/1-1-1-%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0/">1.1.1. 数论-基础方法-最大公约数</a>
    </h1>
  

        
        <a href="/2020/03/12/1-1-1-%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0/" class="archive-article-date">
  	<time datetime="2020-03-11T18:58:12.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2020-03-12</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-1-1-最大公约数"><a href="#1-1-1-最大公约数" class="headerlink" title="1.1.1. 最大公约数"></a>1.1.1. 最大公约数</h3><h4 id="1-1-1-1-欧几里得算法"><a href="#1-1-1-1-欧几里得算法" class="headerlink" title="1.1.1.1. 欧几里得算法"></a>1.1.1.1. 欧几里得算法</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> y == <span class="number">0</span> ? x : gcd(y, x%y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-1-1-2-扩展欧几里得算法"><a href="#1-1-1-2-扩展欧几里得算法" class="headerlink" title="1.1.1.2. 扩展欧几里得算法"></a>1.1.1.2. 扩展欧几里得算法</h4><p>求 $ax+by=gcd$ 的解以及逆元（$a,b,c&gt;0$）$ax+by=c$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回 d=gcd(a,b); 和对应于等式 ax+by=d 中的 x,y;</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>) &#123;x = <span class="number">1</span>; y = <span class="number">0</span>; <span class="keyword">return</span> a;&#125;</span><br><span class="line">    <span class="keyword">int</span> gcd = exgcd(b, a%b, x, y);</span><br><span class="line">    <span class="keyword">int</span> t = x; x = y;</span><br><span class="line">    y = t - a / b * y;</span><br><span class="line">    <span class="keyword">return</span> gcd;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一道例题：已知$a,b,c,x_1,x_2$，求方程$ax+by+c=0$,$x\in[x_1,x_2],\ y\in[y_1,y_2]$的整数解个数.<br><a href="https://vjudge.net/problem/SGU-106" target="_blank" rel="noopener">SGU106</a></p>
<p>分析：先将$a,b,c$变成正数（注意定义域区间以圆点为轴翻转），再特判含$0$的情况；$a,b,c$均除以$gcd(a,b)$，将然后利用扩展欧几里得解出一组$x_0,y_0$。那么$x_0+kb,y_0-ka$也是一组解。然后分别求出$k$在$[x_1,x_2],\ [y_1,y_2]$中的上下界（上界下取整，下界上取整），对两个上界取min、下界取max，交叉部分即为解的个数。</p>
<pre><code class="cpp"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span>
<span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;
<span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;
ll a, b, c, x, xx, y, yy;
ll _x, _y;

<span class="function">ll <span class="title">gcd</span><span class="params">(ll x, ll y)</span></span>
<span class="function"></span>{
    <span class="keyword">return</span> y == <span class="number">0</span> ? x : gcd(y, x % y);
}
<span class="function">ll <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span></span>
<span class="function"></span>{
    <span class="keyword">if</span>(b == <span class="number">0</span>) {x = <span class="number">1</span>; y = <span class="number">0</span>; <span class="keyword">return</span> a;}
    ll gcd = exgcd(b, a%b, x, y)
    ll t = x; x = y;
    y = t - a / b * y;
    <span class="keyword">return</span> gcd;
}

<span class="function"><span class="keyword">int</span> <span class="title">init</span><span class="params">()</span></span>
<span class="function"></span>{
    c = -c;
    <span class="keyword">if</span>(c &lt; <span class="number">0</span>) {a = -a; b = -b; c = -c;}
    <span class="keyword">if</span>(a &lt; <span class="number">0</span>) {a = -a; x = -x; xx = -xx; swap(x, xx);}
    <span class="keyword">if</span>(b &lt; <span class="number">0</span>) {b = -b; y = -y; yy = -yy; swap(y, yy);}
    <span class="keyword">if</span>(a==<span class="number">0</span> &amp;&amp; b==<span class="number">0</span>)
    {
        <span class="keyword">if</span>(c == <span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (xx-x+<span class="number">1</span>) * (yy-y+<span class="number">1</span>));
        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;
    }
    <span class="keyword">if</span>(a == <span class="number">0</span>)
    {
        <span class="keyword">if</span>(c % b == <span class="number">0</span> &amp;&amp; c / b &gt;= y &amp;&amp; c / b &lt;= yy) 
            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, xx-x+<span class="number">1</span>);
        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;
    }
    <span class="keyword">if</span>(b == <span class="number">0</span>)
    {
        <span class="keyword">if</span>(c % a == <span class="number">0</span> &amp;&amp; c / a &gt;= x &amp;&amp; c / a &lt;= xx) 
            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, yy-y+<span class="number">1</span>);
        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;
    }
    ll g = gcd(a, b);
    <span class="keyword">if</span>(c % g) {<span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;}
    a /= g; b /= g; c /= g;
    exgcd(a, b, _x, _y);
    _x *= c; _y *= c;
    <span class="keyword">return</span> <span class="number">1</span>;
}

<span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>
<span class="function"></span>{
    <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld%"</span>, &amp;a, &amp;b, &amp;c);
    <span class="built_in">scanf</span>(<span class="string">"lld%lld%lld%lld"</span>, &amp;x, &amp;xx, &amp;y, &amp;yy);
    <span class="keyword">if</span>(!init()) <span class="keyword">return</span> <span class="number">0</span>;

    ll tmp1 = <span class="built_in">floor</span>((<span class="keyword">double</span>)(xx - _x) / b);
    ll tmp2 = <span class="built_in">floor</span>((<span class="keyword">double</span>)(_y - y) / a);
    ll tmp3 = <span class="built_in">ceil</span>((<span class="keyword">double</span>)(x - _x) / b);
    ll tmp4 = <span class="built_in">ceil</span>((<span class="keyword">double</span>)(_y - yy) / a);
    ll r = min(tmp1, tmp2), l = max(tmp3, tmp4);
    <span class="keyword">if</span>(r &lt; l) <span class="built_in">puts</span>(<span class="string">"0"</span>);
    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, r - l + <span class="number">1</span>);

    <span class="keyword">return</span> <span class="number">0</span>;
}</code></pre>

      

      
    </div>
    <div class="article-info article-info-index">
      
        <div class="article-pop-out tagcloud">
          <i class="icon-tuding"></i>
          <a class="article-tag-list-link color3">置顶</a>
        </div>
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">ACM</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">数学模版</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2020/03/12/1-1-1-%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-1-1-2-快速幂" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/12/1-1-2-%E5%BF%AB%E9%80%9F%E5%B9%82/">1.1.2. 数论-基础方法-快速幂</a>
    </h1>
  

        
        <a href="/2020/03/12/1-1-2-%E5%BF%AB%E9%80%9F%E5%B9%82/" class="archive-article-date">
  	<time datetime="2020-03-11T19:01:30.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2020-03-12</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-1-2-快速幂"><a href="#1-1-2-快速幂" class="headerlink" title="1.1.2. 快速幂"></a>1.1.2. 快速幂</h3><h4 id="1-1-2-1-普通快速幂"><a href="#1-1-2-1-普通快速幂" class="headerlink" title="1.1.2.1. 普通快速幂"></a>1.1.2.1. 普通快速幂</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1L</span>L*a*a%c) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ret = <span class="number">1L</span>L * ret * a % c;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-1-2-2-O-1-光速幂"><a href="#1-1-2-2-O-1-光速幂" class="headerlink" title="1.1.2.2. $O(1)$光速幂"></a>1.1.2.2. $O(1)$光速幂</h4><p>例题：<a href="https://nanti.jisuanke.com/t/41355" target="_blank" rel="noopener">2019南昌网络赛H</a></p>
<p>求$\frac{\sqrt{17}}{17}\left((\frac{3+\sqrt{17}}{2})^n-(\frac{3-\sqrt{17}}{2})^n\right)$,共$10^7$组询问。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 适用于同一底数要算不同指数多次快速幂</span></span><br><span class="line"><span class="comment">// 先预处理出三个数tmp1, tmp2, tmp3</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   利用BSGS的思路，预处理出tmp2、tmp3的MAXN以内次方；</span></span><br><span class="line"><span class="comment">   再处理Great Step；</span></span><br><span class="line"><span class="comment">   这样可以省去快速幂的一个log的复杂度</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">65536</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tmp1 = <span class="number">1L</span>L * sqrt17 * inv17 % mod;</span><br><span class="line">    tmp2 = <span class="number">1L</span>L * (<span class="number">3</span> + sqrt17) * inv2 % mod;</span><br><span class="line">    tmp3 = <span class="number">1L</span>L * (<span class="number">3</span> - sqrt17 + mod) * inv2 % mod;</span><br><span class="line">    ans2[<span class="number">0</span>] = ans3[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans2[i] = <span class="number">1L</span>L * ans2[i<span class="number">-1</span>] * tmp2 % mod;</span><br><span class="line">        ans3[i] = <span class="number">1L</span>L * ans3[i<span class="number">-1</span>] * tmp3 % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    pans2[<span class="number">0</span>] = pans3[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> ptmp2 = ans2[MAXN], ptmp3 = ans3[MAXN];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        pans2[i] = <span class="number">1L</span>L * pans2[i<span class="number">-1</span>] * ptmp2 % mod;</span><br><span class="line">        pans3[i] = <span class="number">1L</span>L * pans3[i<span class="number">-1</span>] * ptmp3 % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm2</span><span class="params">(<span class="keyword">int</span> a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b &gt; mod) b %= mod<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(b &lt;= MAXN) <span class="keyword">return</span> ans2[b];</span><br><span class="line">    <span class="keyword">int</span> tmp = b &amp; <span class="number">65535</span>, ret = ans2[tmp];</span><br><span class="line">    b &gt;&gt;= <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * pans2[b] * ret % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm3</span><span class="params">(<span class="keyword">int</span> a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b &gt; mod) b %= mod<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(b &lt;= MAXN) <span class="keyword">return</span> ans3[b];</span><br><span class="line">    <span class="keyword">int</span> tmp = b &amp; <span class="number">65535</span>, ret = ans3[tmp];</span><br><span class="line">    b &gt;&gt;= <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * pans3[b] * ret % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> r1 = <span class="number">1L</span>L * tmp1 * (ksm2(tmp2, x), r2 = ksm3(tmp3, x);</span><br><span class="line">    <span class="keyword">return</span> (r1 - r2 + mod) % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-1-2-3-矩阵快速幂"><a href="#1-1-2-3-矩阵快速幂" class="headerlink" title="1.1.2.3. 矩阵快速幂"></a>1.1.2.3. 矩阵快速幂</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n; ll k;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MAT</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line"></span><br><span class="line">    MAT(<span class="keyword">int</span> k)</span><br><span class="line">    &#123;</span><br><span class="line">        n = k; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i][i]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    MAT()&#123;&#125;</span><br><span class="line"></span><br><span class="line">    MAT <span class="keyword">operator</span> * (<span class="keyword">const</span> MAT &amp;b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">MAT <span class="title">ans</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                ll tmp = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    tmp += <span class="number">1L</span>L * a[i][k] * b.a[k][j] % mod;</span><br><span class="line">                &#125;</span><br><span class="line">                ans.a[i][j] = tmp % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i][j]);</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">MAT <span class="title">pow</span><span class="params">(MAT m, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">MAT <span class="title">ans</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, m = m * m) <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = ans * m;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%lld"</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="function">MAT <span class="title">m</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m.a[i][j]);</span><br><span class="line">    MAT ans = <span class="built_in">pow</span>(m,k);</span><br><span class="line">    ans.print();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      

      
    </div>
    <div class="article-info article-info-index">
      
        <div class="article-pop-out tagcloud">
          <i class="icon-tuding"></i>
          <a class="article-tag-list-link color3">置顶</a>
        </div>
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">ACM</a>
        		</li>
      		 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">数学模版</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2020/03/12/1-1-2-%E5%BF%AB%E9%80%9F%E5%B9%82/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-数学模版" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/11/%E6%95%B0%E5%AD%A6%E6%A8%A1%E7%89%88/">Math Template</a>
    </h1>
  

        
        <a href="/2020/03/11/%E6%95%B0%E5%AD%A6%E6%A8%A1%E7%89%88/" class="archive-article-date">
  	<time datetime="2020-03-11T08:04:51.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2020-03-11</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <hr>
<center><font size=8><font face="黑体">ACM史诗级数学模版</font></center>

<hr>
<center><img src="/assets/icpc.png" width="450" height="450" ></center>





<center><font size=6><font face="黑体">GoatWu</font></center></center></br>

<center><font size=3><font face="黑体">Email: goatwu@qq.com</font></center></center></br>


<center><font size=3><font face="黑体">build at January 19, 2020</font></center>

<div style="page-break-after: always; break-after: page;"></div>

<div style="page-break-after: always; break-after: page;"></div>

<h1 id="1-数论"><a href="#1-数论" class="headerlink" title="1. 数论"></a>1. 数论</h1><h2 id="1-1-基础方法"><a href="#1-1-基础方法" class="headerlink" title="1.1. 基础方法"></a>1.1. 基础方法</h2><h3 id="1-1-1-最大公约数"><a href="#1-1-1-最大公约数" class="headerlink" title="1.1.1. 最大公约数"></a>1.1.1. 最大公约数</h3><h4 id="1-1-1-1-欧几里得算法"><a href="#1-1-1-1-欧几里得算法" class="headerlink" title="1.1.1.1. 欧几里得算法"></a>1.1.1.1. 欧几里得算法</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> y == <span class="number">0</span> ? x : gcd(y, x%y);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-1-1-2-扩展欧几里得算法"><a href="#1-1-1-2-扩展欧几里得算法" class="headerlink" title="1.1.1.2. 扩展欧几里得算法"></a>1.1.1.2. 扩展欧几里得算法</h4><p>求 $ax+by=gcd$ 的解以及逆元（$a,b,c&gt;0$）$ax+by=c$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回 d=gcd(a,b); 和对应于等式 ax+by=d 中的 x,y;</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>) &#123;x = <span class="number">1</span>; y = <span class="number">0</span>; <span class="keyword">return</span> a;&#125;</span><br><span class="line">    <span class="keyword">int</span> gcd = exgcd(b, a%b, x, y);</span><br><span class="line">    <span class="keyword">int</span> t = x; x = y;</span><br><span class="line">    y = t - a / b * y;</span><br><span class="line">    <span class="keyword">return</span> gcd;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一道例题：已知$a,b,c,x_1,x_2$，求方程$ax+by+c=0$,$x\in[x_1,x_2],\ y\in[y_1,y_2]$的整数解个数.<br><a href="https://vjudge.net/problem/SGU-106" target="_blank" rel="noopener">SGU106</a></p>
<p>分析：先将$a,b,c$变成正数（注意定义域区间以圆点为轴翻转），再特判含$0$的情况；$a,b,c$均除以$gcd(a,b)$，将然后利用扩展欧几里得解出一组$x_0,y_0$。那么$x_0+kb,y_0-ka$也是一组解。然后分别求出$k$在$[x_1,x_2],\ [y_1,y_2]$中的上下界（上界下取整，下界上取整），对两个上界取min、下界取max，交叉部分即为解的个数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll a, b, c, x, xx, y, yy;</span><br><span class="line">ll _x, _y;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll x, ll y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> y == <span class="number">0</span> ? x : gcd(y, x % y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>) &#123;x = <span class="number">1</span>; y = <span class="number">0</span>; <span class="keyword">return</span> a;&#125;</span><br><span class="line">    ll gcd = exgcd(b, a%b, x, y)</span><br><span class="line">    ll t = x; x = y;</span><br><span class="line">    y = t - a / b * y;</span><br><span class="line">    <span class="keyword">return</span> gcd;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    c = -c;</span><br><span class="line">    <span class="keyword">if</span>(c &lt; <span class="number">0</span>) &#123;a = -a; b = -b; c = -c;&#125;</span><br><span class="line">    <span class="keyword">if</span>(a &lt; <span class="number">0</span>) &#123;a = -a; x = -x; xx = -xx; swap(x, xx);&#125;</span><br><span class="line">    <span class="keyword">if</span>(b &lt; <span class="number">0</span>) &#123;b = -b; y = -y; yy = -yy; swap(y, yy);&#125;</span><br><span class="line">    <span class="keyword">if</span>(a==<span class="number">0</span> &amp;&amp; b==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(c == <span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (xx-x+<span class="number">1</span>) * (yy-y+<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(a == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(c % b == <span class="number">0</span> &amp;&amp; c / b &gt;= y &amp;&amp; c / b &lt;= yy) </span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, xx-x+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(c % a == <span class="number">0</span> &amp;&amp; c / a &gt;= x &amp;&amp; c / a &lt;= xx) </span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, yy-y+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll g = gcd(a, b);</span><br><span class="line">    <span class="keyword">if</span>(c % g) &#123;<span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">    a /= g; b /= g; c /= g;</span><br><span class="line">    exgcd(a, b, _x, _y);</span><br><span class="line">    _x *= c; _y *= c;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld%"</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"lld%lld%lld%lld"</span>, &amp;x, &amp;xx, &amp;y, &amp;yy);</span><br><span class="line">    <span class="keyword">if</span>(!init()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    ll tmp1 = <span class="built_in">floor</span>((<span class="keyword">double</span>)(xx - _x) / b);</span><br><span class="line">    ll tmp2 = <span class="built_in">floor</span>((<span class="keyword">double</span>)(_y - y) / a);</span><br><span class="line">    ll tmp3 = <span class="built_in">ceil</span>((<span class="keyword">double</span>)(x - _x) / b);</span><br><span class="line">    ll tmp4 = <span class="built_in">ceil</span>((<span class="keyword">double</span>)(_y - yy) / a);</span><br><span class="line">    ll r = min(tmp1, tmp2), l = max(tmp3, tmp4);</span><br><span class="line">    <span class="keyword">if</span>(r &lt; l) <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, r - l + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-1-2-快速幂"><a href="#1-1-2-快速幂" class="headerlink" title="1.1.2. 快速幂"></a>1.1.2. 快速幂</h3><h4 id="1-1-2-1-普通快速幂"><a href="#1-1-2-1-普通快速幂" class="headerlink" title="1.1.2.1. 普通快速幂"></a>1.1.2.1. 普通快速幂</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1L</span>L*a*a%c) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ret = <span class="number">1L</span>L * ret * a % c;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-1-2-2-O-1-光速幂"><a href="#1-1-2-2-O-1-光速幂" class="headerlink" title="1.1.2.2. $O(1)$光速幂"></a>1.1.2.2. $O(1)$光速幂</h4><p>例题：<a href="https://nanti.jisuanke.com/t/41355" target="_blank" rel="noopener">2019南昌网络赛H</a></p>
<p>求$\frac{\sqrt{17}}{17}\left((\frac{3+\sqrt{17}}{2})^n-(\frac{3-\sqrt{17}}{2})^n\right)$,共$10^7$组询问。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 适用于同一底数要算不同指数多次快速幂</span></span><br><span class="line"><span class="comment">// 先预处理出三个数tmp1, tmp2, tmp3</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">   利用BSGS的思路，预处理出tmp2、tmp3的MAXN以内次方；</span></span><br><span class="line"><span class="comment">   再处理Great Step；</span></span><br><span class="line"><span class="comment">   这样可以省去快速幂的一个log的复杂度</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">65536</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tmp1 = <span class="number">1L</span>L * sqrt17 * inv17 % mod;</span><br><span class="line">    tmp2 = <span class="number">1L</span>L * (<span class="number">3</span> + sqrt17) * inv2 % mod;</span><br><span class="line">    tmp3 = <span class="number">1L</span>L * (<span class="number">3</span> - sqrt17 + mod) * inv2 % mod;</span><br><span class="line">    ans2[<span class="number">0</span>] = ans3[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans2[i] = <span class="number">1L</span>L * ans2[i<span class="number">-1</span>] * tmp2 % mod;</span><br><span class="line">        ans3[i] = <span class="number">1L</span>L * ans3[i<span class="number">-1</span>] * tmp3 % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    pans2[<span class="number">0</span>] = pans3[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> ptmp2 = ans2[MAXN], ptmp3 = ans3[MAXN];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        pans2[i] = <span class="number">1L</span>L * pans2[i<span class="number">-1</span>] * ptmp2 % mod;</span><br><span class="line">        pans3[i] = <span class="number">1L</span>L * pans3[i<span class="number">-1</span>] * ptmp3 % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm2</span><span class="params">(<span class="keyword">int</span> a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b &gt; mod) b %= mod<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(b &lt;= MAXN) <span class="keyword">return</span> ans2[b];</span><br><span class="line">    <span class="keyword">int</span> tmp = b &amp; <span class="number">65535</span>, ret = ans2[tmp];</span><br><span class="line">    b &gt;&gt;= <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * pans2[b] * ret % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm3</span><span class="params">(<span class="keyword">int</span> a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b &gt; mod) b %= mod<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(b &lt;= MAXN) <span class="keyword">return</span> ans3[b];</span><br><span class="line">    <span class="keyword">int</span> tmp = b &amp; <span class="number">65535</span>, ret = ans3[tmp];</span><br><span class="line">    b &gt;&gt;= <span class="number">16</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * pans3[b] * ret % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> r1 = <span class="number">1L</span>L * tmp1 * (ksm2(tmp2, x), r2 = ksm3(tmp3, x);</span><br><span class="line">    <span class="keyword">return</span> (r1 - r2 + mod) % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-1-2-3-矩阵快速幂"><a href="#1-1-2-3-矩阵快速幂" class="headerlink" title="1.1.2.3. 矩阵快速幂"></a>1.1.2.3. 矩阵快速幂</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n; ll k;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MAT</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">105</span>][<span class="number">105</span>];</span><br><span class="line"></span><br><span class="line">    MAT(<span class="keyword">int</span> k)</span><br><span class="line">    &#123;</span><br><span class="line">        n = k; <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) a[i][i]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    MAT()&#123;&#125;</span><br><span class="line"></span><br><span class="line">    MAT <span class="keyword">operator</span> * (<span class="keyword">const</span> MAT &amp;b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">MAT <span class="title">ans</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                ll tmp = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)</span><br><span class="line">                &#123;</span><br><span class="line">                    tmp += <span class="number">1L</span>L * a[i][k] * b.a[k][j] % mod;</span><br><span class="line">                &#125;</span><br><span class="line">                ans.a[i][j] = tmp % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i][j]);</span><br><span class="line">            <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">MAT <span class="title">pow</span><span class="params">(MAT m, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">MAT <span class="title">ans</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, m = m * m) <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans = ans * m;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%lld"</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="function">MAT <span class="title">m</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m.a[i][j]);</span><br><span class="line">    MAT ans = <span class="built_in">pow</span>(m,k);</span><br><span class="line">    ans.print();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-1-3-求逆元"><a href="#1-1-3-求逆元" class="headerlink" title="1.1.3. 求逆元"></a>1.1.3. 求逆元</h3><p>$b=a^{-1}$，即 $ab\equiv1\ (mod\ p)$</p>
<h4 id="1-1-3-1-费马小定理"><a href="#1-1-3-1-费马小定理" class="headerlink" title="1.1.3.1. 费马小定理"></a>1.1.3.1. 费马小定理</h4><p>$a^{p-1}\equiv1\ (mod\ p)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 要求p为质数且指数b与p互质</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1L</span>L * a * a % c)</span><br><span class="line">        <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ret = <span class="number">1L</span>L * ret * a % c;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ksm(a,p<span class="number">-2</span>,p);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-1-3-2-扩展欧几里得Exgcd"><a href="#1-1-3-2-扩展欧几里得Exgcd" class="headerlink" title="1.1.3.2. 扩展欧几里得Exgcd"></a>1.1.3.2. 扩展欧几里得Exgcd</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>) &#123;x=<span class="number">1</span>; y=<span class="number">0</span>;&#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        exgcd(b, a%b, y, x);</span><br><span class="line">        y -= a / b * x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line">    exgcd(a, p, x, y);</span><br><span class="line">    x = (x % p + p) % p;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-1-3-3-线性预处理逆元"><a href="#1-1-3-3-线性预处理逆元" class="headerlink" title="1.1.3.3. 线性预处理逆元"></a>1.1.3.3. 线性预处理逆元</h4><p>设$p\div a=x \cdots\cdots y$，即 $p=ax+y$.</p>
<p>$$<br>\therefore ax+y\equiv 0\ (mod\ p)\<br>\therefore x+ya^{-1}\equiv 0\ (mod\ p)\<br>\therefore a^{-1}\equiv\frac{-x}{y} \ (mod\ p)<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> inv[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) inv[i] = <span class="number">1L</span>L * (p - p / i) * inv[p%i] % p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-2-素数与唯一分解定理"><a href="#1-2-素数与唯一分解定理" class="headerlink" title="1.2. 素数与唯一分解定理"></a>1.2. 素数与唯一分解定理</h2><h3 id="1-2-1-线性筛素数"><a href="#1-2-1-线性筛素数" class="headerlink" title="1.2.1. 线性筛素数"></a>1.2.1. 线性筛素数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 埃筛算法，复杂度O(n)</span></span><br><span class="line"><span class="keyword">int</span> prime[MAXN], num[MAXN], tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!num[i]) prime[++tot]=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; prime[j] * i &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            num[i*prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-2-大区间素数筛选"><a href="#1-2-2-大区间素数筛选" class="headerlink" title="1.2.2. 大区间素数筛选"></a>1.2.2. 大区间素数筛选</h3><p><a href="https://www.luogu.com.cn/problem/P1835" target="_blank" rel="noopener">洛谷P1835 素数密度</a><br>给定区间$[L，R],(L≤R≤2147483647,R-L≤1000000)$，请计算区间中素数的个数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e4</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXLEN = <span class="number">1e6</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> L, R;</span><br><span class="line"><span class="comment">// 先线性筛出50000以内质数</span></span><br><span class="line"><span class="keyword">int</span> prime[MAXN], num[MAXN], tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!num[i]) prime[++tot]=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; prime[j] * i &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            num[i*prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 再用欧拉筛的思想，划掉[L,R]中的合数</span></span><br><span class="line"><span class="keyword">int</span> notprime[MAXLEN], prime2[MAXN], cnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(L == <span class="number">1</span>) L = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tot &amp;&amp; <span class="number">1L</span>L * prime[i] * prime[i] &lt;= R; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x = L / prime[i] + (L % prime[i] != <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span>(x == <span class="number">1</span>) x++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = x; <span class="number">1L</span>L * j * prime[i] &lt;= R; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            notprime[j*prime[i]-L] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= R-L; i++)</span><br><span class="line">        <span class="keyword">if</span>(!notprime[i]) prime2[++cnt] = i + L;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;L, &amp;R);</span><br><span class="line">    init(); work();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, cnt);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-3-MillerRabin素数测试"><a href="#1-2-3-MillerRabin素数测试" class="headerlink" title="1.2.3. MillerRabin素数测试"></a>1.2.3. MillerRabin素数测试</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">mul</span><span class="params">(ll x,ll y,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x*y-(ll)((<span class="keyword">long</span> <span class="keyword">double</span>)x/mod*y)*mod+mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Miller_Rabin</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">ll <span class="title">ksm</span><span class="params">(ll a,ll b,ll c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(ll base = a; b; b &gt;&gt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ans = mul(ans, base, c);</span><br><span class="line">            <span class="comment">//ans = ans * base % c;</span></span><br><span class="line">            base = mul(base, base, c);</span><br><span class="line">            <span class="comment">//base = base * base % c;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">mr</span><span class="params">(ll x,ll b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll d,p=<span class="number">0</span>;</span><br><span class="line">        d=x<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>((d&amp;<span class="number">1</span>)==<span class="number">0</span>) &#123;d&gt;&gt;=<span class="number">1</span>;++p;&#125;</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        ll cur=ksm(b,d,x);</span><br><span class="line">        <span class="keyword">if</span>(cur==<span class="number">1</span> || cur==x<span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=p;++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//cur=cur*cur%x;</span></span><br><span class="line">            cur = mul(cur, cur, x);</span><br><span class="line">            <span class="keyword">if</span>(cur==x<span class="number">-1</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">isprime</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x==<span class="number">46856248255981</span> || x&lt;<span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(x==<span class="number">2</span> || x==<span class="number">3</span> || x==<span class="number">7</span> || x==<span class="number">61</span> || x==<span class="number">24251</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> mr(x,<span class="number">2</span>) &amp;&amp; mr(x,<span class="number">3</span>) &amp;&amp; mr(x,<span class="number">7</span>) &amp;&amp; mr(x,<span class="number">61</span>) &amp;&amp; mr(x,<span class="number">24251</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> Miller_Rabin::isprime;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-4-PollardRho找最大素因子"><a href="#1-2-4-PollardRho找最大素因子" class="headerlink" title="1.2.4. PollardRho找最大素因子"></a>1.2.4. PollardRho找最大素因子</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Pollard_Rho</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> b == <span class="number">0</span> ? a : gcd(b, a%b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">f</span><span class="params">(ll x,ll c,ll n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (mul(x, x, n) + c) % n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">PR</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll s=<span class="number">0</span>,t=<span class="number">0</span>,c=<span class="number">1l</span>l*rand()%(x<span class="number">-1</span>)+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> stp=<span class="number">0</span>,goal=<span class="number">1</span>;</span><br><span class="line">        ll val=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(goal=<span class="number">1</span>;;goal&lt;&lt;=<span class="number">1</span>,s=t,val=<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(stp=<span class="number">1</span>;stp&lt;=goal;++stp)</span><br><span class="line">            &#123;</span><br><span class="line">                t=f(t,c,x);</span><br><span class="line">                val = mul(val, <span class="built_in">abs</span>(t-s), x);</span><br><span class="line">                <span class="keyword">if</span>((stp%<span class="number">127</span>)==<span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    ll d=gcd(val,x);</span><br><span class="line">                    <span class="keyword">if</span>(d&gt;<span class="number">1</span>) <span class="keyword">return</span> d;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ll d=gcd(val,x);</span><br><span class="line">            <span class="keyword">if</span>(d&gt;<span class="number">1</span>) <span class="keyword">return</span> d;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll max_factor = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fac</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x&lt;=max_factor || x&lt;<span class="number">2</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span>(isprime(x))</span><br><span class="line">        &#123;</span><br><span class="line">            max_factor=max_factor&gt;x?max_factor:x;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ll p=x;</span><br><span class="line">        <span class="keyword">while</span>(p&gt;=x) p=PR(x);</span><br><span class="line">        <span class="keyword">while</span>((x%p)==<span class="number">0</span>) x/=p;</span><br><span class="line">        fac(x);fac(p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Pollard_Rho;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    srand((<span class="keyword">unsigned</span>)time(<span class="literal">NULL</span>));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">        <span class="keyword">if</span>(isprime(n)) &#123;<span class="built_in">puts</span>(<span class="string">"Prime"</span>);<span class="keyword">continue</span>;&#125;</span><br><span class="line">        max_factor=<span class="number">0</span>;</span><br><span class="line">        fac(n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,max_factor);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-5-反素数"><a href="#1-2-5-反素数" class="headerlink" title="1.2.5. 反素数"></a>1.2.5. 反素数</h3><p>定义：一个数$x$是反素数，当且仅当所有小于x的正整数的因子个数均严格小于$x$</p>
<p>分析：每个反质数，都是由一个比其小的反质数乘以一个质数而来。并且其分解成$p_1^{a_1}p_2^{a_2}\cdots p_k^{a_k}$的形式（$p_1,p_2,\cdots ,p_k$为$2,3,5,\cdots$这些最小的$k$个质数），有$a_1\leq a_2\leq\cdots\leq a_k$。</p>
<h4 id="1-2-5-1-搜索n以内最大的反素数"><a href="#1-2-5-1-搜索n以内最大的反素数" class="headerlink" title="1.2.5.1. 搜索n以内最大的反素数"></a>1.2.5.1. 搜索n以内最大的反素数</h4><p><a href="http://www.51nod.com/Challenge/Problem.html#problemId=1060" target="_blank" rel="noopener">51nod 1060</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> p[<span class="number">16</span>] = &#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>,<span class="number">53</span>&#125;;</span><br><span class="line">ll n;</span><br><span class="line">ll ans, ans_num;  </span><br><span class="line"><span class="comment">// ans为n以内的最大反素数（会持续更新），ans_sum为ans的因子数。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> depth, ll temp, ll num, <span class="keyword">int</span> up)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(depth &gt;= <span class="number">16</span> || temp &gt; n) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(num &gt; ans_num)</span><br><span class="line">    &#123;</span><br><span class="line">        ans = temp;</span><br><span class="line">        ans_num = num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(num == ans_num &amp;&amp; ans &gt; temp) ans = temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= up; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(temp &gt; n / p[depth]) <span class="keyword">break</span>; <span class="comment">// 防止爆long long</span></span><br><span class="line">        <span class="comment">// temp每次乘一个当前素数并向后dfs</span></span><br><span class="line">        dfs(depth + <span class="number">1</span>, temp *= p[depth], num * (i + <span class="number">1</span>), i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">        ans_num = <span class="number">0</span>;</span><br><span class="line">        dfs(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">60</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %lld\n"</span>, ans, ans_num);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-5-2-预处理出所有反素数"><a href="#1-2-5-2-预处理出所有反素数" class="headerlink" title="1.2.5.2. 预处理出所有反素数"></a>1.2.5.2. 预处理出所有反素数</h4><p><a href="http://www.51nod.com/Challenge/Problem.html#problemId=1061" target="_blank" rel="noopener">51nod 1061</a></p>
<p>分析：1是第一个反素数；维护一个小根堆，每次取堆顶元素，如果其因子个数要大于全部已知反素数，则其也为反素数；我们将这个反素数能扩展出来的所有数（乘上素数满足开始的两个条件）加入堆中。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">int</span> prime[<span class="number">1000005</span>], np[<span class="number">1000005</span>], pcnt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 此处略去高精度模版</span></span><br><span class="line"><span class="comment">// HP为高精度的类别名，用到高精度乘long long</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> pair&lt;HP, HP&gt; pll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line">HP MAXN = <span class="number">1</span>;</span><br><span class="line">HP INF = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Data</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    HP num; <span class="comment">// 这个数</span></span><br><span class="line">    <span class="keyword">int</span> cnt[<span class="number">105</span>]; <span class="comment">//这个数因式分解后的各个因子数量</span></span><br><span class="line">    Data()</span><br><span class="line">    &#123;</span><br><span class="line">        num = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="keyword">sizeof</span>(cnt));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &gt; (<span class="keyword">const</span> Data &amp;a) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> a.num &lt; num;</span><br><span class="line">    &#125;</span><br><span class="line">    Data <span class="keyword">operator</span> * (<span class="keyword">int</span> p) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        Data ret = *<span class="keyword">this</span>;</span><br><span class="line">        ret.num = ret.num * prime[p];</span><br><span class="line">        ret.cnt[p]++;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">HP <span class="title">cal</span><span class="params">(Data d)</span> <span class="comment">// 计算一个数的因子个数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HP ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> p = <span class="number">0</span>; d.cnt[p] &amp;&amp; p &lt; pcnt; p++) </span><br><span class="line">        ret = ret * (d.cnt[p] + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">priority_queue&lt;Data, <span class="built_in">vector</span>&lt;Data&gt;, greater&lt;Data&gt; &gt; q;</span><br><span class="line"></span><br><span class="line">pll ls[<span class="number">10000</span>];</span><br><span class="line"><span class="keyword">int</span> tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HP cur = <span class="number">0</span>;</span><br><span class="line">    q.push(Data());</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        Data u = q.top(); q.pop();</span><br><span class="line">        HP d = cal(u);</span><br><span class="line">        <span class="keyword">if</span>(d &lt;= cur) <span class="keyword">continue</span>;</span><br><span class="line">        cur = d;</span><br><span class="line">        ls[++tot] = mp(u.num, d);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> p = <span class="number">0</span>; p &lt; pcnt &amp;&amp; (!p || u.cnt[p<span class="number">-1</span>]); p++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!p || u.cnt[p] &lt; u.cnt[p<span class="number">-1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                Data tmp = u * p;</span><br><span class="line">                <span class="keyword">if</span>(tmp.num &lt; MAXN) q.push(tmp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">euler</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    np[<span class="number">0</span>] = np[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!np[i]) prime[pcnt++] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; pcnt &amp;&amp; i * prime[j] &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            np[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    euler(<span class="number">1000000</span>);</span><br><span class="line">    MAXN.len = <span class="number">201</span>; MAXN.v[<span class="number">201</span>] = <span class="number">1</span>;</span><br><span class="line">    INF = MAXN;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        HP n;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        <span class="keyword">int</span> ans = (<span class="keyword">int</span>)(upper_bound(ls+<span class="number">1</span>, ls+tot+<span class="number">1</span>, mp(n, INF)) - ls) - <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ls[ans].first &lt;&lt; <span class="string">" "</span> &lt;&lt; ls[ans].second &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-5-3-求因子个数为n的最小数"><a href="#1-2-5-3-求因子个数为n的最小数" class="headerlink" title="1.2.5.3. 求因子个数为n的最小数"></a>1.2.5.3. 求因子个数为n的最小数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> prime[<span class="number">16</span>] = &#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>,<span class="number">53</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">ll ans = <span class="number">2e18</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> dep, ll tmp, ll num, <span class="keyword">int</span> up, <span class="keyword">int</span> tar)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(num &gt; tar || dep &gt;= <span class="number">16</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(num == tar)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tmp &lt; ans) ans = tmp;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= up; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tmp / prime[dep] &gt; ans) <span class="keyword">break</span>;</span><br><span class="line">        dfs(dep+<span class="number">1</span>, tmp *= prime[dep], num * (i+<span class="number">1</span>), i, tar);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    dfs(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">64</span>, n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-6-约数"><a href="#1-2-6-约数" class="headerlink" title="1.2.6. 约数"></a>1.2.6. 约数</h3><p>设 $n=p_1^{k_1}p_2^{k_2}\cdots p_s^{k_s}$：</p>
<h4 id="1-2-6-1-合数分解"><a href="#1-2-6-1-合数分解" class="headerlink" title="1.2.6.1. 合数分解"></a>1.2.6.1. 合数分解</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> factor[<span class="number">100</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> fatCnt;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getFactors</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    fatCnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> tmp = x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; prime[i] &lt;= tmp/prime[i]; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tmp % prime[i] == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            factor[++fatCnt][<span class="number">0</span>] = prime[i];</span><br><span class="line">            <span class="keyword">while</span>(tmp % prime[i] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                factor[fatCnt][<span class="number">1</span>]++;</span><br><span class="line">                tmp /= prime[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tmp!=<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        factor[++fatCnt][<span class="number">0</span>]=tmp;</span><br><span class="line">        factor[fatCnt][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fatCnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-6-2-求约数个数"><a href="#1-2-6-2-求约数个数" class="headerlink" title="1.2.6.2. 求约数个数"></a>1.2.6.2. 求约数个数</h4><p>$$<br>x=\prod_{i=1}^{s}(k_i+1)=(k_1+1)(k_2+1)\cdots (k_s+1)<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Factornum</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = getFactors(x), ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++) ret *= (factor[i][<span class="number">1</span>] + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-6-3-求约数和"><a href="#1-2-6-3-求约数和" class="headerlink" title="1.2.6.3. 求约数和"></a>1.2.6.3. 求约数和</h4><p>$$<br>y=\prod_{i=1}^{s}\frac{1-p_i^{n+1}}{1-p_i}<br>$$</p>
<p>$$<br>=(1+p_1+p_1^2+\cdots+p_1^{k_1})(1+p_2+p_2^2+\cdots+p_2^{k_2})\cdots(1+p_s+p_s^2+\cdots+p_s^{k_s})<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">Factorsum</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = getFactors(x); <span class="comment">// 注意在调用前使用过，应提前memset</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> a = factor[i][<span class="number">0</span>], b = factor[i][<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> tmp = (ksm(a, b+<span class="number">1</span>) - <span class="number">1</span>) / (a - <span class="number">1</span>);</span><br><span class="line">        ret = ret * tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2-6-4-线性筛约数个数与约数和"><a href="#1-2-6-4-线性筛约数个数与约数和" class="headerlink" title="1.2.6.4. 线性筛约数个数与约数和"></a>1.2.6.4. 线性筛约数个数与约数和</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> p[MAXN], v[MAXN], tot;</span><br><span class="line"><span class="keyword">int</span> d[MAXN], num[MAXN];</span><br><span class="line"><span class="keyword">int</span> g[MAXN], f[MAXN];</span><br><span class="line"><span class="comment">// d-&gt;约数个数；num-&gt;最小质因子出现次数；</span></span><br><span class="line"><span class="comment">// f-&gt;约数和；g-&gt;连乘项中属于最小质因子的幂次和</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    d[<span class="number">1</span>] = g[<span class="number">1</span>] = f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!v[i])</span><br><span class="line">        &#123;</span><br><span class="line">            v[i] = <span class="number">1</span>; p[++tot] = i;</span><br><span class="line">            d[i] = <span class="number">2</span>; num[i] = <span class="number">1</span>;</span><br><span class="line">            g[i] = i + <span class="number">1</span>; f[i] = i + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * p[j] &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            v[p[j] * i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % p[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                num[i * p[j]] = num[i] + <span class="number">1</span>;</span><br><span class="line">                d[i * p[j]] = d[i]/num[i*p[j]]*(num[i*p[j]]+<span class="number">1</span>);</span><br><span class="line">                g[i * p[j]] = g[i] * p[j] + <span class="number">1</span>;</span><br><span class="line">                f[i * p[j]] = f[i] / g[i] * g[i * p[j]];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                num[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">                d[i * p[j]] = d[i] * <span class="number">2</span>;</span><br><span class="line">                f[i * p[j]] = f[i] * f[p[j]];</span><br><span class="line">                g[i * p[j]] = <span class="number">1</span> + p[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-3-同余"><a href="#1-3-同余" class="headerlink" title="1.3. 同余"></a>1.3. 同余</h2><h3 id="1-3-1-中国剩余定理"><a href="#1-3-1-中国剩余定理" class="headerlink" title="1.3.1. 中国剩余定理"></a>1.3.1. 中国剩余定理</h3><h4 id="1-3-1-1-前置芝士-O-1-快速乘的两种写法"><a href="#1-3-1-1-前置芝士-O-1-快速乘的两种写法" class="headerlink" title="1.3.1.1. 前置芝士-O(1)快速乘的两种写法"></a>1.3.1.1. 前置芝士-O(1)快速乘的两种写法</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll x,ll y,ll X)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll k=(ll)((<span class="number">1.0L</span>*x*y)/(<span class="number">1.0L</span>*X)),t=x*y-k*X;</span><br><span class="line">    t -= X; <span class="keyword">while</span>(t&lt;<span class="number">0</span>) t += X;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">mul</span><span class="params">(ll x,ll y,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x*y-(ll)((<span class="keyword">long</span> <span class="keyword">double</span>)x/mod*y)*mod+mod)%mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-3-1-2-普通CRT-模数互质"><a href="#1-3-1-2-普通CRT-模数互质" class="headerlink" title="1.3.1.2. 普通CRT-模数互质"></a>1.3.1.2. 普通CRT-模数互质</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> k;</span><br><span class="line">ll a[MAXN], b[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">mul</span><span class="params">(ll x,ll y,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x*y-(ll)((<span class="keyword">long</span> <span class="keyword">double</span>)x/mod*y)*mod+mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>) &#123;x=<span class="number">1</span>; y=<span class="number">0</span>;&#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        exgcd(b,a%b,y,x);</span><br><span class="line">        y-=a/b*x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">crt</span><span class="params">(ll *a, ll *b, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ans = <span class="number">0</span>, lcm = <span class="number">1</span>, x, y;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i++) lcm *= b[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll tp = lcm / b[i];</span><br><span class="line">        exgcd(tp, b[i], x, y);</span><br><span class="line">        x = (x % b[i] + b[i]) % b[i];</span><br><span class="line">        <span class="comment">//ans = (ans + tp * x * a[i]) % lcm;</span></span><br><span class="line">        ans = (ans + mul(mul(tp, x, lcm), a[i], lcm)) % lcm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (ans + lcm) % lcm;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>, &amp;b[<span class="number">1</span>], &amp;b[<span class="number">2</span>], &amp;b[<span class="number">3</span>]);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>, &amp;a[<span class="number">1</span>], &amp;a[<span class="number">2</span>], &amp;a[<span class="number">3</span>]);</span><br><span class="line">    ll ans = crt(a, b, <span class="number">3</span>); <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-3-1-3-EXCRT-可以不互质"><a href="#1-3-1-3-EXCRT-可以不互质" class="headerlink" title="1.3.1.3. EXCRT-可以不互质"></a>1.3.1.3. EXCRT-可以不互质</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">ll ai[MAXN], bi[MAXN];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">mul</span><span class="params">(ll x,ll y,ll mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (x*y-(ll)((<span class="keyword">long</span> <span class="keyword">double</span>)x/mod*y)*mod+mod)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>) &#123;x = <span class="number">1</span>; y = <span class="number">0</span>; <span class="keyword">return</span> a;&#125;</span><br><span class="line">    ll gcd = exgcd(b, a%b, x, y);</span><br><span class="line">    ll tp = x;</span><br><span class="line">    x = y; y = tp - a / b * y;</span><br><span class="line">    <span class="keyword">return</span> gcd;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">excrt</span><span class="params">(ll *ai, ll *bi, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll x, y;</span><br><span class="line">    ll M = bi[<span class="number">1</span>], ans = ai[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll a = M, b = bi[i], c = (ai[i] - ans % b + b) % b;</span><br><span class="line">        ll gcd = exgcd(a, b, x, y), bg = b / gcd;</span><br><span class="line">        <span class="keyword">if</span>(c % gcd) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        x = mul(x, c/gcd, bg);</span><br><span class="line">        ans += x*M;</span><br><span class="line">        M *= bg;</span><br><span class="line">        ans = (ans % M + M) % M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;bi[i]);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;ai[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, excrt(ai, bi, n));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-2-二次剩余-膜意义下开根号"><a href="#1-3-2-二次剩余-膜意义下开根号" class="headerlink" title="1.3.2. 二次剩余-膜意义下开根号"></a>1.3.2. 二次剩余-膜意义下开根号</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::pair&lt;ll, ll&gt; pll;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> n, p;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Complex</span><br><span class="line">&#123;</span><br><span class="line">    ll mod, W, W0;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">comp</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        ll x, y;</span><br><span class="line">        comp(ll xx = <span class="number">0</span>, ll yy = <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            x = xx; y = yy;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    comp <span class="keyword">operator</span> * (comp a, comp b)</span><br><span class="line">    &#123;</span><br><span class="line">        ll tmp1 = (a.x * b.x + a.y * b.y % mod * W) % mod;</span><br><span class="line">        ll tmp2 = (a.x * b.y + a.y * b.x) % mod;</span><br><span class="line">        <span class="keyword">return</span> comp(tmp1, tmp2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">ksm</span><span class="params">(ll a, ll b, ll p)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(ll base = a; b; b &gt;&gt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ans = ans * base % p;</span><br><span class="line">            base = base * base % p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">comp <span class="title">ksm</span><span class="params">(comp a, ll b, ll p)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        comp t=comp(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">while</span>(b)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(b &amp; <span class="number">1</span>) t = t * a;</span><br><span class="line">            b &gt;&gt;= <span class="number">1</span>; a = a * a;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">pll <span class="title">surplus</span><span class="params">(ll x, ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Complex;</span><br><span class="line">    <span class="keyword">if</span>(!x) <span class="keyword">return</span> mp(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    mod = p;</span><br><span class="line">    <span class="keyword">if</span>(ksm(x, (mod<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>, mod) == mod<span class="number">-1</span>) <span class="keyword">return</span> mp(<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">    srand((<span class="keyword">unsigned</span>)time(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">233</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        W0 = rand() % mod;</span><br><span class="line">        W = (W0 * W0 % mod - x + mod) % mod;</span><br><span class="line">        <span class="keyword">if</span>(ksm(W, (mod<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>, mod) == mod<span class="number">-1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    comp a = ksm(comp(W0, <span class="number">1</span>), (mod+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>, mod);</span><br><span class="line">    <span class="keyword">return</span> mp(min(a.x, mod-a.x), max(a.x, mod-a.x));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;p);</span><br><span class="line">        pll ans = surplus(n, p);</span><br><span class="line">        <span class="keyword">if</span>(~ans.first)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!ans.first) <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(ans.first == ans.second) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans.first);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld %lld\n"</span>, ans.first, ans.second);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"Hola!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-3-欧拉定理"><a href="#1-3-3-欧拉定理" class="headerlink" title="1.3.3. 欧拉定理"></a>1.3.3. 欧拉定理</h3><h4 id="1-3-3-1-普通欧拉定理"><a href="#1-3-3-1-普通欧拉定理" class="headerlink" title="1.3.3.1. 普通欧拉定理"></a>1.3.3.1. 普通欧拉定理</h4><p>若 $gcd(a,m)=1$，则 $a^{\varphi(m)}\equiv 1 \ (mod\ m)$</p>
<h4 id="1-3-3-2-扩展欧拉定理"><a href="#1-3-3-2-扩展欧拉定理" class="headerlink" title="1.3.3.2. 扩展欧拉定理"></a>1.3.3.2. 扩展欧拉定理</h4><p>$$<br>a^b\equiv<br>\begin{cases}<br>a^{b\ mod \ \varphi(p)}, &amp; {gcd(a,p)=1}\cr<br>a^b, &amp; {gcd(a,p) \not =1,\ b&lt;\varphi(p)} \cr<br>a^{b\ mod \ \varphi(p)+\varphi(p)}, &amp; {gcd(a,p)\not =1,\ b \geq \varphi(p)}<br>\end{cases} \ \ \ (\bmod p)<br>$$</p>
<p>应用：欧拉降幂 <a href="https://nanti.jisuanke.com/t/41299" target="_blank" rel="noopener">2019南京网络赛B</a></p>
<p>求$a^{a^{…^{a}}}\ mod\ m$，其中一共有$b$个$a$。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 省略快速幂、求欧拉函数的模版</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">(ll a, ll k, ll m)</span> <span class="comment">// 判断a^k&gt;=m是否为真</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll b = a;</span><br><span class="line">    <span class="keyword">for</span>(; k; k--, b = b * a) <span class="keyword">if</span>(b &gt;= m) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> base, <span class="keyword">int</span> lev, <span class="keyword">int</span> mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(mod == <span class="number">1</span>) <span class="keyword">return</span> base &lt; mod ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!lev) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> tmp = solve(base, lev<span class="number">-1</span>, phi(mod));</span><br><span class="line">    <span class="keyword">int</span> ans = ksm(base, tmp, mod);</span><br><span class="line">    ans += mod * (tmp &lt; phi(mod) ? judge(base, tmp, mod) : <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;m);</span><br><span class="line">        <span class="keyword">int</span> ans = solve(a, b, m);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans % m);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-4-离散对数-BSGS"><a href="#1-3-4-离散对数-BSGS" class="headerlink" title="1.3.4. 离散对数-BSGS"></a>1.3.4. 离散对数-BSGS</h3><h4 id="1-3-4-1-普通BSGS"><a href="#1-3-4-1-普通BSGS" class="headerlink" title="1.3.4.1. 普通BSGS"></a>1.3.4.1. 普通BSGS</h4><p><a href="https://www.luogu.com.cn/problem/P3846" target="_blank" rel="noopener">洛谷P3846 可爱的质数</a></p>
<p>已知数 $a,b,p$，满足$p$是质数，求满足 $a^x\equiv b\bmod p$ 的最小自然数$x$。</p>
<p>思路：设 $y=\left\lceil\sqrt{p}\right\rceil$ ，记录下所有的 $a^i\cdot b$ 的值 $(i\in[0,y-1])$ ，然后看各个 $a^{ky}$ 的值 $(k\in[1,y])$，如果存在$a^{ky}\equiv a^i\cdot b$，则 $x=ky-i$ 即为所求。注意要求的是最小自然数 $x$ ，所以对于记录相同的 $a^i\cdot  b$ 值，$i$ 越大越好，所以加入map的过程中不需要判断。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; um; <span class="comment">// 手写哈希表速度更快，卡常用</span></span><br><span class="line"><span class="keyword">int</span> a, p, b;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"><span class="comment">// 这里的c只在exBSBS中用</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bsgs</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> p,<span class="keyword">int</span> c = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    um.clear();</span><br><span class="line">    <span class="keyword">int</span> f = <span class="number">1</span>, y = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p)), tmp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; y; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> fb = <span class="number">1L</span>L * f * b % p, fa = <span class="number">1L</span>L * f * a % p;</span><br><span class="line">        um[fb] = i;</span><br><span class="line">        f = fa;</span><br><span class="line">    &#125;</span><br><span class="line">    tmp = f;</span><br><span class="line">    f = <span class="number">1L</span>L * f * c % p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= y; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(um.count(f)) <span class="keyword">return</span> i * y - um[f];</span><br><span class="line">        f = <span class="number">1L</span>L * f * tmp % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;p, &amp;a, &amp;b) &amp;&amp; (a || p || b))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> ans = bsgs(a, b, p);</span><br><span class="line">        <span class="keyword">if</span>(~ans) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"no solution\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另一种思路：设 $y=\left\lceil\sqrt{p}\right\rceil$ ，记录下所有的 $a^i$ 的值 $(i\in[0,y-1])$ ，然后看各个 $a^{ky}\cdot b^{-1}$ 的值 $(k\in[1,y])$，如果存在$a^{ky}\cdot b^{-1}\equiv a^i$，则 $x=ky-i$ 即为所求。这种思路的优势在于应对多组相同 $a$ 、不同 $b$ 询问时，可以只预处理一次；缺点是需要知道 $b$ 的逆元，因此在 $p$ 不是质数的 exBSGS 中不能用。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bsgs</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    um.clear();</span><br><span class="line">    <span class="keyword">int</span> f = <span class="number">1</span>, y = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p)), tmp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; y; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        um[f] = i;</span><br><span class="line">        f = <span class="number">1L</span>L * f * a % p;</span><br><span class="line">    &#125;</span><br><span class="line">    tmp = f; f = <span class="number">1L</span>L * f * ni(b, p) % p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= y; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(um.count(f)) <span class="keyword">return</span> i * y - um[f];</span><br><span class="line">        f = <span class="number">1L</span>L * f * tmp % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-3-4-2-多组数据的处理"><a href="#1-3-4-2-多组数据的处理" class="headerlink" title="1.3.4.2. 多组数据的处理"></a>1.3.4.2. 多组数据的处理</h4><p><a href="https://ac.nowcoder.com/acm/contest/885/C" target="_blank" rel="noopener">2019牛客多校第五场C generator3</a></p>
<p>题目大意：给你 $n,x_0,a,b,p$，$x_i=(a\cdot x_{i−1}+b)\bmod p$。给你 $q$ 组询问 $v$，问你各个 $x_i(i\in[0,n-1])$ 中最小的 $i$ 使得 $x_i=v$ 。$(1\leq n≤10^{18},\ 0\leq x_p,a,b&lt;p\leq 10^9+9,\  p\in prime)$</p>
<p>分析：推柿子得到：$a^n=\frac{v(a-1)+b}{x_0(a-1)+b}$ 。处理掉各种特殊情况后，显然可以 BSGS。由于 $10^3$ 组询问和 $10^9$ 的质数处理范围，我们希望将复杂度均摊到 $O(10^6)$ 级别。因此设 $m=1000,y=\frac{p}{m}$ ，预处理时枚举 $i\in[0,y-1]$ 内的 $a^i$ 并用哈希表记录，每次询问只需要枚举 $k\in[1,m]$ 的 $a^{ky}$ ，复杂度被均摊。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> m = <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">int</span> T; ll n; <span class="keyword">int</span> x0, a, b, p;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> <span class="comment">// 略...</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> p)</span> <span class="comment">// 略...</span></span></span><br><span class="line"><span class="function"><span class="keyword">static</span> struct HashTable</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 略...</span></span><br><span class="line">&#125;tb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ff, yy;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> f = <span class="number">1</span>, y = <span class="built_in">ceil</span>(<span class="number">1.0</span> * p / m);</span><br><span class="line">    ff = ksm(a, y, p); yy = y;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; y; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        tb.add(f, i);</span><br><span class="line">        f = <span class="number">1L</span>L * f * a % p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bsgs</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> f = ff, y = yy, tmp = f;</span><br><span class="line">	<span class="comment">// 仿照上面的第二种思路，f变成a^y*ni(b)并赋值给tmp</span></span><br><span class="line">    f = <span class="number">1L</span>L * f * ni(b, p) % p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tb[f]) <span class="keyword">return</span> i * y - tb[f];</span><br><span class="line">        f = <span class="number">1L</span>L * f * tmp % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        tb.clear();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%d%d%d%d"</span>, &amp;n, &amp;x0, &amp;a, &amp;b, &amp;p);</span><br><span class="line">        <span class="keyword">int</span> q; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q);</span><br><span class="line">        <span class="keyword">if</span>(a != <span class="number">0</span> &amp;&amp; a != <span class="number">1</span>) init(a, p);</span><br><span class="line">        <span class="keyword">while</span>(q--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> v; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v);</span><br><span class="line">            <span class="keyword">int</span> ans;</span><br><span class="line">            <span class="keyword">if</span>(a == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(v == x0) <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(v == b)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(n == <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">                    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"1"</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(a == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (b == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(x0 == v) ans = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">else</span> ans = <span class="number">-1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    ans = <span class="number">1L</span>L * (v - x0 + p) * ni(b, p) % p;</span><br><span class="line">                    <span class="keyword">if</span>(ans &gt;= n) ans = <span class="number">-1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">            	<span class="keyword">int</span> w = (b + <span class="number">1L</span>L * a * x0 % p - x0 + p) % p;</span><br><span class="line">            	v = (<span class="number">1L</span>L * v * (a<span class="number">-1</span>) % p + b) % p;</span><br><span class="line">            	<span class="keyword">if</span>(w == <span class="number">0</span>)</span><br><span class="line">            	&#123;</span><br><span class="line">                	<span class="keyword">if</span>(v == <span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line">                	<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">            	&#125;</span><br><span class="line">            	<span class="keyword">else</span></span><br><span class="line">            	&#123;</span><br><span class="line">                	v = <span class="number">1L</span>L * v * ni(w,p) % p;</span><br><span class="line">                	<span class="keyword">if</span>(!v) ans = <span class="number">-1</span>;</span><br><span class="line">                	<span class="keyword">else</span> ans = bsgs(a, v, p); </span><br><span class="line">                    <span class="comment">// 这里已保证a&gt;=2,b&gt;=1,可以放心bsgs</span></span><br><span class="line">                	<span class="keyword">if</span>(ans &gt; n) <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">                	<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">            	&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-3-4-3-exBSGS"><a href="#1-3-4-3-exBSGS" class="headerlink" title="1.3.4.3. exBSGS"></a>1.3.4.3. exBSGS</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// 略...</span></span><br><span class="line">&#125;tb;</span><br><span class="line"><span class="keyword">int</span> a, p, b;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> <span class="comment">// 略...</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span> <span class="comment">// 略...</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span> <span class="comment">// 略...</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bsgs</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p, <span class="keyword">int</span> c = <span class="number">1</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    a %= p; b %= p;</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">1</span> || p == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(!a) <span class="keyword">return</span> b == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!b) <span class="keyword">return</span> a == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>;</span><br><span class="line">    tb.clear();</span><br><span class="line">    <span class="keyword">int</span> f = <span class="number">1</span>, y = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p)), tmp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; y; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> fb = <span class="number">1L</span>L * f * b % p, fa = <span class="number">1L</span>L * f * a % p;</span><br><span class="line">        tb.add(fb, i);</span><br><span class="line">        f = fa;</span><br><span class="line">    &#125;</span><br><span class="line">    tmp = f;</span><br><span class="line">    f = <span class="number">1L</span>L * f * c % p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= y; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(tb.count(f)) <span class="keyword">return</span> i * y - tb[f];</span><br><span class="line">        f = <span class="number">1L</span>L * f * tmp % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exbsgs</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>, c = <span class="number">1</span>, d;</span><br><span class="line">    <span class="keyword">while</span>((d = gcd(a,p)) != <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(b % d) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        p /= d; b /= d;</span><br><span class="line">        c = <span class="number">1L</span>L * c * (a/d) % p;</span><br><span class="line">        ret++;</span><br><span class="line">        <span class="keyword">if</span>(c == b) <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    d = bsgs(a, b, p, c);</span><br><span class="line">    <span class="keyword">return</span> d == <span class="number">-1</span> ? <span class="number">-1</span> : d+ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;p, &amp;b) &amp;&amp; (a || p || b))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> ans = exbsgs(a, b, p);</span><br><span class="line">        <span class="keyword">if</span>(~ans) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"No Solution\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-3-5-类欧几里得算法"><a href="#1-3-5-类欧几里得算法" class="headerlink" title="1.3.5. 类欧几里得算法"></a>1.3.5. 类欧几里得算法</h3><p>$$<br>\begin{aligned}<br>f(n)&amp;=\sum^n_{i=0}\left\lfloor\frac{ai+b}{c}\right\rfloor \bmod {998244353}\cr<br>g(n)&amp;=\sum^n_{i=0}i\left\lfloor\frac{ai+b}{c}\right\rfloor \bmod {998244353}\cr<br>h(n)&amp;=\sum^n_{i=0}\left\lfloor\frac{ai+b}{c}\right\rfloor^2 \bmod {998244353}<br>\end{aligned}<br>$$</p>
<h4 id="1-3-5-1-模版"><a href="#1-3-5-1-模版" class="headerlink" title="1.3.5.1. 模版"></a>1.3.5.1. 模版</h4><p><a href="https://www.luogu.com.cn/problem/P5170" target="_blank" rel="noopener">洛谷P5170 类欧几里得算法</a></p>
<p>拆开用（过不了模版题）：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> inv2 = <span class="number">499122177</span>, inv6 = <span class="number">166374059</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 特别注意！如果n,a,b,c初值处于long long范围，需要：</span></span><br><span class="line"><span class="comment">// typedef __int128 ll;</span></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll a, ll b, ll c, ll n)</span></span>;</span><br><span class="line"><span class="function">ll <span class="title">g</span><span class="params">(ll a, ll b, ll c, ll n)</span></span>;</span><br><span class="line"><span class="function">ll <span class="title">h</span><span class="params">(ll a, ll b, ll c, ll n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll a, ll b, ll c, ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!n) <span class="keyword">return</span> (b / c);</span><br><span class="line">    <span class="keyword">if</span>(!a) <span class="keyword">return</span> (n + <span class="number">1</span>) * (b / c) % mod;</span><br><span class="line">    <span class="keyword">if</span>(a &gt;= c || b &gt;= c)</span><br><span class="line">        <span class="keyword">return</span> ((a/c) * n % mod * (n+<span class="number">1</span>) % mod * inv2 % mod</span><br><span class="line">                + (b/c) * (n+<span class="number">1</span>) % mod + f(a%c, b%c, c, n)) % mod;</span><br><span class="line">    ll m = (a * n + b) / c;</span><br><span class="line">    <span class="keyword">return</span> (n * m % mod - f(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>) + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">g</span><span class="params">(ll a, ll b, ll c, ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">0</span>) <span class="keyword">return</span> (b / c) * n % mod * (n + <span class="number">1</span>) % mod * inv2 % mod;</span><br><span class="line">    <span class="keyword">if</span> (a &gt;= c || b &gt;= c)</span><br><span class="line">        <span class="keyword">return</span> ((g(a % c, b % c, c, n) + (a / c) * n % mod * (n + <span class="number">1</span>) % mod</span><br><span class="line">                * (<span class="number">2</span> * n + <span class="number">1</span>) % mod * inv6 % mod + (b / c) * n % mod</span><br><span class="line">                * (n + <span class="number">1</span>) % mod * inv2 % mod) % mod + mod) % mod;</span><br><span class="line">    ll m = (a * n + b) / c;</span><br><span class="line">    <span class="keyword">return</span> ((n * (n + <span class="number">1</span>) % mod * m % mod - f(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>)</span><br><span class="line">            - h(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>)) % mod * inv2 % mod + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">h</span><span class="params">(ll a, ll b, ll c, ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> (b / c) * (b / c) % mod;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">0</span>) <span class="keyword">return</span> (n + <span class="number">1</span>) * (b / c) % mod * (b / c) % mod;</span><br><span class="line">    <span class="keyword">if</span> (a &gt;= c || b &gt;= c)</span><br><span class="line">        <span class="keyword">return</span> (((a / c) * (a / c) % mod * n % mod * (n + <span class="number">1</span>) % mod</span><br><span class="line">                * (<span class="number">2</span> * n + <span class="number">1</span>) % mod * inv6 % mod + (b / c) * (b / c) % mod</span><br><span class="line">                * (n + <span class="number">1</span>) % mod + (a / c) * (b / c) % mod * n % mod</span><br><span class="line">                * (n + <span class="number">1</span>) % mod + h(a % c, b % c, c, n) + <span class="number">2</span> * (a / c) % mod</span><br><span class="line">                * g(a % c, b % c, c, n) % mod + <span class="number">2</span> * (b / c) % mod</span><br><span class="line">                * f(a % c, b % c, c, n) % mod) % mod + mod) % mod;</span><br><span class="line">    ll m = (a * n + b) / c;</span><br><span class="line">    <span class="keyword">return</span> ((n * m % mod * (m + <span class="number">1</span>) % mod - <span class="number">2</span> * g(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>)</span><br><span class="line">            - <span class="number">2</span> * f(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>) - f(a, b, c, n)) % mod + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T = read(); <span class="keyword">int</span> n, a, b, c;</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        n = read(); a = read(); b = read(); c = read();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %lld %lld\n"</span>, f(a, b, c, n), h(a, b, c, n), g(a, b, c, n));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>合起来写：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">constexpr</span> ll inv2 = <span class="number">499122177</span>;</span><br><span class="line"><span class="keyword">constexpr</span> ll inv6 = <span class="number">166374059</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll a, ll b, ll c, ll n)</span></span>;</span><br><span class="line"><span class="function">ll <span class="title">g</span><span class="params">(ll a, ll b, ll c, ll n)</span></span>;</span><br><span class="line"><span class="function">ll <span class="title">h</span><span class="params">(ll a, ll b, ll c, ll n)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Query</span> &#123;</span></span><br><span class="line">    ll f, g, h;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">Query <span class="title">solve</span><span class="params">(ll a, ll b, ll c, ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Query ans, tmp;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ans.f = (n + <span class="number">1</span>) * (b / c) % mod;</span><br><span class="line">        ans.g = (b / c) * n % mod * (n + <span class="number">1</span>) % mod * inv2 % mod;</span><br><span class="line">        ans.h = (n + <span class="number">1</span>) * (b / c) % mod * (b / c) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (a &gt;= c || b &gt;= c) &#123;</span><br><span class="line">        tmp = solve(a % c, b % c, c, n);</span><br><span class="line">        ans.f = (tmp.f + (a / c) * n % mod * (n + <span class="number">1</span>) % mod * inv2 % mod + (b / c) * (n + <span class="number">1</span>) % mod) % mod;</span><br><span class="line">        ans.g = (tmp.g + (a / c) * n % mod * (n + <span class="number">1</span>) % mod * (<span class="number">2</span> * n + <span class="number">1</span>) % mod * inv6 % mod + (b / c) * n % mod * (n + <span class="number">1</span>) % mod * inv2 % mod) % mod;</span><br><span class="line">        ans.h = ((a / c) * (a / c) % mod * n % mod * (n + <span class="number">1</span>) % mod * (<span class="number">2</span> * n + <span class="number">1</span>) % mod * inv6 % mod + (b / c) * (b / c) % mod * (n + <span class="number">1</span>) % mod + (a / c) * (b / c) % mod * n % mod * (n + <span class="number">1</span>) % mod + tmp.h + <span class="number">2</span> * (a / c) % mod * tmp.g % mod + <span class="number">2</span> * (b / c) % mod * tmp.f % mod) % mod;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        ll m = (a * n + b) / c;</span><br><span class="line">        tmp = solve(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>);</span><br><span class="line">        ans.f = (n * (m % mod) % mod - tmp.f) % mod;</span><br><span class="line">        ans.g = (n * (n + <span class="number">1</span>) % mod * (m % mod) % mod - tmp.f - tmp.h) % mod * inv2 % mod;</span><br><span class="line">        ans.h = (n * (m % mod) % mod * ((m + <span class="number">1</span>) % mod) % mod - <span class="number">2</span> * tmp.g - <span class="number">2</span> * tmp.f - ans.f) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    (ans.f += mod) %= mod; (ans.g += mod) %= mod; (ans.h += mod) %= mod;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T = read(); <span class="keyword">int</span> n, a, b, c;</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        n = read(); a = read(); b = read(); c = read();</span><br><span class="line">        Query ans = solve(a, b, c, n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %lld %lld\n"</span>, ans.f, ans.h, ans.g);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-3-5-2-栗子"><a href="#1-3-5-2-栗子" class="headerlink" title="1.3.5.2. 栗子"></a>1.3.5.2. 栗子</h4><p><a href="https://ac.nowcoder.com/acm/contest/889/I" target="_blank" rel="noopener">2019牛客多校第九场I KM and M</a></p>
<ul>
<li>题目大意：求</li>
</ul>
<p>$$<br>\sum_{k=1}^{N}((kM)\ and \ M) \ (1 &lt;= N &lt;= 10^{18}, 1 &lt;= M &lt;= 10^{11})<br>$$</p>
<ul>
<li>分析：</li>
</ul>
<p>可以按位做。判断一个数 $x$ 的第 $i$ 位是不是 $1$ ，设 $a=(x&gt;&gt;(i-1))$，$b=((x&lt;&lt;i)&gt;&gt;1)$ ，则 $x$ 的第 $i$ 位等于 $a-b$ 。又当且仅当 $M$ 和 $kM$ 的第 $i$ 位都是 $1$ 时，$kM$ 在这一位贡献 $2^{i-1}$ 。因此：<br>$$<br>ans=\sum_{i=1}^{(1&lt;&lt;(i-1))\leq m}\left(\sum_{k=1}^{N}\left(\left\lfloor\frac{kM}{2^{i-1}}\right\rfloor-2\left\lfloor\frac{kM}{2^{i}}\right\rfloor\right)\right)\cdot 2^{i-1}<br>$$<br>两个求和均可用类欧几里得求。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> __int128 ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inv2 = <span class="number">500000004</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> n, m;</span><br><span class="line"></span><br><span class="line">ll pow2[<span class="number">70</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pow2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">70</span>; i++) pow2[i] = pow2[i<span class="number">-1</span>] * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll a, ll b, ll c, ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!n) <span class="keyword">return</span> (b / c);</span><br><span class="line">    <span class="keyword">if</span>(!a) <span class="keyword">return</span> (n + <span class="number">1</span>) * (b / c) % mod;</span><br><span class="line">    <span class="keyword">if</span>(a &gt;= c || b &gt;= c)</span><br><span class="line">        <span class="keyword">return</span> ((a/c) * n % mod * (n+<span class="number">1</span>) % mod * inv2 % mod</span><br><span class="line">                + (b/c) * (n+<span class="number">1</span>) % mod + f(a%c, b%c, c, n)) % mod;</span><br><span class="line">    ll m = (a * n + b) / c;</span><br><span class="line">    <span class="keyword">return</span> (n * m % mod - f(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>) + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; pow2[i<span class="number">-1</span>] &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(((m &gt;&gt; (i<span class="number">-1</span>)) &amp; <span class="number">1</span>) == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">        ll tmp1 = f(m, <span class="number">0</span>, pow2[i<span class="number">-1</span>], n);</span><br><span class="line">        ll tmp2 = f(m, <span class="number">0</span>, pow2[i], n) * <span class="number">2</span> % mod;</span><br><span class="line">        ll tmp3 = pow2[i<span class="number">-1</span>] % mod;</span><br><span class="line">        ans = (ans + (tmp1 - tmp2 + mod) * tmp3 % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-4-数论函数"><a href="#1-4-数论函数" class="headerlink" title="1.4. 数论函数"></a>1.4. 数论函数</h2><h3 id="1-4-1-前置芝士"><a href="#1-4-1-前置芝士" class="headerlink" title="1.4.1. 前置芝士"></a>1.4.1. 前置芝士</h3><h4 id="1-4-1-1-引理"><a href="#1-4-1-1-引理" class="headerlink" title="1.4.1.1. 引理"></a>1.4.1.1. 引理</h4><p>$$<br>\left\lfloor\frac{a}{bc}\right\rfloor=\left\lfloor\frac{\lfloor\frac{a}{b}\rfloor}{c}\right\rfloor<br>$$</p>
<h4 id="1-4-1-2-数论分块"><a href="#1-4-1-2-数论分块" class="headerlink" title="1.4.1.2. 数论分块"></a>1.4.1.2. 数论分块</h4><p><a href="https://www.luogu.org/problem/P1403" target="_blank" rel="noopener">洛谷P1403</a></p>
<p>题目大意：设$f(x)$为$x$的约数个数，求$\sum_{i=1}^{n}f(i)$</p>
<p>枚举约数$i$。从$1$～$n$中，含有约数$i$的数的个数为$\left\lfloor\frac{n}{i}\right\rfloor$，因此<br>$$ans=\sum_{i=1}^{n}\left\lfloor\frac{n}{i}\right\rfloor$$<br>但我们发现有许多$\left\lfloor\frac{n}{i}\right\rfloor$是重复的。设$j=\frac{n}{\left\lfloor\frac{n}{i}\right\rfloor}$，即有$j$个数使得$\left\lfloor\frac{n}{i}\right\rfloor\leq\left\lfloor\frac{n}{j}\right\rfloor$，因此对于每个$\left\lfloor\frac{n}{i}\right\rfloor$有$(j-i+1)$个重复项。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, j; i &lt;= n; i = j+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        j = n / (n/i);</span><br><span class="line">        ans += (n/i) * (j-i+<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>双重数论分块：求解$\sum_{d=1}^{n}f(\left\lfloor\frac{n}{d}\right\rfloor,\left\lfloor\frac{m}{d}\right\rfloor)$形式的柿子</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">1</span>, r; l &lt;= n; l = r+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = min(n/(n/l), m/(m/l));</span><br><span class="line">        <span class="comment">// insert your code here...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-2-积性函数"><a href="#1-4-2-积性函数" class="headerlink" title="1.4.2. 积性函数"></a>1.4.2. 积性函数</h3><p>定义：若$gcd(x,y)=1$ 且 $f(xy)=f(x)f(y)$，则 $f(n)$ 为积性函数。<br>完全积性函数：不要求 $gcd(x,y)=1$。</p>
<p>性质：若$f(x)$和$g(x)$均为积性函数，则以下函数也为积性函数：<br>$$<br>\begin{aligned}<br>h(x)&amp;=f(x^p)\<br>h(x)&amp;=f^p(x)\<br>h(x)&amp;=f(x)g(x)\<br>h(x)&amp;=\sum_{d|x}f(d)g(\frac{x}{d})<br>\end{aligned}<br>$$<br>例子：</p>
<ul>
<li>单位函数：$\varepsilon(n)=[n=1]$</li>
<li>恒等函数：$\operatorname{id}(n)=n$</li>
<li>除数函数：$\sigma_{k}(n)=\sum_{d\mid n}d^k$<br>其中$\sigma_{0}(n)=d(n)$为约数个数函数，$\sigma_{0}(n)=\sigma(n)$为除数函数</li>
<li>常数函数：$I(n)=1$</li>
<li>欧拉函数：$\varphi(n)=\sum_{i=1}^{n}[\gcd(i,n)=1]$</li>
<li>莫比乌斯函数（此处省略）</li>
</ul>
<h3 id="1-4-3-狄利克雷Dirichlet卷积"><a href="#1-4-3-狄利克雷Dirichlet卷积" class="headerlink" title="1.4.3. 狄利克雷Dirichlet卷积"></a>1.4.3. 狄利克雷Dirichlet卷积</h3><p>定义：两个数论函数$f$和$g$的狄利克雷卷积：<br>$$(f*g)(n) = \sum_{d\ |\ n} f(d) g(\frac{n}{d})$$<br>性质：$\varepsilon$为单位元即$\varepsilon *f=f$；</p>
<p>​           卷积具有结合律：$(a<em>b)*c=a</em>(b*c)$.</p>
<p>例子：</p>
<p>$$<br>\begin{aligned}<br>\varepsilon=\mu*I&amp;\iff\varepsilon(n)=\sum_{d|n}\mu(d)\cr<br>\varphi * I = id &amp;\iff\sum_{d|n}\varphi(d)=n\cr<br>\mu * id = \varphi&amp;\iff\sum_{d|n}d\cdot\mu(\frac{n}{d})=\varphi(n)<br>\end{aligned}<br>$$</p>
<h3 id="1-4-4-欧拉函数"><a href="#1-4-4-欧拉函数" class="headerlink" title="1.4.4. 欧拉函数"></a>1.4.4. 欧拉函数</h3><h4 id="1-4-4-1-定义与性质"><a href="#1-4-4-1-定义与性质" class="headerlink" title="1.4.4.1. 定义与性质"></a>1.4.4.1. 定义与性质</h4><p>$\varphi(n)$表示小于等于$n$和$n$互质的数的个数。当$n$是质数时，显然$\varphi(n)=n-1$。</p>
<p>$$设n=p_1^{k_1}p_2^{k_2}\cdots p_s^{k_s}，则\varphi(n)=n*\prod_{i=1}^{s}\frac{p_i-1}{p_i}。$$</p>
<p>$$\varphi({p}^{k})=p^k-p^{k-1},p\in{prime}$$</p>
<p>$$m=\sum_{d|m}\varphi(d)，即\varphi(d_1)+\varphi(d_2)+…+\varphi(m)=m,d|m$$</p>
<h4 id="1-4-4-2-求单个欧拉函数"><a href="#1-4-4-2-求单个欧拉函数" class="headerlink" title="1.4.4.2. 求单个欧拉函数"></a>1.4.4.2. 求单个欧拉函数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 过程类似分解质因数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">phi</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= x; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(x % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = ans / i * (i<span class="number">-1</span>);</span><br><span class="line">            <span class="keyword">while</span>(x % i == <span class="number">0</span>) x /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x &gt; <span class="number">1</span>) ans = ans / x * (x<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-4-4-3-线性筛欧拉函数"><a href="#1-4-4-3-线性筛欧拉函数" class="headerlink" title="1.4.4.3. 线性筛欧拉函数"></a>1.4.4.3. 线性筛欧拉函数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> phi[MAXN], prime[MAXN], num[MAXN], tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!num[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[++tot] = i;</span><br><span class="line">            phi[i] = i<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * prime[j] &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            num[prime[j]*i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                phi[i*prime[j]] = phi[i] * prime[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            phi[i*prime[j]] = phi[i] * phi[prime[j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-5-莫比乌斯函数"><a href="#1-4-5-莫比乌斯函数" class="headerlink" title="1.4.5. 莫比乌斯函数"></a>1.4.5. 莫比乌斯函数</h3><h4 id="1-4-5-1-定义与性质"><a href="#1-4-5-1-定义与性质" class="headerlink" title="1.4.5.1. 定义与性质"></a>1.4.5.1. 定义与性质</h4><p>定义：<br>$$<br>\mu(x)=<br>\begin{cases}<br>1&amp; {x=1}\cr<br>(-1)^k &amp; {x=p_1p_2…p_k}\cr<br>0 &amp; \text{other cases}<br>\end{cases}<br>$$<br>性质：<br>$$<br>\sum_{d|x}\mu(d)=<br>\begin{cases}<br>1&amp; {x=1}\cr<br>0 &amp; {x&gt;1}<br>\end{cases}<br>$$<br>即 $\sum_{d|n}\mu(d)=\mu(n)*I(n)=\varepsilon(n)$</p>
<p>从通俗上讲：</p>
<ul>
<li>莫比乌斯函数$μ(n)$的定义域是正整数</li>
<li>$μ(1)=1$</li>
<li>当$n$存在平方因子时，$μ(n)=0$</li>
<li>当$n$是素数或奇数个不同素数之积时，$μ(n)=-1$</li>
<li>当$n$是偶数个不同素数之积时，$μ(n)=1$</li>
</ul>
<h4 id="1-4-5-2-线性筛莫比乌斯函数"><a href="#1-4-5-2-线性筛莫比乌斯函数" class="headerlink" title="1.4.5.2. 线性筛莫比乌斯函数"></a>1.4.5.2. 线性筛莫比乌斯函数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> prime[MAXN], num[MAXN], mu[MAXN], tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_mu</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!num[i]) <span class="comment">// 质数的莫比乌斯函数都是-1</span></span><br><span class="line">        &#123;</span><br><span class="line">            prime[++tot] = i;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * prime[j] &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            num[i*prime[j]] = <span class="number">1</span>; <span class="comment">// i中不含有约数prime[j]，质约数个数+1</span></span><br><span class="line">            <span class="keyword">if</span>(i % prime[j]) mu[i*prime[j]] = -mu[i];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>; <span class="comment">// 出现平方因子即为0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-6-莫比乌斯函数作为系数的容斥定理"><a href="#1-4-6-莫比乌斯函数作为系数的容斥定理" class="headerlink" title="1.4.6. 莫比乌斯函数作为系数的容斥定理"></a>1.4.6. 莫比乌斯函数作为系数的容斥定理</h3><p>当一个问题的容斥与其全部因子相关时，常常用莫比乌斯函数作为容斥系数。</p>
<p><a href="https://blog.csdn.net/weixin_43061340/article/details/96931899" target="_blank" rel="noopener">XMU区域赛选拔D 塔子哥数数</a></p>
<p>题目大意：设$g(x)$为莫比乌斯函数的绝对值，把$g(1)g(2)g(3)…g(n)$连起来看成一个10进制数，其中$g(1)$是最高位，那么这个数是多少。</p>
<p>正难则反，我们可以先考虑所有位是$1$，再刨除$g(i)=0$的位置。</p>
<ul>
<li>计算所有位是$1$的$n$位数对$1000000007$取模</li>
</ul>
<p>$$<br>S(n)=\frac{10^n-1}{9}<br>$$</p>
<ul>
<li>计算$g(i)=0$的位置贡献的值<br>由$g(x)$的定义，我们可以看出所有$2^2,3^2,…,k^2(k^2\leq n)$的倍数要被刨除。对于$k^2$，我们要刨除的总和：<br>由于$g(k^2),g(2k^2)…$从高位向地位排列，因此这是一个以$10^{n-k^2}$为首项、$10^{-k^2}$为公比、$\left\lfloor\frac{n}{k^2}\right\rfloor$为项数的等比数列。因此，</li>
</ul>
<p>$$<br>S(k)=\frac{10^{n-k^2}(1-10^{-k^2*\left\lfloor\frac{n}{k^2}\right\rfloor})}{1-10^{-k^2}}<br>$$</p>
<ul>
<li><p>用容斥原理排除重复计算<br>对于每个$S(k)$，在计算其每个因子时均计算了一次$k$，因此应当用莫比乌斯函数作为容斥系数。</p>
</li>
<li><p>得到答案</p>
</li>
</ul>
<p>$$<br>ans=\frac{10^n-1}{9}+\sum_{k=2}^{k^2\leq n}\mu(k)\cdot\frac{10^{n-k^2}(1-10^{-k^2*\left\lfloor\frac{n}{k^2}\right\rfloor})}{1-10^{-k^2}}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line">ll n;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXN], num[MAXN], mu[MAXN], tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_mu</span><span class="params">()</span> <span class="comment">//略</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, ll b)</span> <span class="comment">// 略</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> p)</span> <span class="comment">// 略</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">    ll ans = <span class="number">1L</span>L * (ksm(<span class="number">10</span>,n)<span class="number">-1</span>) * ni(<span class="number">9</span>,mod) % mod;</span><br><span class="line">    get_mu();</span><br><span class="line">    <span class="keyword">for</span>(ll i = <span class="number">2</span>; i * i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp1 = (ksm(<span class="number">10</span>, <span class="number">1L</span>L*i*i*(n/(i*i))) - </span><br><span class="line">                    ksm(<span class="number">10</span>, i*i*(n/(i*i)<span class="number">-1</span>)) + mod) % mod;</span><br><span class="line">        <span class="keyword">int</span> tmp2 = (ksm(<span class="number">10</span>, <span class="number">1L</span>L*i*i*(n/(i*i))) - <span class="number">1</span> + mod) % mod;</span><br><span class="line">        <span class="keyword">int</span> tmp3 = ksm(<span class="number">10</span>, n-i*i);</span><br><span class="line">        <span class="keyword">int</span> tmp4 = <span class="number">1L</span>L * mu[i] * tmp2 * tmp3 % mod * ni(tmp1,mod) % mod;</span><br><span class="line">        <span class="keyword">if</span>(mu[i] &gt; <span class="number">0</span>) ans = (ans + tmp4) % mod;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(mu[i] &lt; <span class="number">0</span>) ans = (ans + tmp4 + mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://nanti.jisuanke.com/t/42384" target="_blank" rel="noopener">2019银川区域赛D</a></p>
<p>题目大意：一个$(n,m,d)$好序列 $(a_{1},a_{2},…,a_{n})$ 当且仅当 $1 \leq a_{i} \leq m~(1 \le i \le n)$ 且 $\gcd(a_{1},a_{2},\cdots,a_{n})=d$。定义$f((a_{1},a_{2},…a_{n}),k) = (a_{1}a_{2} \cdots a_{n})^{k}$，求$\sum f(q, k)$，$q$为好序列。</p>
<ul>
<li><p>step1<br>由于 $\gcd(a_{1},a_{2},\cdots,a_{n})=d$，因此我们可以将每个数提出一个$d$，在式子外面乘上一个$(d^k)^n$。<br>剩下可选取的数：<br>$$<br>\begin{bmatrix}\lfloor \frac{m}{d}\rfloor &amp; \lfloor\frac{m}{d}\rfloor &amp; … &amp; \lfloor\frac{m}{d}\rfloor &amp; \lfloor\frac{m}{d}\rfloor\cr …&amp;…&amp;…&amp;…&amp;… \cr 3&amp;3&amp;…&amp;3&amp;3\cr 2&amp;2&amp;…&amp;2&amp;2\cr 1&amp;1&amp;…&amp;1&amp;1 \end{bmatrix}<br>$$</p>
</li>
<li><p>step2<br>由分配律，</p>
</li>
</ul>
<p>$$<br>\sum(a_{1}a_{2} \cdots a_{n})^{k}=\bigg(\sum_{i=1}^{\lfloor \frac{m}{d}\rfloor}i^k\bigg)^n<br>$$</p>
<ul>
<li>step3<br>考虑到 $\gcd(a_{1},a_{2},\cdots,a_{n})\not= 1$ 的情况，我们容易发现这是一个和约数有关的容斥原理，即容斥系数应当是莫比乌斯函数！</li>
</ul>
<p>对于 $\gcd(a_{1},a_{2},\cdots,a_{n})= b$, 剩下可选的数：</p>
<p>$$<br>\begin{bmatrix}\lfloor \frac{m}{bd}\rfloor&amp;\lfloor \frac{m}{bd}\rfloor&amp;…&amp;\lfloor \frac{m}{bd}\rfloor &amp; \lfloor \frac{m}{bd}\rfloor\cr …&amp;…&amp;…&amp;…&amp;… \cr 3b&amp;3b&amp;…&amp;3b&amp;3b\cr2b&amp;2b&amp;…&amp;2b&amp;2b\cr b&amp;b&amp;…&amp;b&amp;b\cr \end{bmatrix}<br>$$</p>
<p>$$<br>\sum(a_{1}a_{2} \cdots a_{n})^{k}=\left(\bigg(\sum_{i=1}^{\lfloor \frac{m}{bd}\rfloor}i^k\bigg)b^k\right)^n<br>$$</p>
<ul>
<li>step4</li>
</ul>
<p>$$<br>ans=(d^k)^n\sum_{i=1}^{\lfloor \frac{m}{d}\rfloor}\mu(i)\left(\bigg(\sum_{j=1}^{\lfloor \frac{m}{id}\rfloor}j^k\bigg)i^k\right)^n<br>$$</p>
<p>我们注意到$n$只出现于指数上，由扩展欧拉定理，可以在读入$n$时对$\varphi(mod)$取模；对于每次询问，我们可以$O(m)$预处理出 $k^1,k^2,…,k^m$ ，以及其前缀和。计算时，对于内层括号里的东西我们就可以$O(1)$求，再跑一个快速幂，总体复杂度$O(T*mlog_n)$。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">59964251</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> phi = <span class="number">59870352</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> T, n, m, d, k;</span><br><span class="line"><span class="keyword">char</span> s[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> maxup;</span><br><span class="line"><span class="keyword">int</span> powk[MAXN], sumpowk[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getmod</span><span class="params">(<span class="keyword">int</span> mo)</span> <span class="comment">// 略</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> <span class="comment">// 略</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> <span class="comment">// 略</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line">int mu[MAXN], prime[MAXN], num[MAXN], tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">()</span> <span class="comment">// 略</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    maxup = m / d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxup; i++) powk[i] = ksm(i, k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxup; i++) </span><br><span class="line">        sumpowk[i] = add(sumpowk[i<span class="number">-1</span>], powk[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= maxup; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp1 = maxup / i;</span><br><span class="line">        <span class="keyword">int</span> tmp2 = <span class="number">1L</span>L * sumpowk[tmp1] * powk[i] % mod;</span><br><span class="line">        <span class="keyword">int</span> tmp3 = ksm(tmp2, n);</span><br><span class="line">        (sum += mod + tmp3 * mu[i]) %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">1L</span>L * n * k % phi;</span><br><span class="line">    sum = <span class="number">1L</span>L * sum * ksm(d, b) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    pre();</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        n = getmod(phi);</span><br><span class="line">        <span class="keyword">if</span>(!n) n = phi;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;m, &amp;d, &amp;k);</span><br><span class="line">        k %= phi; <span class="keyword">if</span>(!k) k = phi;</span><br><span class="line">        init(); work();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.luogu.com.cn/problem/CF1285F" target="_blank" rel="noopener">CF1285F Classical?</a></p>
<p>题目大意：给$n$个数 $a_1,a_2,\cdots ,a_n$ ，求<br>$$<br>\max_{1\leq i\leq n}lcm(i,j)<br>$$<br>枚举答案 $a_i,a_j$ 的最大公约数$g$。对于每个$g$，我们取出所有$g$的倍数并都除以$g$，按照从大到小排列。维护一个栈，元素从大到小依次如栈。对于当前遍历到的数$y$，如果栈内存在一个$x$使得$gcd(x,y)=1$，那么在当前这个$g$的条件下，所有$y\leq z\leq x$的$z$失去意义，从栈中弹出。</p>
<p>考虑如何判断栈中是否有数和$y$互质：由于一个数的$1$以外因子及其全部倍数都与其本身不互质，记$cnt_i$为栈中$i$倍数的个数，那么这就是一个以莫比乌斯函数为容斥系数的容斥定理，即与$y$互质数的个数：</p>
<p>$$<br>\sum_{d|y}\mu(d)*cnt_i<br>$$<br>我们可以预处理出所有数的全部因子。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAX = <span class="number">1e5</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[MAXN], b[MAXN];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> <span class="comment">//略</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line">vector&lt;int&gt; d[MAXN];</span><br><span class="line"><span class="keyword">int</span> mu[MAXN], used[MAXN], prime[MAXN], tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 线性筛mu部分略。以下为预处理全部因子。</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i; j &lt; MAXN; j += i)</span><br><span class="line">        &#123;</span><br><span class="line">            d[j].push_back(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line"><span class="keyword">int</span> cnt[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">coprime</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">// 返回栈中与x互质数的个数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i : d[x]) ret += cnt[i] * mu[i];</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span> <span class="comment">//栈中加入x，其全部因子的倍数个数加1。弹出栈同理</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i : d[x]) cnt[i] += v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n = read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a[i] = read(); b[a[i]] = <span class="number">1</span>; <span class="comment">// 离散化+去重</span></span><br><span class="line">        ans = max(ans, (<span class="keyword">long</span> <span class="keyword">long</span>)a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> g = <span class="number">1</span>; g &lt;= MAX; g++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> beg = MAX / g;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = beg; i; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(!b[i*g]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">int</span> num = coprime(i);</span><br><span class="line">            <span class="keyword">while</span>(num)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(gcd(s.top(), i) == <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(num == <span class="number">1</span>) ans = max(ans, <span class="number">1L</span>L * s.top() * i * g);</span><br><span class="line">                    num--;</span><br><span class="line">                &#125;</span><br><span class="line">                update(s.top(), <span class="number">-1</span>); s.pop();</span><br><span class="line">            &#125;</span><br><span class="line">            s.push(i); update(i, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!s.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            update(s.top(), <span class="number">-1</span>);</span><br><span class="line">            s.pop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-7-莫比乌斯反演"><a href="#1-4-7-莫比乌斯反演" class="headerlink" title="1.4.7. 莫比乌斯反演"></a>1.4.7. 莫比乌斯反演</h3><h4 id="1-4-7-1-形式与套路式"><a href="#1-4-7-1-形式与套路式" class="headerlink" title="1.4.7.1. 形式与套路式"></a>1.4.7.1. 形式与套路式</h4><p><strong>划重点！一切莫比乌斯反演题推柿子都等价于以下套路!</strong><br>$$<br>\begin{aligned}<br>[gcd(i,j)=1]&amp;\iff\sum_{d\mid gcd(i,j)}\mu(d)\cr<br>&amp;\iff\sum_{d\mid i}\sum_{d\mid j}\mu(d)\cr<br>&amp;\iff\sum_{d}\sum_{i=1}^{\lfloor\frac{i}{d}\rfloor}\sum_{j=1}^{\lfloor\frac{j}{d}\rfloor}\mu(d)<br>\end{aligned}<br>$$<br><strong>形式一：</strong><br>设有函数$f(x)$与$F(x)$，则有：<br>$$<br>F(n)=\sum_{d|n}f(d)\iff f(n)=\sum_{d|n}\mu(d)F\left(\frac{n}{d}\right)<br>$$<br><strong>形式二：</strong><br>设有函数$f(x)$与$F(x)$，则有：<br>$$<br>F(n)=\sum_{n|d}f(d)\iff f(n)=\sum_{n|d}\mu\left(\frac{d}{n}\right)F(d)<br>$$</p>
<h4 id="1-4-7-2-重要结论"><a href="#1-4-7-2-重要结论" class="headerlink" title="1.4.7.2. 重要结论"></a>1.4.7.2. 重要结论</h4><p><strong>结论一：</strong><br>$$<br>\sum_{i=1}^{n}[gcd(i,n)=1]\cdot i=\frac{n\cdot\varphi(n)}{2}<br>$$<br>感性理解：$gcd(i,n)=gcd(n-i,n)$，因此与$n$互质的数总是成对出现且每对的和为$n$.</p>
<p>注意：做题时要特判$n=1$时上式为$1$.</p>
<p>也可用上面的套路式化简出（略）</p>
<p><strong>结论二：</strong></p>
<p>设d(n)为n的约数个数函数：<br>$$<br>d(i\cdot j)=\sum_{s|i}\sum_{y|j}[gcd(x,y)=1]<br>$$</p>
<h4 id="1-4-7-3-栗子"><a href="#1-4-7-3-栗子" class="headerlink" title="1.4.7.3. 栗子"></a>1.4.7.3. 栗子</h4><p><a href="https://www.luogu.com.cn/problem/P1829" target="_blank" rel="noopener">洛谷P1829 Crash的数字表格</a></p>
<p>$$<br>\begin{aligned}<br>&amp;\sum_{i=1}^{n}\sum_{j=1}^{m}lcm(i,j)\cr<br>&amp;=\sum_{i=1}^{n}\sum_{j=1}^{m}\frac{i j}{gcd(i,j)}\cr<br>&amp;=\sum_{d}\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)=d]\cdot\frac{i j}{d}\cr<br>&amp;=\sum_{d}\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)=1]\cdot i\cdot j\cdot d\cr\cr<br>设 sum(n,m)&amp;=\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)=d]\cdot i\cdot j\cr<br>&amp;=\sum_{d}\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}\sum_{j=1}^{\lfloor\frac{m}{d}\rfloor}\mu(d)\cdot d^2\cdot i\cdot j\cr<br>&amp;=\sum_{d}d^2\cdot mu(d)\cdot g(\lfloor\frac{n}{d}\rfloor,\lfloor\frac{m}{d}\rfloor)\ \ ，其中g(n,m)=\frac{n(n+1)}{2}\cdot\frac{m(m+1)}{2}\cr<br>\therefore 原式&amp;=\sum_{d}d\cdot sum(\lfloor\frac{n}{d}\rfloor,\lfloor\frac{m}{d}\rfloor)<br>\end{aligned}<br>$$<br>运用两次整除分块即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">20101009</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, Inv2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span> <span class="comment">// 略</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> p)</span> <span class="comment">// 略</span></span></span><br><span class="line">int num[MAXN], prime[MAXN], p_num;</span><br><span class="line"><span class="keyword">int</span> mu[MAXN], Smu[MAXN]; <span class="comment">// 莫比乌斯函数及d^2mu(d)的前缀和</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Getmu</span><span class="params">()</span> <span class="comment">// 线性筛mu和Smu，略</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Sum</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;<span class="keyword">return</span> <span class="number">1L</span>L * (<span class="number">1</span>+x) * x % mod * Inv2 % mod;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>, up = min(x, y);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">1</span>, r; l &lt;= up; l = r+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = min(x/(x/l), y/(y/l));</span><br><span class="line">        ans = (ans + <span class="number">1L</span>L * (Smu[r] - Smu[l<span class="number">-1</span>] + mod) * </span><br><span class="line">               Sum(x/l) % mod * Sum(y/l) % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Inv2 = ni(<span class="number">2</span>, mod);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m); <span class="keyword">if</span>(n &gt; m) swap(n, m);</span><br><span class="line">    Getmu(); <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">1</span>, r; l &lt;= n; l = r+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = min(n/(n/l), m/(m/l));</span><br><span class="line">        ans = (ans + <span class="number">1L</span>L * (Sum(r) - Sum(l<span class="number">-1</span>) + mod) * calc(n/l, m/l) % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.luogu.com.cn/problem/P2257" target="_blank" rel="noopener">洛谷P2257 YY的GCD</a></p>
<p>$$<br>\begin{aligned}<br>&amp;\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)\in prime]\cr<br>&amp;=\sum_{p}\sum_{i=1}^{n}\sum_{j=1}^{m}[gcd(i,j)=p]\cr<br>&amp;=\sum_{p}\sum_{d}mu(d)\cdot \left\lfloor\frac{n}{pd}\right\rfloor\cdot \left\lfloor\frac{m}{pd}\right\rfloor\cr<br>&amp;枚举pd，设pd=t：\cr<br>&amp;=\sum_{t}\left\lfloor\frac{n}{t}\right\rfloor\cdot \left\lfloor\frac{m}{t}\right\rfloor\sum_{p|t,p\in prime}\mu\left(\frac{t}{p}\right)<br>\end{aligned}<br>$$<br>其中第一个求和可以整除分块，第二个求和可以预处理：对于每一个质数$p$，枚举其倍数$kp$，$sum(kp)+=\mu(k)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e7</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> T, n, m;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mu[MAXN], prime[MAXN], num[MAXN], tot;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> f[MAXN], sum[MAXN]; <span class="comment">// f为第二个和式的预处理，sum为f的前缀和</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 省略筛mu的过程</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i * prime[j] &lt; MAXN; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            f[i*prime[j]] += mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN;i++) sum[i] = sum[i<span class="number">-1</span>] + f[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    T = read();</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        n = read(); m = read();</span><br><span class="line">        <span class="keyword">int</span> up=min(n,m); <span class="keyword">long</span> <span class="keyword">long</span> ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, j; i &lt;= up; i = j + <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            j = min(n/(n/i), m/(m/i));</span><br><span class="line">            ans += (sum[j]-sum[i<span class="number">-1</span>]) * (n/i) * (m/i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-8-杜教筛"><a href="#1-4-8-杜教筛" class="headerlink" title="1.4.8. 杜教筛"></a>1.4.8. 杜教筛</h3><h4 id="1-4-8-1-核心柿子"><a href="#1-4-8-1-核心柿子" class="headerlink" title="1.4.8.1. 核心柿子"></a>1.4.8.1. 核心柿子</h4><p>我们要求积性函数$f$的前缀和。设：<br>$S(n)=\sum_{i=1}^{n}f(i)$</p>
<p>我们找到另一个积性函数$g$，则有：<br>$$<br>g(1)S(n)=\sum_{i=1}^{n}(f * g)(i)-\sum_{i=2}^{n}g(i)\cdot S\left(\left\lfloor\frac{n}{i}\right\rfloor\right)<br>$$<br>如果能快速求出$f * g$和$g$的前缀和，就可以数论分块求解$f$的前缀和。</p>
<h4 id="1-4-8-2-一些好用的狄利克雷卷积结果"><a href="#1-4-8-2-一些好用的狄利克雷卷积结果" class="headerlink" title="1.4.8.2. 一些好用的狄利克雷卷积结果"></a>1.4.8.2. 一些好用的狄利克雷卷积结果</h4><p>$$<br>\begin{aligned}<br>\mu * I &amp;= \varepsilon\\<br>\varphi * I &amp;= if\\<br>d &amp;= I * I\\<br>\left(\varphi(i)\cdot i\right) * i &amp;=\sum_{d|n}(\varphi(d)\cdot d)\cdot\frac{n}{d}=i^2\\<br>\left(\varphi(i)\cdot i^2\right) * i^2 &amp;=\sum_{d|n}(\varphi(d)\cdot d^2)\cdot\frac{n}{d^2}=i^3\\<br>\left(\mu(i)\cdot i\right) * i &amp;=\sum_{d|n}(\mu(d)\cdot d)\cdot\frac{n}{d}=i\\<br>\left(\mu * id^2\right) * I &amp;=\left(\mu * I\right) * id^2=\varepsilon * id^2=id^2<br>\end{aligned}<br>$$</p>
<h4 id="1-4-8-3-筛-mu-和-varphi"><a href="#1-4-8-3-筛-mu-和-varphi" class="headerlink" title="1.4.8.3. 筛 $\mu$ 和 $\varphi$"></a>1.4.8.3. 筛 $\mu$ 和 $\varphi$</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e6</span> + <span class="number">50</span>;</span><br><span class="line"><span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; Summu;</span><br><span class="line"><span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, ll&gt; Sumphi;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> maxup;</span><br><span class="line"></span><br><span class="line">ll phi[MAXN], Sphi[MAXN];</span><br><span class="line"><span class="keyword">int</span> mu[MAXN], Smu[MAXN];</span><br><span class="line"><span class="keyword">int</span> num[MAXN], prime[MAXN], p_num;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    maxup = (<span class="keyword">int</span>)<span class="built_in">pow</span>(n, <span class="number">2.0</span>/<span class="number">3.0</span>);</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>; phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxup; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!num[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[++p_num] = i;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= p_num &amp;&amp; i * prime[j] &lt; maxup; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            num[i*prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j])</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i*prime[j]] = -mu[i];</span><br><span class="line">                phi[i*prime[j]] = phi[i]*phi[prime[j]];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                phi[i*prime[j]] = phi[i]*prime[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//求前缀和</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; maxup; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        Smu[i] = Smu[i<span class="number">-1</span>] + mu[i];</span><br><span class="line">        Sphi[i] = Sphi[i<span class="number">-1</span>] + phi[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Get_Sum_mu</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x &lt; maxup) <span class="keyword">return</span> Smu[x];</span><br><span class="line">    <span class="keyword">if</span>(Summu[x]) <span class="keyword">return</span> Summu[x];</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>; <span class="comment">//卷积得到的\varepsilon前缀和为1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">2</span>, r; l &lt;= x; l = r+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = x/(x/l);</span><br><span class="line">        ret -= (r-l+<span class="number">1</span>) * Get_Sum_mu(x/l);</span><br><span class="line">        <span class="comment">// 在l到r区间内I函数的和为r-l+1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Summu[x] = ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Get_Sum_phi</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x &lt; maxup) <span class="keyword">return</span> Sphi[x];</span><br><span class="line">    <span class="keyword">if</span>(Sumphi[x]) <span class="keyword">return</span> Sumphi[x];</span><br><span class="line">    ll ret = <span class="number">1L</span>L*x*(x+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>; <span class="comment">// 卷积得到的id的前缀和</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">2</span>, r; l &lt;= x; l = r+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = x/(x/l);</span><br><span class="line">        ret -= <span class="number">1L</span>L * (r-l+<span class="number">1</span>) * Get_Sum_phi(x/l) ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Sumphi[x] = ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init(INT_MAX);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T)</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %d\n"</span>, Get_Sum_phi(n), Get_Sum_mu(n));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-4-8-4-栗子"><a href="#1-4-8-4-栗子" class="headerlink" title="1.4.8.4. 栗子"></a>1.4.8.4. 栗子</h4><p><a href="https://www.luogu.com.cn/problem/P3768" target="_blank" rel="noopener">洛谷P3768 简单的数学题</a><br>$$<br>\left(\sum_{i=1}^n\sum_{j=1}^n ij \gcd(i,j)\right) \bmod p<br>$$</p>
<p>$$<br>\begin{aligned}<br>原式&amp;=\sum_dd\sum_{i=1}^n\sum_{j=1}^n ij [\gcd(i,j)=d]\cr<br>&amp;=\sum_dd^3\sum_{i=1}^{\left\lfloor\frac{n}{d}\right\rfloor}\sum_{j=1}^{\left\lfloor\frac{n}{d}\right\rfloor} ij [\gcd(i,j)=d]\cr<br>设g(n)&amp;=1^3+2^3+\cdots+n^3=\frac{n^2(n+1)^2}{4}\cr<br>设f(n)&amp;=\sum_{i=1}^n\sum_{j=1}^n ij [\gcd(i,j)=1]\cr<br>&amp;=\sum_{i=1}^n\sum_{j=1}^n ij \sum_{d|\gcd(i,j)}\mu(d)\cr<br>&amp;=\sum_{d=1}^{n}d^2\mu(d)\cdot g\left(\left\lfloor\frac{n}{d}\right\rfloor\right)\cr<br>\end{aligned}<br>$$</p>
<p>$$<br>\begin{aligned}<br>\therefore 原式&amp;=\sum_{d=1}^{n}d^3\cdot f\left(\left\lfloor\frac{n}{d}\right\rfloor\right)\cr<br>&amp;=\sum_{d=1}^{n}d^3\sum_{x=1}^{\left\lfloor\frac{n}{d}\right\rfloor}x^2\mu(x)\cdot g\left(\left\lfloor\frac{n}{xd}\right\rfloor\right)\cr<br>观察&amp;到前两个和式顶部之积为n，因此枚举\ T=xd:\cr<br>&amp;=\sum_{T=1}^{n}g\left(\left\lfloor\frac{n}{T}\right\rfloor\right)T^2\sum_{x|T}^{T}\mu(x)\cdot \frac{T}{x}\cr<br>&amp;=\sum_{T=1}^{n}g\left(\left\lfloor\frac{n}{T}\right\rfloor\right)\cdot T^2\varphi(T)\cr<br>T^2\varphi(T)&amp;\ 可用杜教筛求前缀和，然后对整个柿子整除分块<br>\end{aligned}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">5e6</span>;</span><br><span class="line"><span class="keyword">int</span> p; ll n;</span><br><span class="line"><span class="keyword">int</span> inv6;</span><br><span class="line"><span class="keyword">int</span> num[MAXN], prime[MAXN], tot;</span><br><span class="line"><span class="keyword">int</span> phi[MAXN], Sf[MAXN];</span><br><span class="line"><span class="built_in">unordered_map</span>&lt;ll, <span class="keyword">int</span>&gt; Sumf;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1L</span>L*a*a%c) <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ret = <span class="number">1L</span>L * ret * a % c;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ksm(a, p<span class="number">-2</span>, p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>; inv6 = ni(<span class="number">6</span>, p);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) <span class="comment">// 省略线性筛素数和phi至MAXN的模版</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++) phi[i] = <span class="number">1L</span>L * i * i % p * phi[i] % p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++) Sf[i] = (Sf[i<span class="number">-1</span>] + phi[i]) % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Scube</span><span class="params">(ll x)</span> <span class="comment">// 三次方前缀和</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x %= p;</span><br><span class="line">    <span class="keyword">int</span> tmp = <span class="number">1L</span>L * x * (x+<span class="number">1</span>) / <span class="number">2</span> % p;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * tmp * tmp % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Ssquare</span><span class="params">(ll x)</span> <span class="comment">// 二次方前缀和</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    x %= p;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * x * (x+<span class="number">1</span>) % p * (<span class="number">2</span>*x+<span class="number">1</span>) % p * inv6 % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">S</span><span class="params">(ll x)</span> <span class="comment">// 杜教筛i^2*phi(i)前缀和</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x &lt; MAXN) <span class="keyword">return</span> Sf[x];</span><br><span class="line">    <span class="keyword">if</span>(Sumf.count(x)) <span class="keyword">return</span> Sumf[x];</span><br><span class="line">    <span class="keyword">int</span> ret = Scube(x);</span><br><span class="line">    <span class="keyword">for</span>(ll l = <span class="number">2</span>, r; l &lt;= x; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = x / (x / l);</span><br><span class="line">        <span class="keyword">int</span> tmp = <span class="number">1L</span>L * S(x/l) * (Ssquare(r) - Ssquare(l<span class="number">-1</span>) + p) % p;</span><br><span class="line">        ret = (ret - tmp + p) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Sumf[x] = ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        <span class="keyword">int</span> tmp = (S(r) - S(l<span class="number">-1</span>) + p) % p;</span><br><span class="line">        ret = (ret + <span class="number">1L</span>L * tmp * Scube(n/l) % p) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%lld"</span>, &amp;p, &amp;n); init();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, work());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://nanti.jisuanke.com/t/41302" target="_blank" rel="noopener">2019南京网络赛 E. K SUM</a></p>
<ul>
<li><strong>题目大意：</strong></li>
</ul>
<p>$$<br>f_n(k)=\sum_{l_1=1}^n \sum_{l_2=1}^n … \sum_{l_k=1}^n \left(\gcd\left(l_1,l_2,…,l_k\right)\right)^2\cr<br>1 \le n \le 10^9,2 \le k \le {10}^{10^5}，计算\sum_{i=2}^k {f_n(i)}<br>$$</p>
<ul>
<li><strong>分析：</strong></li>
</ul>
<p>$$<br>\begin{aligned}<br>f_n(k)&amp;=\sum_{l_1=1}^n \sum_{l_2=1}^n … \sum_{l_k=1}^n \left(\gcd\left(l_1,l_2,…,l_k\right)\right)^2\cr<br>&amp;=\sum_d\sum_{l_1=1}^{\left\lfloor\frac{n}{d}\right\rfloor} \sum_{l_2=1}^{\left\lfloor\frac{n}{d}\right\rfloor} … \sum_{l_k=1}^{\left\lfloor\frac{n}{d}\right\rfloor} \left[\gcd\left(l_1,l_2,…,l_k\right)=1\right]\cdot d^2\cr<br>&amp;=\sum_d\sum_{l_1=1}^{\left\lfloor\frac{n}{d}\right\rfloor} \sum_{l_2=1}^{\left\lfloor\frac{n}{d}\right\rfloor} … \sum_{l_k=1}^{\left\lfloor\frac{n}{d}\right\rfloor}\ \ \sum_{t|\gcd(l_1,l_2,\cdots,l_k)}\mu(t)\cr<br>&amp;=\sum_dd^2\sum_{t=1}^{\left\lfloor\frac{n}{d}\right\rfloor}\mu(t)\cdot \left\lfloor\frac{n}{td}\right\rfloor^k\cr\cr<br>&amp;设T=td：\cr<br>&amp;=\sum_{T=1}^n\left\lfloor\frac{n}{T}\right\rfloor^k\sum_{t|T}\mu(t)\left(\frac{T}{t}\right)^2\cr\cr<br>\therefore ans&amp;=\sum_{i=2}^{k}\sum_{T=1}^i\left\lfloor\frac{n}{T}\right\rfloor^k\sum_{t|T}\mu(t)\left(\frac{T}{t}\right)^2\cr<br>&amp;=\sum_{T=1}^{n}\left(\sum_{i=2}^k\left\lfloor\frac{n}{T}\right\rfloor^i\right)\left(\sum_{t|T}\mu(t)\left(\frac{T}{t}\right)^2\right)\cr<br>\end{aligned}<br>$$</p>
<p>$$<br>设g(T)=\sum_{t|T}\mu(t)\left(\frac{T}{t}\right)^2=\mu(T)*id^2(T)<br>$$</p>
<p>$$<br>则有：g(T)<em>I(T)=\mu(T)</em>I(T)<em>id^2(T)=\varepsilon(T)</em>id^2(T)=id^2(T)<br>$$</p>
<p>因此 $g(T)$ 可杜教筛。线性筛部分，$T$ 为质数时，易知 $g(T)=T^2-1$ 。<br>$$<br>T=p^c，g(T)=T^2+\mu(p)\cdot\frac{T^2}{p^2}=p^2\left(p^{2c}-p^{2c-2}\right)\cr<br>T=p^{c+1}，g(T)=T^2+\mu(p)\cdot\frac{T^2}{p^2}=p^2\left(p^{2c+2}-p^{2c}\right)<br>$$</p>
<p>$$<br>T=p_1^{k_1}p_2^{k_2}\cdots p_n^{k_n}，\cr<br>g(T\cdot p_1)=g\left(p_1^{k_1+1}\cdot\frac{T}{p_1^{k_1}}\right)=g\left(p_1^{k_1+1}\right)\cdot g\left(\frac{T}{p_1^{k_1}}\right)\ \ \ (两部分互质)\cr<br>g(T)=g\left(p_1^{k_1}\cdot\frac{T}{p_1^{k_1}}\right)=g\left(p_1^{k_1}\right)\cdot g\left(\frac{T}{p_1^{k_1}}\right)\<br>\therefore g(T\cdot p_1)=g(T)\cdot p^2<br>$$<br>前半部分为等比数列求和，可整除分块。要特别注意，特判 $\left\lfloor\frac{n}{T}\right\rfloor=1$ 的情况，这时候的 $k$ 对 $MOD$ 取模；其他情况，$k$ 位于指数上，要对 $\varphi(MOD)$ 取模。因此要在读入时取得两个不同的 $k$ 值。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e6</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> PHI = <span class="number">1e9</span> + <span class="number">6</span>;</span><br><span class="line"><span class="keyword">int</span> inv6;</span><br><span class="line"><span class="keyword">int</span> T, n, k_phi, k_mod;</span><br><span class="line"></span><br><span class="line"><span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; Sumg;</span><br><span class="line"><span class="keyword">int</span> p[MAXN], num[MAXN], tot;</span><br><span class="line"><span class="keyword">int</span> sumg[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getmod</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> b = <span class="number">0</span>, b2 = <span class="number">0</span>; <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c=getchar()));</span><br><span class="line">    <span class="keyword">for</span>(;<span class="built_in">isdigit</span>(c);c=getchar())</span><br><span class="line">    &#123;</span><br><span class="line">        b = b * <span class="number">10</span> + c - <span class="string">'0'</span>; b2 = b2 * <span class="number">10</span> + c - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span>(b &gt;= PHI) b %= PHI; <span class="keyword">if</span>(b2 &gt;= MOD) b2 %= MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    k_phi = <span class="keyword">int</span>(b); k_mod = <span class="keyword">int</span>(b2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1L</span>L*a*a%c) <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ret = <span class="number">1L</span>L * ret * a % MOD;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ksm(a, MOD - <span class="number">2</span>, MOD);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    a += b; <span class="keyword">if</span>(a &gt; MOD) a -= MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    a -= b; <span class="keyword">if</span>(a &lt; <span class="number">0</span>) a += MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    sumg[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!num[i])</span><br><span class="line">        &#123;</span><br><span class="line">            p[++tot] = i;</span><br><span class="line">            sumg[i] = (<span class="number">1L</span>L * i * i - <span class="number">1</span>) % MOD;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * p[j] &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            num[i*p[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % p[j]) sumg[i*p[j]] = <span class="number">1L</span>L * sumg[i] * sumg[p[j]] % MOD;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                sumg[i*p[j]] = <span class="number">1L</span>L * sumg[i] * p[j] % MOD * p[j] % MOD;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++) add(sumg[i], sumg[i - <span class="number">1</span>]);</span><br><span class="line">    inv6 = ni(<span class="number">6</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Ssqr</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * n * (n + <span class="number">1</span>) % MOD * (<span class="number">2</span> * n + <span class="number">1</span>) % MOD * inv6 % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Getsumg</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt; MAXN) <span class="keyword">return</span> sumg[n];</span><br><span class="line">    <span class="keyword">if</span>(Sumg.find(n) != Sumg.end()) <span class="keyword">return</span> Sumg[n];</span><br><span class="line">    <span class="keyword">int</span> ret = Ssqr(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        del(ret, <span class="number">1L</span>L * (r - l + <span class="number">1</span>) * Getsumg(n / l) % MOD);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Sumg[n] = ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum_k</span><span class="params">(<span class="keyword">int</span> n)</span> <span class="comment">// 等比数列求和</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">1</span>) <span class="keyword">return</span> k_mod - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> ret = ksm(n, k_phi+<span class="number">1</span>, MOD);</span><br><span class="line">    del(ret, <span class="number">1L</span>L * n * n % MOD);</span><br><span class="line">    ret = <span class="number">1L</span>L * ret * ni(n - <span class="number">1</span>) % MOD;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        add(ans, <span class="number">1L</span>L*sum_k(n/l)*(Getsumg(r)-Getsumg(l<span class="number">-1</span>)+MOD) % MOD);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n); getmod();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, work());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="1-4-9-min25筛"><a href="#1-4-9-min25筛" class="headerlink" title="1.4.9. min25筛"></a>1.4.9. min25筛</h3><p>min_25筛处理积性函数$f(x)$前缀和，要求$f(p)$是一个低阶多项式（如：$f(p)=p^2+p$），且$f(p^c)$可快速求值。</p>
<p>以下介绍均以洛谷模版题为例：<a href="https://www.luogu.com.cn/problem/P5325" target="_blank" rel="noopener">洛谷P5325</a> ：$f(p^k)=p^k(p^k-1)$</p>
<h4 id="1-4-9-1-第一部分-求质数点的前缀和"><a href="#1-4-9-1-第一部分-求质数点的前缀和" class="headerlink" title="1.4.9.1. 第一部分-求质数点的前缀和"></a>1.4.9.1. 第一部分-求质数点的前缀和</h4><p>设 $min(p)$ 为$i$的最小质因子，$p_j$为从小到大的第$j$个质数，设：</p>
<p>$$<br>g(n,j)=\sum_{i=1}^{n}[i\in prime\  ||\  min(p)&gt;p_j]f(i)<br>$$<br>设 $F(j)$ 为质数处点值等于 $f(j)$ 的完全积性函数，则有转移方程：</p>
<p>$$<br>g(n,j)=<br>\begin{cases}<br>g(n,j-1)&amp; {p_j^2&gt;n}\cr<br>g(n,j-1)-F(j)\left(g(\frac{n}{p_j},j-1)-g(p_j-1,j-1)\right) &amp; {p_j^2\leq n}<br>\end{cases}<br>$$<br>因此$g(n,0)$即为除去 $1$ 后所有点值视为质数的前缀和，也即转移的开始；$g(n,tot)$ （$tot$为转移的轮次，也即$n$以内质数数目）即为所求质数点值之和。采用滚动数组省略第一维。</p>
<p>例题：<a href="https://loj.ac/problem/6235" target="_blank" rel="noopener">loj6235 区间素数个数</a></p>
<p>求$1-n$之间素数个数，$2\leq n\leq 10^{11}$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e6</span> + <span class="number">50</span>;</span><br><span class="line">ll n;</span><br><span class="line">ll val[MAXN], id1[MAXN], id2[MAXN], g[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> num[MAXN], prime[MAXN], tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> <span class="comment">// 省略线性筛素数模版</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m = <span class="number">0</span>, lim = <span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(ll l = <span class="number">1</span>, r; l &lt;= n; l = r+<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        val[++m] = n / l;</span><br><span class="line">        <span class="keyword">if</span>(val[m] &lt;= lim) id1[val[m]] = m;</span><br><span class="line">        <span class="keyword">else</span> id2[n / val[m]] = m;</span><br><span class="line">        g[m] = val[m] - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m &amp;&amp; <span class="number">1L</span>L * prime[j] * prime[j] &lt;= val[i]; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ll tmp = val[i] / prime[j];</span><br><span class="line">            <span class="keyword">if</span> (tmp &lt;= lim) g[i] -= g[id1[tmp]] - (j - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">else</span> g[i] -= g[id2[n / tmp]] - (j - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> g[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n); init();</span><br><span class="line">    ll ans = solve(n); <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>更好地理解$g$函数的意义，有下面这道题：<a href="https://www.luogu.com.cn/problem/P6021" target="_blank" rel="noopener">P6021 质数前缀统计</a></p>
<p>设 $S(n)$ 为 $n$ 以内质数的 $k$ 次方和。求：<br>$$<br>\sum_{i=1}^{\lfloor\sqrt n\rfloor}i^2S\left(\left\lfloor\frac{n}{i}\right\rfloor\right)<br>$$<br>在用拉格朗日插值法完成 $pre()$ 函数后：</p>
<p>（这里有个卡常技巧，预处理出所有质数的k次方值！省略掉快速幂的一个log）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll l = <span class="number">1</span>, r; l &lt;= lim; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        ll sz = sum(min(lim, r)) - sum(l<span class="number">-1</span>) + mod; <span class="comment">// sum是i^2前缀和</span></span><br><span class="line">        ret += <span class="number">1L</span>L * sz * g[l] % mod; <span class="comment">// g[l]就是n/l以内质数点值的前缀和</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-4-9-2-第二部分-求积性函数前缀和"><a href="#1-4-9-2-第二部分-求积性函数前缀和" class="headerlink" title="1.4.9.2. 第二部分-求积性函数前缀和"></a>1.4.9.2. 第二部分-求积性函数前缀和</h4><p>设$sp[x]$表示小于等于第$x$个质数处点值的前缀和。设$S(n,x)$表示求$1$到$n$中所有最小质因子大于$p_x$的函数值之和。答案就是$S(n,0)$。考虑转移，将满足条件的数分成两部分，第一部分是大于$p_x$的质数，也就是$g(n)-sp[x]$，另一部分是最小质因子大于$p_x$的合数，我们可以枚举最小质因子。转移方程：</p>
<p>$$<br>S(n,x)=g(n)−sp_x+\sum_{p_k^e\leq n\ and\ k&gt;x}f(p_k^e)\left(S\left(\frac{n}{p_k^e},k\right)+[e\not = 1]\right)<br>$$<br>最后不要忘记加上$1$处的点值。</p>
<h4 id="1-4-9-3-栗子"><a href="#1-4-9-3-栗子" class="headerlink" title="1.4.9.3. 栗子"></a>1.4.9.3. 栗子</h4><h5 id="1-4-9-3-1-洛谷模版-普通的多项式"><a href="#1-4-9-3-1-洛谷模版-普通的多项式" class="headerlink" title="1.4.9.3.1. 洛谷模版-普通的多项式"></a>1.4.9.3.1. 洛谷模版-普通的多项式</h5><p><a href="https://www.luogu.com.cn/problem/P5325" target="_blank" rel="noopener">洛谷P5325</a> $f(p^k)=p^k(p^k-1)$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inv6 = <span class="number">166666668</span>;</span><br><span class="line">ll n;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> prime[MAXN], num[MAXN], tot;</span><br><span class="line"><span class="keyword">int</span> sp1[MAXN &lt;&lt; <span class="number">1</span>], sp2[MAXN &lt;&lt; <span class="number">1</span>]; <span class="comment">// 注意sp和g开两倍空间</span></span><br><span class="line"><span class="comment">// sp1为质数处i的前缀和，sp2为质数处i^2的前缀和</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!num[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[++tot] = i;</span><br><span class="line">            sp1[tot] = (sp1[tot<span class="number">-1</span>] + i) % mod;</span><br><span class="line">            sp2[tot] = (sp2[tot<span class="number">-1</span>] + <span class="number">1L</span>L * i * i % mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; prime[j] * i &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            num[i*prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll val[MAXN &lt;&lt; <span class="number">1</span>], id1[MAXN &lt;&lt; <span class="number">1</span>], id2[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line">ll g1[MAXN &lt;&lt; <span class="number">1</span>], g2[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="comment">// val为各个点值，id1,id2记录位置，g1为i的转移滚动数组，g2为i^2的转移滚动数组</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lim = <span class="built_in">sqrt</span>(n), m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        val[++m] = n / l;</span><br><span class="line">        <span class="keyword">if</span>(val[m] &lt;= lim) id1[val[m]] = m;</span><br><span class="line">        <span class="keyword">else</span> id2[n/val[m]] = m;</span><br><span class="line">        g1[m] = g2[m] = val[m] % mod;</span><br><span class="line">        g1[m] = <span class="number">1L</span>L * g1[m] * (g1[m]+<span class="number">1</span>) / <span class="number">2</span> % mod - <span class="number">1</span>; </span><br><span class="line">        <span class="comment">// i的前缀和，别忘记刨除1</span></span><br><span class="line">        g2[m] = g2[m]*(g2[m]+<span class="number">1</span>)%mod*(<span class="number">2</span>*g2[m]+<span class="number">1</span>)%mod*inv6%mod - <span class="number">1</span>;</span><br><span class="line">        <span class="comment">// i^2的前缀和，别忘记刨除1^2=1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; <span class="number">1L</span>L * prime[j] * prime[j] &lt;= val[i]; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ll tmp = val[i] / prime[j];</span><br><span class="line">            <span class="keyword">if</span>(tmp &lt;= lim) tmp = id1[tmp];</span><br><span class="line">            <span class="keyword">else</span> tmp = id2[n/tmp];</span><br><span class="line">            g1[i] -= <span class="number">1L</span>L * prime[j] * (g1[tmp] - sp1[j<span class="number">-1</span>] + mod) % mod;</span><br><span class="line">            g2[i] -= <span class="number">1L</span>L * prime[j] * prime[j] % mod * </span><br><span class="line">                (g2[tmp] - sp2[j<span class="number">-1</span>] + mod) % mod;</span><br><span class="line">            <span class="keyword">if</span>(g1[i] &lt; <span class="number">0</span>) g1[i] += mod;</span><br><span class="line">            <span class="keyword">if</span>(g2[i] &lt; <span class="number">0</span>) g2[i] += mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">S</span><span class="params">(ll x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(prime[y] &gt; x || x == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> lim = <span class="built_in">sqrt</span>(n);</span><br><span class="line">    ll tmp = (x &lt;= lim ? id1[x] : id2[n/x]);</span><br><span class="line">    ll ret = (g2[tmp] - g1[tmp] + mod - (sp2[y] - sp1[y]) + mod) % mod; </span><br><span class="line">    <span class="comment">// 初始值：g-sp</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = y + <span class="number">1</span>; i &lt;= tot &amp;&amp; <span class="number">1L</span>L * prime[i] * prime[i] &lt;= x; i++)</span><br><span class="line">    &#123; <span class="comment">// 按公式暴力枚举</span></span><br><span class="line">        ll pe = prime[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> e = <span class="number">1</span>; pe &lt;= x; e++, pe *= prime[i])</span><br><span class="line">        &#123;</span><br><span class="line">            ll xx = pe % mod;</span><br><span class="line">            ret = (ret + xx * (xx<span class="number">-1</span>) % mod * (S(x/pe, i) + (e!=<span class="number">1</span>))) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pre(n);</span><br><span class="line">    <span class="keyword">return</span> (S(n, <span class="number">0</span>) + <span class="number">1</span>) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, solve(n));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-4-9-3-2-筛-mu-和-varphi"><a href="#1-4-9-3-2-筛-mu-和-varphi" class="headerlink" title="1.4.9.3.2. 筛 $\mu$ 和 $\varphi$"></a>1.4.9.3.2. 筛 $\mu$ 和 $\varphi$</h5><p><a href="https://www.luogu.com.cn/problem/P4213" target="_blank" rel="noopener">洛谷P4213 杜教筛</a></p>
<p>注意到$\varphi(p)=p-1$，且$\varphi(p^c)=(p-1)p^{c-1}$均可快速求，可用$min_25$筛；</p>
<p>注意到$\mu(p)=-1$，且$\mu(p^c)=-1\cdot [c=1]$均可快速求，可用$min_25$筛。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">50</span>;</span><br><span class="line">ll n, lim;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> num[MAXN], prime[MAXN], tot;</span><br><span class="line">ll sp[MAXN]; <span class="comment">// sp为i的前缀和</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!num[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[++tot] = i;</span><br><span class="line">            sp[tot] = sp[tot<span class="number">-1</span>] + i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * prime[j] &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            num[i*prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll id1[MAXN], id2[MAXN], val[MAXN], g1[MAXN], g2[MAXN];</span><br><span class="line"><span class="comment">// g1对应i，g2对应1</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    lim = <span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        val[++m] = n / l;</span><br><span class="line">        <span class="keyword">if</span>(val[m] &lt;= lim) id1[val[m]] = m;</span><br><span class="line">        <span class="keyword">else</span> id2[n/val[m]] = m;</span><br><span class="line">        g1[m] = val[m] * (val[m]+<span class="number">1</span>) / <span class="number">2</span> - <span class="number">1</span>;</span><br><span class="line">        g2[m] = val[m] - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; <span class="number">1L</span>L * prime[j] * prime[j] &lt;= val[i]; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ll tmp = val[i] / prime[j];</span><br><span class="line">            <span class="keyword">if</span>(tmp &lt;= lim) tmp = id1[tmp];</span><br><span class="line">            <span class="keyword">else</span> tmp = id2[n/tmp];</span><br><span class="line">            g1[i] -= <span class="number">1L</span>L * prime[j] * (g1[tmp] - sp[j<span class="number">-1</span>]);</span><br><span class="line">            g2[i] -= g2[tmp] - (j<span class="number">-1</span>); <span class="comment">// 1对应的sp2[j-1]就是j-1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">Sphi</span><span class="params">(ll x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(prime[y] &gt; x || x == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll tmp = (x &lt;= lim ? id1[x] : id2[n/x]);</span><br><span class="line">    ll ret = g1[tmp] - g2[tmp] - (sp[y] - y); <span class="comment">// sp2[y]=y</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = y + <span class="number">1</span>; i &lt;= tot &amp;&amp; <span class="number">1L</span>L * prime[i] * prime[i] &lt;= x; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll p = <span class="number">1</span>, pe = prime[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> e = <span class="number">1</span>; pe &lt;= x; e++, p = pe, pe *= prime[i])</span><br><span class="line">        &#123;</span><br><span class="line">            ret += (prime[i] - <span class="number">1</span>) * p * (Sphi(x/pe, i) + (e!=<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">Smu</span><span class="params">(ll x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(prime[y] &gt; x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll tmp = (x &lt;= lim ? id1[x] : id2[n/x]);</span><br><span class="line">    ll ret = -g2[tmp] + y; <span class="comment">// sp2[y]=y</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = y + <span class="number">1</span>; i &lt;= tot &amp;&amp; <span class="number">1L</span>L * prime[i] * prime[i] &lt;= x; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ret -= Smu(x/prime[i], i); <span class="comment">// 高次的e对应mu等于0，不用计算</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pre(n);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld %lld\n"</span>, Sphi(n, <span class="number">0</span>) + <span class="number">1</span>, Smu(n, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">        solve(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-4-9-3-3-多项式含有系数的情况"><a href="#1-4-9-3-3-多项式含有系数的情况" class="headerlink" title="1.4.9.3.3. 多项式含有系数的情况"></a>1.4.9.3.3. 多项式含有系数的情况</h5><p><a href="https://www.luogu.com.cn/problem/SP20174" target="_blank" rel="noopener">SP20174 DIVCNT3</a></p>
<p>求$S_3(n) = \sum _{i=1}^n \sigma_0(i^3)$，其中$\sigma_0(x)$为$x$的约数个数</p>
<p>解：设 $f(x)=\sigma_0(x^3)$，则有 $f(p)=4$，$f(p^c)=3c+1$。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e6</span> + <span class="number">50</span>;</span><br><span class="line">ll n, lim;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> num[MAXN], prime[MAXN], tot;</span><br><span class="line"><span class="keyword">int</span> sp[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!num[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[++tot] = i;</span><br><span class="line">            sp[tot] = sp[tot<span class="number">-1</span>] + <span class="number">4</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * prime[j] &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            num[i*prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll g[MAXN &lt;&lt; <span class="number">1</span>], id1[MAXN &lt;&lt; <span class="number">1</span>], id2[MAXN &lt;&lt; <span class="number">1</span>], val[MAXN &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    lim = <span class="built_in">sqrt</span>(n); <span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = n / (n / l);</span><br><span class="line">        val[++m] = n / l;</span><br><span class="line">        <span class="keyword">if</span>(val[m] &lt;= lim) id1[val[m]] = m;</span><br><span class="line">        <span class="keyword">else</span> id2[n/val[m]] = m;</span><br><span class="line">        g[m] = <span class="number">4</span> * val[m] - <span class="number">4</span>;</span><br><span class="line">        <span class="comment">// 这里减去1的点值为4！可以考虑本来是减1，最后乘4，所以这里为减4</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; <span class="number">1L</span>L * prime[j] * prime[j] &lt;= val[i]; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ll tmp = val[i] / prime[j];</span><br><span class="line">            <span class="keyword">if</span>(tmp &lt;= lim) tmp = id1[tmp];</span><br><span class="line">            <span class="keyword">else</span> tmp = id2[n/tmp];</span><br><span class="line">            g[i] -= (g[tmp] - sp[j<span class="number">-1</span>]);</span><br><span class="line">            <span class="comment">// 特别注意！这里本来是两部分相乘，即(1 * (g-sp))，其中1为函数值</span></span><br><span class="line">            <span class="comment">// 保持答案为无系数结果再乘4，由于前面的g和预处理的sp都已经乘上系数</span></span><br><span class="line">            <span class="comment">// 所以前面的1不再乘上系数4！</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">S</span><span class="params">(ll x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x &lt; prime[y] || x == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll tmp = (x &lt;= lim ? id1[x] : id2[n/x]);</span><br><span class="line">    ll ret = g[tmp] - sp[y];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = y + <span class="number">1</span>; i &lt;= tot &amp;&amp; <span class="number">1L</span>L * prime[i] * prime[i] &lt;= x; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll pe = prime[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> e = <span class="number">1</span>; pe &lt;= x; e++, pe *= prime[i])</span><br><span class="line">        &#123;</span><br><span class="line">            ret += (<span class="number">3</span> * e + <span class="number">1</span>) * (S(x/pe, i) + (e!=<span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">solve</span><span class="params">(ll n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pre(n);</span><br><span class="line">    <span class="keyword">return</span> S(n, <span class="number">0</span>) + <span class="number">1</span>; <span class="comment">// 加上1的约数个数1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> T; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%llu\n"</span>, solve(n));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="1-4-9-3-4-存在特殊点的情况"><a href="#1-4-9-3-4-存在特殊点的情况" class="headerlink" title="1.4.9.3.4. 存在特殊点的情况"></a>1.4.9.3.4. 存在特殊点的情况</h5><p><a href="https://loj.ac/problem/6053" target="_blank" rel="noopener">loj6053 简单的函数</a></p>
<p>求$\sum_{i=1}^nf(i)$，其中$f(x)$有以下性质：</p>
<p>$$\begin{aligned}<br>&amp;1. f(1)=1\cr<br>&amp;2. f(p^c)=p\oplus c\cr<br>&amp;3. f(ab)=f(a)f(b)\ \ （a和b互质）<br>\end{aligned}$$</p>
<p>分析：在质数处，有$p\oplus 1=p-1$，但是还存在一个特殊点：$2\oplus 1=3$，使得其并非一个完全的多项式。但我们可以先暂时忽略这个特殊点，第一步的$pre()$函数和$init()$中预处理$sp$数组均按照原来的方法做。在求$S(n,x)$的过程中，我们把它分成了两部分：第一部分是所有大于$p_x$的质数，另一部分是最小质因子大于$p_x$的合数。而求合数的值是一个递归的过程，因此我们只需妥善处理好质数的情况即可。我们观察到，第一部分的值为$g[n]-sp[x]$，我们发现当$x\geq 1$时，$2$这个特殊点正好被抵消掉；当$x=0$时，$sp[x]=0$，应该等于$3$的点值被我们处理成了$1$，因此$ret+=2$即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">S</span><span class="params">(ll x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x &lt; prime[y] || x == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll tmp = (x &lt;= lim ? id1[x] : id2[n/x]);</span><br><span class="line">    ll ret = ((g1[tmp] - g2[tmp] + mod) - (sp[y] - y) + mod) % mod;</span><br><span class="line">    <span class="keyword">if</span>(y == <span class="number">0</span>) ret += <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = y + <span class="number">1</span>; i &lt;= tot &amp;&amp; <span class="number">1L</span>L * prime[i] * prime[i] &lt;= x; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll pe = prime[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> e = <span class="number">1</span>; pe &lt;= x; e++, pe *= prime[i])</span><br><span class="line">        &#123;</span><br><span class="line">            ret += (prime[i]^e) * (S(x/pe, i) + (e!=<span class="number">1</span>)) % mod;</span><br><span class="line">            <span class="comment">// 这里直接上异或！也就是说它一定是f(p^c)本身。</span></span><br><span class="line">        &#125;</span><br><span class="line">        ret %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<div style="page-break-after: always; break-after: page;"></div>

<h1 id="2-组合数学"><a href="#2-组合数学" class="headerlink" title="2. 组合数学"></a>2. 组合数学</h1><h2 id="2-1-组合数的处理"><a href="#2-1-组合数的处理" class="headerlink" title="2.1. 组合数的处理"></a>2.1. 组合数的处理</h2><h3 id="2-1-1-杨辉三角"><a href="#2-1-1-杨辉三角" class="headerlink" title="2.1.1. 杨辉三角"></a>2.1.1. 杨辉三角</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">2005</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        c[i][<span class="number">0</span>] = <span class="number">1</span>; c[i][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;i;j++) c[i][j] = (c[i<span class="number">-1</span>][j<span class="number">-1</span>] + c[i<span class="number">-1</span>][j]) % k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-线性推阶乘与阶乘逆元"><a href="#2-1-2-线性推阶乘与阶乘逆元" class="headerlink" title="2.1.2. 线性推阶乘与阶乘逆元"></a>2.1.2. 线性推阶乘与阶乘逆元</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> inv[MAXN], mul[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>; mul[<span class="number">0</span>] = mul[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) </span><br><span class="line">        inv[i] = <span class="number">1L</span>L * (mod-mod/i) * inv[mod%i] % mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) inv[i] = <span class="number">1L</span>L * inv[i] * inv[i<span class="number">-1</span>] % mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) mul[i] = <span class="number">1L</span>L * i * mul[i<span class="number">-1</span>] % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * mul[n] * inv[n-m] % mod * inv[m] % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">A</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * mul[n] * inv[n-m] % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-1-3-卢卡斯定理"><a href="#2-1-3-卢卡斯定理" class="headerlink" title="2.1.3. 卢卡斯定理"></a>2.1.3. 卢卡斯定理</h3><h4 id="2-1-3-1-Lucas"><a href="#2-1-3-1-Lucas" class="headerlink" title="2.1.3.1. Lucas"></a>2.1.3.1. Lucas</h4><p>常用于模数为较小的素数：<br>$$<br>Lucas(n,m,p)=C(n\bmod p,m\bmod p)*Lucas\left(\frac{n}{p},\frac{m}{p},p\right)<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> t;</span><br><span class="line"><span class="keyword">int</span> n, m, p;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1L</span>L*a*a%c) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ret = <span class="number">1L</span>L * ret * a % c;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ksm(a, p<span class="number">-2</span>, p);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1</span>, tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n; i &gt;= n-m+<span class="number">1</span>; i--) ans = <span class="number">1L</span>L * ans * i % p;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = m; i &gt;= <span class="number">1</span>; i--) tmp = <span class="number">1L</span>L * tmp * i % p;</span><br><span class="line">    ans = <span class="number">1L</span>L * ans * ni(tmp, p) % p;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lucas</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m,<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * Lucas(n/p, m/p, p) * C(n%p, m%p) % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;p);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Lucas(n+m, m, p));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-3-2-exLucas"><a href="#2-1-3-2-exLucas" class="headerlink" title="2.1.3.2. exLucas"></a>2.1.3.2. exLucas</h4><p>求$C_n^m \ (mod \ p)$, $1\leq m\leq n\leq 10^{18},2\leq p\leq 1000000$ ，不保证 $p$ 是质数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, m, p;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">ksm</span><span class="params">(ll a, ll b, ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = a * a % p) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ans = ans * a % p;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">fac</span><span class="params">(ll n, ll p, ll pk)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!n) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; pk; i++) <span class="keyword">if</span>(i % p) ans = ans * i % pk;</span><br><span class="line">    ans = ksm(ans, n / pk, pk);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n % pk; i++) <span class="keyword">if</span>(i % p) ans = ans * i % pk;</span><br><span class="line">    <span class="keyword">return</span> ans * fac(n / p, p, pk) % pk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)</span><br><span class="line">    &#123;</span><br><span class="line">        x = <span class="number">1</span>; y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    ll xx, yy, g = exgcd(b, a % b, xx, yy);</span><br><span class="line">    x = yy; y = xx - a / b * yy;</span><br><span class="line">    <span class="keyword">return</span> g;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll a, ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll x, y;</span><br><span class="line">    exgcd(a, p, x, y);</span><br><span class="line">    <span class="keyword">return</span> (x % p + p) % p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">C</span><span class="params">(<span class="keyword">const</span> ll n, <span class="keyword">const</span> ll m, <span class="keyword">const</span> ll p, <span class="keyword">const</span> ll pk)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll f1 = fac(n, p, pk), f2 = fac(m, p, pk), f3 = fac(n - m, p, pk);</span><br><span class="line">    ll cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(ll i = n; i; i /= p) cnt += i / p;</span><br><span class="line">    <span class="keyword">for</span>(ll i = m; i; i /= p) cnt -= i / p;</span><br><span class="line">    <span class="keyword">for</span>(ll i = n - m; i; i /= p) cnt -= i / p;</span><br><span class="line">    <span class="keyword">return</span> f1 * inv(f2, pk) % pk * inv(f3, pk) % pk * ksm(p, cnt, pk) % pk;</span><br><span class="line">&#125;</span><br><span class="line">ll a[N], c[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">CRT</span><span class="params">(ll *a, ll *c, <span class="keyword">int</span> cnt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll M = <span class="number">1</span>, ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) M *= c[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++)</span><br><span class="line">        ans = (ans + a[i] * (M / c[i]) % M * inv(M / c[i], c[i]) % M) % M;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">exlucas</span><span class="params">(ll n, ll m, ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll tmp = <span class="built_in">sqrt</span>(p);</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; p &gt; <span class="number">1</span> &amp;&amp; i &lt;= tmp; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ll tmp = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(p % i == <span class="number">0</span>) &#123;p /= i; tmp *= i;&#125;</span><br><span class="line">        <span class="keyword">if</span>(tmp &gt; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            a[cnt] = C(n, m, i, tmp);</span><br><span class="line">            c[cnt++] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p &gt; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        a[cnt] = C(n, m, p, p);</span><br><span class="line">        c[cnt++] = p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> CRT(a, c, cnt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; p;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; exlucas(n, m, p);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> work();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-卡特兰数"><a href="#2-2-卡特兰数" class="headerlink" title="2.2. 卡特兰数"></a>2.2. 卡特兰数</h2><h3 id="2-2-1-常见公式"><a href="#2-2-1-常见公式" class="headerlink" title="2.2.1. 常见公式"></a>2.2.1. 常见公式</h3><p>$$<br>\begin{aligned}<br>定义：h(n)&amp;=\sum_{i=0}^{n-1}h(i)b(n-1-i)\cr<br>生成函数：F(x)&amp;=xF^{2}(x)+1=\frac{1-\sqrt{1-4x}}{2x}\cr\cr<br>性质：h(n)&amp;=\frac{C_{2n}^{n}}{n+1}\cr<br>h(n)&amp;=C_{2n}^n-C_{2n}^{n-1}\cr<br>h(n)&amp;=h(n-1)*\frac{4n-2}{n+1}\cr<br>\end{aligned}<br>$$</p>
<p>$$<br>1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, \cdots<br>$$</p>
<h3 id="2-2-2-经典应用"><a href="#2-2-2-经典应用" class="headerlink" title="2.2.2. 经典应用"></a>2.2.2. 经典应用</h3><ul>
<li>出栈序列问题</li>
</ul>
<p>$n$个不同的数依次进栈，求不同的出栈结果的种数？</p>
<ul>
<li>二叉树同构计数问题</li>
</ul>
<p>$n$个结点可够造多少个不同的二叉树？</p>
<ul>
<li>路径计数问题</li>
</ul>
<p>1.如左图，在$m*n$的方格地图中，从一个角到另一个角（成对角线），不跨越对角线的路径数为多少？</p>
<p>从反面考虑问题。设$M$为穿过直线$y=x$（表示会经过直线上方的点）的从$O\to P$的路径组成的集合，如中图。利用对称可以将$M$中第一次犯规时的路径对称，然后再将剩下的部分接在对称后的路径上，由于此时将一次向上移动修改为了向右移动，因此终点由变成了$P’$，此时就建立了与$O$到$P’$的路径的一个一一映射。</p>
<center><img src="/assets/1.png" width="170" height="150" ><img src="/assets/2.png" width="170" height="150" ><img src="/assets/3.png" width="170" height="150" ></center>

<p>于是所求的排列数为$C_{m+n}^{n}-C_{m+n}^{n-1}$，当$m=n$时即为卡特兰数。</p>
<p>2.从$(0,0)$到$(n,n)$的除端点外不接触直线$y=x$的非降路径数：</p>
<p>先考虑$y=x$下方的路径，都是从$(0,0)$出发，经过$(1,0)$及$(n,n-1)$到$(n,n)$，可以看做是$(1,0)$到$(n,n-1)$不接触$y=x$的非降路径数。</p>
<p>所有的的非降路径有$C_{2n-2}^{n-1}$条。对于这里面任意一条接触了$y=x$的路径，可以把它最后离开这条线的点到$(1,0)$之间的部分关于$y=x$对称变换，就得到从$(0,1)$到$(n,n-1)$的一条非降路径。反之也成立。从而$y=x$下方的非降路径数是$C_{2n-2}^{n-1}-C_{2n-2}^{n}$。根据对称性可知所求答案为$2C_{2n-2}^{n-1}-2C_{2n-2}^{n}$。</p>
<ul>
<li>圆内连弦问题</li>
</ul>
<p>如图，圆周上有$2n$个点，以这些点为端点连互不相交的$n$条弦，求不同的连法总数．</p>
<center><img src="/assets/4.png" width="150" height="150" ></center>

<p>1.辅助问题：圆周上有$2n+1$个点，其中$n+1$个点上标“+1”，$n$个点上标“$-1$”，如果可以找到某个标有“$+1$”的点作为起点，当顺时针沿圆周前进时将所遇到的点（包括起点）上标的数相加得到的和始终为正数，就称这种标记法是好标记法．求好标记法的总数（注意考虑圆排列）</p>
<p>2.辅助问题的解：对于任何一种标记法，我们将顺时针相邻的“$+1$”“$-1$”（指顺时针前进时先遇到“$+1$”后遇到“$-1$”）同时抹去，可以证明抹去的前后对标记法的好坏没有影响．不停的重复这一过程，则最后只剩一个标有“$+1$”的点，显然此时标记法为好的．因此所有的标记法都是好标记法，显然其数目为$\frac{1}{2n+1}C_{2n+1}^{n}=\frac{C_{2n+1}^{n}}{2n+1}$．</p>
<p>3.问题的解：通过对辅助问题的进一步探索可知，每一种将圆周上$2n+1$个点标记为$n+1$个”$+1$”点，和$n$个”$-1$”点的方法唯一确定一个顺时针前进的方案（即起点）．我们将这个起点删去，剩下的$2n$个点在顺时针方向上一定为“$+1$”“$-1$”“$+1$”“$-1$”，…，此时将顺时针相邻的这些“$+1$”“$-1$”点用弦连接起来，就得到互不相交的条弦．这样我们就建立了从好标记法到弦的连法的单射．</p>
<p>反过来，如果我们有了一种弦的连法，就可以从某条弦的端点出发顺时针前进，对每条弦的两个端点都是先遇到的端点标上“$+1$”，后遇到的端点标上“$-1$”，然后在最后回到出发点时添上一个标有“$+1$”的点．这样我们就建立了从弦的连法到好标记法的单射．</p>
<p>综上，所求的不同连法数为$\frac{1}{2n+1}C_{2n+1}^{n}=\frac{C_{2n+1}^{n}}{2n+1}$．</p>
<ul>
<li>凸多边形的剖分问题（卡特兰问题）</li>
</ul>
<p>求凸$n+2$边形用其$n-1$条对角线分割为互不重叠的三角形的分法总数．</p>
<center><img src="/assets/5.png" width="300" height="150" ></center>

<p>引理一：由$n$对括号形成的合法括号表达式的个数为$C_n$．</p>
<p>引理二：$n$个数连乘，不同的乘法顺序数为$C_n$．</p>
<p>用$1,2,3,\cdots ,n+2$标记凸$n+2$边形的边，从标记为$1$的边的起点（按逆时针方向）开始按未标记的对角线均为向外标记方向，如下图：</p>
<center><img src="/assets/6.png" width="300" height="150" ></center>

<p>逆时针读图，将出的箭头读为左括号，进的箭头读为右括号，就得到了剖分方式与连乘顺序的对应．图10中的两个图对应的连乘顺序表达式分别为：$1((2(34))5)6, (1(23))(45)6$。抛开$6$不计，每个连乘顺序表达式实际上就是规定了$n+1$个数连乘时，不同的乘法顺序，根据引理一，得到剖分方式的总数为$C_n$．</p>
<h2 id="2-3-斯特林数"><a href="#2-3-斯特林数" class="headerlink" title="2.3. 斯特林数"></a>2.3. 斯特林数</h2><h3 id="2-3-1-第一类斯特林数"><a href="#2-3-1-第一类斯特林数" class="headerlink" title="2.3.1. 第一类斯特林数"></a>2.3.1. 第一类斯特林数</h3><h4 id="2-3-1-1-性质与结论"><a href="#2-3-1-1-性质与结论" class="headerlink" title="2.3.1.1. 性质与结论"></a>2.3.1.1. 性质与结论</h4><p>$\left[\begin{matrix} n \cr m \end{matrix}\right]$表示$n$个不同的元素构成$m$个圆排列的数目。</p>
<p>递推式：最后一个元素成单独一个圆排列，有$\left[\begin{matrix}n-1 \cr m-1 \end{matrix}\right]$种方案；若前$n-1$个元素已经构成了$m$个圆排列，最后一个元素有$n-1$中插入方法。因此<br>$$<br>\left[\begin{matrix}n \cr m \end{matrix}\right]=\left[\begin{matrix}n-1 \cr m-1 \end{matrix}\right]+(n-1)\left[\begin{matrix}n-1 \cr m \end{matrix}\right]<br>$$<br>重要公式：<br>$$<br>x^{\overline{n}}=\sum_i\begin{bmatrix} n \cr i \end{bmatrix}x^i=x(x+1)(x+2)\cdots(x+n-1)<br>$$<br>表格(从$S(0,0)$开始)：<br>$$<br>\left[\begin{matrix}1\cr 0&amp;1\cr 0&amp;1&amp;1\cr 0&amp;2&amp;3&amp;1\cr 0&amp;6&amp;11&amp;6&amp;1\cr 0&amp;24&amp;50&amp;35&amp;10&amp;1\cr 0&amp;120&amp;274&amp;225&amp;85&amp;15&amp;1\cr 0&amp;720&amp;1764&amp;1624&amp;735&amp;175&amp;21&amp;1\end{matrix}\right]<br>$$</p>
<h4 id="2-3-1-2-倍增法求第一类斯特林数-行"><a href="#2-3-1-2-倍增法求第一类斯特林数-行" class="headerlink" title="2.3.1.2. 倍增法求第一类斯特林数-行"></a>2.3.1.2. 倍增法求第一类斯特林数-行</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 省略头文件以及NTT乘法模版</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;<span class="keyword">return</span> (a += b) &gt;= Mo ? a-Mo : a;&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> mo = Mo)</span> </span>&#123;<span class="keyword">return</span> <span class="number">1l</span>l * x * y % mo; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mul</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> b)</span> </span>&#123;a = mul(a,b);&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> rev[N], fac[N], ifac[N], inv[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> len=N<span class="number">-5</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = ifac[<span class="number">0</span>] = inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len; i++) fac[i] = mul(fac[i<span class="number">-1</span>], i);</span><br><span class="line">    ifac[len] = <span class="built_in">pow</span>(fac[len], Mo<span class="number">-2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = len<span class="number">-1</span>; i; i--) ifac[i] = mul(ifac[i+<span class="number">1</span>], i+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= len; i++) inv[i] = mul(Mo - Mo/i, inv[Mo%i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> Vec <span class="title">calc_s</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vec res;</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        res.push_back(<span class="number">0</span>);res.push_back(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n &amp; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        res = calc_s(n<span class="number">-1</span>);</span><br><span class="line">        res.resize(n+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = n; i; i--) res[i] = add(res[i<span class="number">-1</span>], mul(res[i],n<span class="number">-1</span>));</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = n &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    Vec a = calc_s(mid), b(mid+<span class="number">1</span>), c(mid+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= mid; i++) c[i] = mul(a[i], fac[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, p = <span class="number">1</span>; i &lt;= mid; i++, Mul(p, mid)) </span><br><span class="line">        b[i] = mul(p, ifac[i]);</span><br><span class="line">    reverse(b.begin(), b.begin()+mid+<span class="number">1</span>);</span><br><span class="line">    c = c * b;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= mid; i++) c[i] = mul(c[i+mid], ifac[i]);</span><br><span class="line">    c.resize(mid+<span class="number">1</span>); res = a * c;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    init();</span><br><span class="line">    Vec ans = calc_s(n);</span><br><span class="line">    print(ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-1-3-分治FFT求第一类斯特林数-行"><a href="#2-3-1-3-分治FFT求第一类斯特林数-行" class="headerlink" title="2.3.1.3. 分治FFT求第一类斯特林数-行"></a>2.3.1.3. 分治FFT求第一类斯特林数-行</h4><p>斯特林数生成函数：<br>$$<br>\sum_{i=0}^{n}\begin{bmatrix} n \cr i \end{bmatrix}x^i=x^{\overline{n}}=x(x+1)(x+2)\cdots(x+n-1)<br>$$<br>直接分治FFT求各项系数即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Vec a; <span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, Vec &amp;s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        s.push_back(l);</span><br><span class="line">        s.push_back(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    Vec s1, s2;</span><br><span class="line">    solve(l, mid, s1);</span><br><span class="line">    solve(mid+<span class="number">1</span>, r, s2);</span><br><span class="line">    s = s1 * s2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    solve(<span class="number">0</span>, n<span class="number">-1</span>, a);</span><br><span class="line">    print(a);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-1-4-栗子"><a href="#2-3-1-4-栗子" class="headerlink" title="2.3.1.4. 栗子"></a>2.3.1.4. 栗子</h4><p><a href="https://www.luogu.com.cn/problem/CF960E" target="_blank" rel="noopener">CF960E</a></p>
<p>题目大意：给你$N,A,B$，问从$1$到$N$有多少种排列方式，使得从左边能看到$A$个、右边能看到$B$个。</p>
<p>分析：设$f[i][j]$：$i$个里面有$j$个能看见。考虑转移，假设最后一个放的最小，若看得见，则放在首位共$1$种方案；否则看不见，有$n-1$种方案。因此有：$f[i][j]=f[i-1][j-1]+(n-1)f[i-1][j]$，发现即为第一类斯特林数！</p>
<p>由于最高的一定能被看见，所以吧最高的拿掉并以之为分界线，左边能看见$A-1$个，右边能看见$B-1$个。枚举左边的个数$k$：</p>
<p>$$<br>\therefore ans=\sum_{k=0}^{N-1}f[k][A-1]\times f[N-1-k][B-1]\times \begin{pmatrix} N-1 \cr k \end{pmatrix}<br>$$<br>上式可理解为，$N-1$个球中选取一些染成蓝色，剩下的染成红色；把蓝色球分成$A-1$个圆排列，红色球分成$B-1$个圆排列；又等同于，$N-1$个球分成$A+B-2$个圆排列，其中$A-1$组染成红色，$B-1$组染成蓝色。</p>
<p>$$<br>\therefore ans=\left[\begin{matrix} N-1 \cr A+B-2 \end{matrix}\right]*\left(\begin{matrix} A+B-2 \cr A-1 \end{matrix}\right)<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 省略预处理第一类斯特林数、组合数模版</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;N, &amp;A, &amp;B);</span><br><span class="line">    <span class="keyword">if</span>(!A || !B || A+B &gt; N+<span class="number">1</span>) &#123;<span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">    <span class="keyword">if</span>(N == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(A == <span class="number">1</span> &amp;&amp; B == <span class="number">1</span>)<span class="built_in">printf</span>(<span class="string">"1\n"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"0"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    solve(<span class="number">0</span>, N<span class="number">-2</span>, a); <span class="comment">// 预处理斯特林数</span></span><br><span class="line">    get_inv(); get_mul(); <span class="comment">// 预处理组合数</span></span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1L</span>L * a[A+B<span class="number">-2</span>] * C(A+B<span class="number">-2</span>, A<span class="number">-1</span>) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-2-第二类斯特林数"><a href="#2-3-2-第二类斯特林数" class="headerlink" title="2.3.2. 第二类斯特林数"></a>2.3.2. 第二类斯特林数</h3><h4 id="2-3-2-1-性质与结论"><a href="#2-3-2-1-性质与结论" class="headerlink" title="2.3.2.1. 性质与结论"></a>2.3.2.1. 性质与结论</h4><p>$\begin{Bmatrix} n \cr m \end{Bmatrix}$表示$n$个不同的元素构成$m$个集合的方案数。</p>
<p>递推式：最后一个元素成单独构成一个集合，有$\begin{Bmatrix}n-1 \cr m-1 \end{Bmatrix}$种方案；若前$n-1$个元素已经构成了$m$个集合，最后一个元素可任意被分配到这$m$个集合中。因此<br>$$<br>\begin{Bmatrix}n \cr m \end{Bmatrix}=\begin{Bmatrix}n-1 \cr m-1 \end{Bmatrix}+m\begin{Bmatrix}n-1 \cr m \end{Bmatrix}<br>$$<br>重要公式：<br>$$<br>m^n=\sum_{i=0}^{m\ or\ n}\begin{Bmatrix} n \cr i \end{Bmatrix}m^{\underline{i}}=\sum_{i=0}^{m\ or\ n}\begin{pmatrix} m \cr i \end{pmatrix}\begin{Bmatrix} n \cr i \end{Bmatrix}i!<br>$$<br>表格(从$S(0,0)$开始)：<br>$$<br>\left[\begin{matrix}1\cr 0&amp;1\cr 0&amp;1&amp;1\cr 0&amp;1&amp;3&amp;1\cr 0&amp;1&amp;7&amp;6&amp;1\cr 0&amp;1&amp;15&amp;25&amp;10&amp;1\cr 0&amp;1&amp;31&amp;90&amp;65&amp;15&amp;1\cr 0&amp;1&amp;63&amp;301&amp;350&amp;140&amp;21&amp;1\end{matrix}\right]<br>$$</p>
<h4 id="2-3-2-2-求第二类斯特林数-行"><a href="#2-3-2-2-求第二类斯特林数-行" class="headerlink" title="2.3.2.2. 求第二类斯特林数-行"></a>2.3.2.2. 求第二类斯特林数-行</h4><p>$$<br>m^n=\sum_{i=0}^{m}\left(\begin{matrix} m \cr i \end{matrix}\right)\begin{Bmatrix} n \cr i \end{Bmatrix}i!<br>$$</p>
<p>$$<br>设f(m)=m^n，g(i)=\begin{Bmatrix} n \cr i \end{Bmatrix}i!，由二项式反演：<br>$$</p>
<p>$$<br>g(m)=\sum_{i=0}^{m}\left(\begin{matrix} m \cr i \end{matrix}\right)f(i)，即\begin{Bmatrix} n \cr m \end{Bmatrix}m!=\sum_{i=0}^{m}(-1)^{m-i}\left(\begin{matrix} m \cr i \end{matrix}\right)i^n<br>$$</p>
<p>$$<br>\begin{aligned}<br>\therefore \begin{Bmatrix} n \cr m \end{Bmatrix}&amp;=\frac{1}{m!}\sum_{i=0}^{m}(-1)^{m-i}\frac{m!\cdot i^n}{(m-i)!\cdot i!}\cr<br>&amp;=\sum_{i=0}^{m}\frac{(-1)^{m-i}}{(m-i)!}\cdot\frac{i^n}{i!}\cr<br>&amp;=\sum_{i=0}^{m}\frac{(-1)^{i}}{i!}\cdot\frac{(m-i)^n}{(m-i)!}<br>\end{aligned}<br>$$</p>
<p>设$F=\frac{(-1)^{i}}{i!},\ G=\frac{i^n}{i!}$，由$F*G$可得第二类斯特林数-行</p>
<p>模版：求$\begin{Bmatrix} n \cr 0 \end{Bmatrix},\begin{Bmatrix} n \cr 1 \end{Bmatrix},\begin{Bmatrix} n \cr 2 \end{Bmatrix}\cdots \begin{Bmatrix} n \cr n \end{Bmatrix}$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 省略求阶乘逆元、快速幂、多项式乘法模版</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    init(); <span class="comment">//预处理阶乘的逆元</span></span><br><span class="line">    a.resize(n+<span class="number">1</span>); b.resize(n+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i&amp;<span class="number">1</span>) a[i] = mod - inv[i];</span><br><span class="line">        <span class="keyword">else</span> a[i] = inv[i];</span><br><span class="line">        b[i] = <span class="number">1L</span>L * ksm(i, n, mod) * inv[i] % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = a * b; ans.resize(n+<span class="number">1</span>);</span><br><span class="line">    print(ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-2-3-求第二类斯特林数-列"><a href="#2-3-2-3-求第二类斯特林数-列" class="headerlink" title="2.3.2.3. 求第二类斯特林数-列"></a>2.3.2.3. 求第二类斯特林数-列</h4><p>给定$n,k$，对于所有的整数$i\in[0,n]$，求出$\begin{Bmatrix} i \cr k \end{Bmatrix}$。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 省略多项式求逆模版</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, Vec &amp;s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r)</span><br><span class="line">    &#123;</span><br><span class="line">        s.push_back(<span class="number">1</span>);</span><br><span class="line">        s.push_back(Mo-l);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    Vec s1, s2;</span><br><span class="line">    solve(l, mid, s1); solve(mid+<span class="number">1</span>, r, s2);</span><br><span class="line">    s = s1 * s2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    solve(<span class="number">1</span>, k, a);</span><br><span class="line">    S.resize(k+<span class="number">1</span>); a.resize(n+<span class="number">1</span>);</span><br><span class="line">    S[k] = <span class="number">1</span>; S = S * ~a; S.resize(n+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k);</span><br><span class="line">    init();</span><br><span class="line">    print(S);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-3-2-4-栗子"><a href="#2-3-2-4-栗子" class="headerlink" title="2.3.2.4. 栗子"></a>2.3.2.4. 栗子</h4><p><a href="https://www.luogu.com.cn/problem/CF932E" target="_blank" rel="noopener">CF932E</a></p>
<p>题目大意：求<br>$$<br>\sum_{i=0}^{n}\begin{pmatrix}n\cr i\end{pmatrix}\cdot i^k，(其中n\leq 10^9,k\leq 5000)<br>$$</p>
<p>$$<br>\begin{aligned}&amp;ans=\sum_{i=0}^{n}\begin{pmatrix}n\cr i\end{pmatrix}\cdot i^k\cr<br>&amp;=\sum_{i=0}^{n}\begin{pmatrix}n\cr i\end{pmatrix}\cdot \sum_{j=0}^{k}\begin{pmatrix}i\cr j\end{pmatrix}\cdot\begin{Bmatrix}k\cr j\end{Bmatrix}\cdot j!\cr<br>&amp;=\sum_{i=0}^{n}\frac{n!}{(n-i)!\cdot i!}\cdot\sum_{j=0}^{k}\frac{i!}{(i-j)!\cdot j!}\cdot j!\cdot\begin{Bmatrix}k\cr j\end{Bmatrix}\cr<br>&amp;=\sum_{i=0}^{n}\frac{n!}{(n-i)!}\cdot\sum_{j=0}^{k}\frac{1}{(i-j)!}\cdot\begin{Bmatrix}k\cr j\end{Bmatrix}\cr<br>&amp;=\sum_{i=0}^{n}\sum_{j=0}^{k}\frac{n!}{(n-i)!(i-j)!}\cdot\begin{Bmatrix}k\cr j\end{Bmatrix}\cr<br>&amp;=\sum_{j=0}^{k}\begin{Bmatrix}k\cr j\end{Bmatrix}\sum_{i=0}^{n}\frac{n!\cdot (n-j)!}{(n-i)!(i-j)!}\cdot \frac{1}{(n-j)!}\cr<br>&amp;=\sum_{j=0}^{k}\begin{Bmatrix}k\cr j\end{Bmatrix}\frac{n!}{(n-j)!}\sum_{i=0}^{n}\frac{(n-j)!}{(n-i)!(i-j)!}\cr<br>&amp;=\sum_{j=0}^{k}\begin{Bmatrix}k\cr j\end{Bmatrix}\frac{n!}{(n-j)!}\sum_{i=0}^{n}\begin{pmatrix}n-j\cr n-i\end{pmatrix}\cr<br>&amp;=\sum_{j=0}^{k}\begin{Bmatrix}k\cr j\end{Bmatrix}\frac{n!}{(n-j)!}\cdot 2^{n-j}\end{aligned}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXK = <span class="number">5e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="keyword">int</span> S[MAXK][MAXK];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    S[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXK; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            S[i][j] = (S[i<span class="number">-1</span>][j<span class="number">-1</span>] + <span class="number">1L</span>L * S[i<span class="number">-1</span>][j] * j % mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1L</span>L*a*a%c) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ans = <span class="number">1L</span>L * ans * a % c;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">int</span> beg = ksm(<span class="number">2</span>, n, mod), now = beg, ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> inv2 = ksm(<span class="number">2</span>, mod<span class="number">-2</span>, mod);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>, tmp = <span class="number">1</span>; j &lt;= k; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        (ans += <span class="number">1L</span>L * S[k][j] * now % mod * tmp % mod) %= mod;</span><br><span class="line">        now = <span class="number">1L</span>L * now * inv2 % mod;</span><br><span class="line">        tmp = <span class="number">1L</span>L * tmp * (n-j) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.luogu.com.cn/problem/CF1278F" target="_blank" rel="noopener">CF1278F</a></p>
<h3 id="2-3-3-普通预处理"><a href="#2-3-3-普通预处理" class="headerlink" title="2.3.3. 普通预处理"></a>2.3.3. 普通预处理</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    S1[<span class="number">0</span>][<span class="number">0</span>] = S2[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        S1[i][i] = S2[i][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            S1[i][j] = (S1[i<span class="number">-1</span>][j<span class="number">-1</span>] + <span class="number">1L</span>L*(i<span class="number">-1</span>)*S1[i<span class="number">-1</span>][j]%mod) % mod;</span><br><span class="line">            S2[i][j] = (S2[i<span class="number">-1</span>][j<span class="number">-1</span>] + <span class="number">1L</span>L * j * S2[i<span class="number">-1</span>][j] % mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<div style="page-break-after: always; break-after: page;"></div>

<h1 id="3-多项式与生成函数"><a href="#3-多项式与生成函数" class="headerlink" title="3. 多项式与生成函数"></a>3. 多项式与生成函数</h1><h2 id="3-1-拉格朗日插值"><a href="#3-1-拉格朗日插值" class="headerlink" title="3.1. 拉格朗日插值"></a>3.1. 拉格朗日插值</h2><h3 id="3-1-1-朴素方法"><a href="#3-1-1-朴素方法" class="headerlink" title="3.1.1. 朴素方法"></a>3.1.1. 朴素方法</h3><p>$n$ 个点 $(x_i,y_i)$可以唯一地确定一个多项式 $y = f(x)$。</p>
<p>给定这 $n$ 个点，请你确定这个多项式，并求出 $f(k) \bmod 998244353$ 的值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span> <span class="comment">// 略</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ni</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> p)</span> <span class="comment">// 略</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="comment">// 给n+1个点值（x[0]~x[n]），插出f(k)</span></span></span><br><span class="line"><span class="function"><span class="comment">// 插出的多项式是一个最高次项为n的</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lagrange</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> *x, <span class="keyword">int</span> *y, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> s1 = <span class="number">1</span>, s2 = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(i != j)</span><br><span class="line">            &#123;</span><br><span class="line">                s1 = <span class="number">1L</span>L * s1 * (k-x[j]+mod) % mod;</span><br><span class="line">                s2 = <span class="number">1L</span>L * s2 * (x[i]-x[j]+mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = (ans + <span class="number">1L</span>L * y[i] * s1 % mod * ni(s2, mod) % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (ans + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x[i], &amp;y[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, lagrange(n<span class="number">-1</span>, x, y, k)); <span class="comment">// n个点确定一个n-1次多项式</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-2-重心法插值"><a href="#3-1-2-重心法插值" class="headerlink" title="3.1.2. 重心法插值"></a>3.1.2. 重心法插值</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> g = <span class="number">1</span>, t[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lagrange</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> *x, <span class="keyword">int</span> *y, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s = <span class="number">0</span>; g = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) g = <span class="number">1L</span>L * g * (k-x[i]+mod) % mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp1 = <span class="number">1</span>, tmp2, tmp3;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            tmp1 = j == i ? tmp1 : <span class="number">1L</span>L * (x[i]-x[j]+mod) * tmp1 % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        tmp2 = <span class="number">1L</span>L * y[i] * ni(tmp1, mod) % mod;</span><br><span class="line">        tmp3 = (k-x[i]+mod) % mod;</span><br><span class="line">        t[i] = <span class="number">1L</span>L * tmp2 * ni(tmp3, mod) % mod;</span><br><span class="line">        s = (s + t[i]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * g * s % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> *x, <span class="keyword">int</span> *y, <span class="keyword">int</span> xx, <span class="keyword">int</span> yy, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s = <span class="number">0</span>, tmp1 = <span class="number">1</span>, tmp2, tmp3;</span><br><span class="line">    x[n+<span class="number">1</span>] = xx; y[n+<span class="number">1</span>] = yy;</span><br><span class="line">    g = <span class="number">1L</span>L * g * (k-xx+mod) % mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) t[i] = <span class="number">1L</span>L * t[i] * ni(x[i] - xx + mod, mod) % mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; j++) tmp1 = <span class="number">1L</span>L * tmp1 * (xx-x[j]+mod) % mod;</span><br><span class="line">    tmp2 = <span class="number">1L</span>L * yy * ni(tmp1, mod) % mod;</span><br><span class="line">    tmp3 = (k - xx + mod) % mod;</span><br><span class="line">    t[n+<span class="number">1</span>] = <span class="number">1L</span>L * tmp2 * ni(tmp3, mod) % mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n+<span class="number">1</span>; i++) s = (s + t[i]) % mod;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1L</span>L * g * s % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x[i], &amp;y[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Lagrange(n<span class="number">-1</span>, x, y, k)); <span class="comment">// 和朴素方法用法一样</span></span><br><span class="line">    Lagrange(n<span class="number">-2</span>, x, y, k); <span class="comment">// 先插出前n-1个点的多项式</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, add(n<span class="number">-2</span>, x, y, x[n<span class="number">-1</span>], y[n<span class="number">-1</span>], k)); </span><br><span class="line">    <span class="comment">//O(n)插入一个新点，得到的结果相同</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-3-连续值的插值"><a href="#3-1-3-连续值的插值" class="headerlink" title="3.1.3. 连续值的插值"></a>3.1.3. 连续值的插值</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> s1[MAXN],s2[MAXN],ifac[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ifac[<span class="number">0</span>] = ifac[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) </span><br><span class="line">        ifac[i] = <span class="number">-1L</span>L * mod / i * ifac[mod%i] % mod;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) </span><br><span class="line">        ifac[i] = <span class="number">1L</span>L * ifac[i] * ifac[i<span class="number">-1</span>] % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lagrange2</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> *x, <span class="keyword">int</span> *y, ll xi)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>; xi %= mod;</span><br><span class="line">    s1[<span class="number">0</span>] = (xi - x[<span class="number">0</span>] + mod) % mod; s2[n+<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) s1[i] = <span class="number">1L</span>L * s1[i<span class="number">-1</span>] * (xi-x[i]) % mod;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">0</span>; i--) s2[i] = <span class="number">1L</span>L * s2[i+<span class="number">1</span>] * (xi-x[i]) % mod;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">        (ans += <span class="number">1L</span>L * y[i] * (i == <span class="number">0</span> ? <span class="number">1</span> : s1[i<span class="number">-1</span>]) % mod * s2[i+<span class="number">1</span>] % mod</span><br><span class="line">         * ifac[i] % mod * (((n-i)&amp;<span class="number">1</span>) ? <span class="number">-1</span> : <span class="number">1</span>) * ifac[n-i] % mod) %= mod;</span><br><span class="line">    <span class="keyword">return</span> (ans + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k);</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Lagrange2(n<span class="number">-1</span>, x, y, k));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-4-应用-求幂和"><a href="#3-1-4-应用-求幂和" class="headerlink" title="3.1.4. 应用-求幂和"></a>3.1.4. 应用-求幂和</h3><p><a href="https://www.luogu.com.cn/problem/CF622F" target="_blank" rel="noopener">CF622F</a></p>
<p>$$<br>\sum_{i=1}^{n}i^k<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="keyword">int</span> x[MAXN], y[MAXN];</span><br><span class="line"><span class="keyword">int</span> s1[MAXN],s2[MAXN],ifac[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ifac[<span class="number">0</span>] = ifac[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) </span><br><span class="line">        ifac[i] = <span class="number">-1L</span>L * mod / i * ifac[mod%i] % mod;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) </span><br><span class="line">        ifac[i] = <span class="number">1L</span>L * ifac[i] * ifac[i<span class="number">-1</span>] % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ksm</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = <span class="number">1L</span>L*a*a%p) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ans = <span class="number">1L</span>L * ans * a % p;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Lagrange</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> *x, <span class="keyword">int</span> *y, ll xi)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>; xi %= mod;</span><br><span class="line">    s1[<span class="number">0</span>] = (xi - x[<span class="number">0</span>] + mod) % mod; s2[n+<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) s1[i] = <span class="number">1L</span>L * s1[i<span class="number">-1</span>] * (xi-x[i]) % mod;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">0</span>; i--) s2[i] = <span class="number">1L</span>L * s2[i+<span class="number">1</span>] * (xi-x[i]) % mod;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">        (ans += <span class="number">1L</span>L * y[i] * (i == <span class="number">0</span> ? <span class="number">1</span> : s1[i<span class="number">-1</span>]) % mod * s2[i+<span class="number">1</span>] % mod</span><br><span class="line">         * ifac[i] % mod * (((n-i)&amp;<span class="number">1</span>) ? <span class="number">-1</span> : <span class="number">1</span>) * ifac[n-i] % mod) %= mod;</span><br><span class="line">    <span class="keyword">return</span> (ans + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 插出一个k+1次的多项式，因此有包含(0,0)的k+2个点值</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k+<span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        x[i] = i;</span><br><span class="line">        y[i] = (y[i<span class="number">-1</span>] + ksm(i, k, mod)) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ret = Lagrange(k+<span class="number">1</span>, x, y, n);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, solve(k, n));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-多项式模版"><a href="#3-2-多项式模版" class="headerlink" title="3.2. 多项式模版"></a>3.2. 多项式模版</h2><h3 id="3-2-1-多项式乘法-FFT"><a href="#3-2-1-多项式乘法-FFT" class="headerlink" title="3.2.1. 多项式乘法-FFT"></a>3.2.1. 多项式乘法-FFT</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Vec;</span><br><span class="line"><span class="comment">// 对于long long的乘法直接改Vec定义即可</span></span><br><span class="line"><span class="comment">// 后面乘法的强制类型转换改成ll</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> FFT</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">double</span> db;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">3e6</span> + <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">const</span> db pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">int</span> lim, l, r[MAXN];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        db r, i;</span><br><span class="line">        Complex(db r = <span class="number">0</span>, db i = <span class="number">0</span>) : r(r), i(i)&#123;&#125;</span><br><span class="line">        Complex <span class="keyword">operator</span> + (<span class="keyword">const</span> Complex &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Complex(r+x.r, i+x.i);</span><br><span class="line">        &#125;</span><br><span class="line">        Complex <span class="keyword">operator</span> - (<span class="keyword">const</span> Complex &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Complex(r-x.r, i-x.i);</span><br><span class="line">        &#125;</span><br><span class="line">        Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Complex(r*x.r-i*x.i, i*x.r+r*x.i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;wa[MAXN],wb[MAXN];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">DFT</span><span class="params">(Complex *A,<span class="keyword">int</span> type)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; lim; i++) <span class="keyword">if</span>(i &lt; r[i]) swap(A[i], A[r[i]]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; lim; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function">Complex <span class="title">Wn</span><span class="params">(<span class="built_in">cos</span>(pi/mid), type*<span class="built_in">sin</span>(pi/mid))</span></span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> R = mid &lt;&lt; <span class="number">1</span>, j = <span class="number">0</span>; j &lt; lim; j += R)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="function">Complex <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k++, w = w*Wn)</span><br><span class="line">                &#123;</span><br><span class="line">                    Complex x = A[j+k], y = w*A[j+mid+k];</span><br><span class="line">                    A[j+k] = x+y;</span><br><span class="line">                    A[j+mid+k] = x-y;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m, Complex *a = <span class="number">0</span>, Complex *b = <span class="number">0</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(lim = <span class="number">1</span>; lim &lt;= n+m; lim&lt;&lt;=<span class="number">1</span>,++l);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; lim; i++) r[i] = (r[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>) | ((i&amp;<span class="number">1</span>)&lt;&lt;(l<span class="number">-1</span>));</span><br><span class="line">        DFT(a, <span class="number">1</span>); DFT(b, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= lim; i++) a[i] = a[i]*b[i];</span><br><span class="line">        DFT(a, <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> FFT;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Poly</span><br><span class="line">&#123;</span><br><span class="line">    Vec <span class="keyword">operator</span> * (Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = (<span class="keyword">int</span>)a.size()<span class="number">-1</span>, m = (<span class="keyword">int</span>)b.size()<span class="number">-1</span>;</span><br><span class="line">        a.resize(n+<span class="number">1</span>); b.resize(m+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">memset</span>(wa, <span class="number">0</span>, <span class="keyword">sizeof</span>(wa)); <span class="built_in">memset</span>(wb, <span class="number">0</span>, <span class="keyword">sizeof</span>(wb)); l = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) wa[i].r = a[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) wb[i].r = b[i];</span><br><span class="line">        FFT::FFT(n, m, wa, wb);</span><br><span class="line">        a.resize(n+m+<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n+m; i++) a[i] = <span class="keyword">int</span>(wa[i].r/lim + <span class="number">0.5</span>);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a[n - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Poly;</span><br><span class="line">Vec a, b, ans;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m); a.resize(n+<span class="number">1</span>); b.resize(m+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;b[i]);</span><br><span class="line">    ans = a * b; print(ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-2-多项式乘法-NTT"><a href="#3-2-2-多项式乘法-NTT" class="headerlink" title="3.2.2. 多项式乘法-NTT"></a>3.2.2. 多项式乘法-NTT</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Vec;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Mo = <span class="number">167772161</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">pow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k, <span class="keyword">int</span> mo = Mo)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; k; k &gt;&gt;= <span class="number">1</span>, x = <span class="number">1l</span>l * x * x % mo)</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) ans = <span class="number">1l</span>l * ans * x % mo;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> mo = Mo)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">pow</span>(x, mo - <span class="number">2</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> NTT</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">extend</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; n &lt; x; n &lt;&lt;= <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(Vec &amp;A, <span class="keyword">bool</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(A.size()), k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(; (<span class="number">1</span> &lt;&lt; k) &lt; n; k++);</span><br><span class="line">        <span class="function">Vec <span class="title">rev</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) </span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span> | (i &amp; <span class="number">1</span>) &lt;&lt; (k - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span>(i &lt; rev[i]) swap(A[i], A[rev[i]]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> i1 = i &gt;&gt; <span class="number">1</span>, w = <span class="built_in">pow</span>(<span class="number">3</span>, (Mo - <span class="number">1</span>) / i);</span><br><span class="line">            <span class="keyword">if</span>(x) w = Inv(w);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> x1, x2, x3 = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; i1; ++k, x3 = <span class="number">1L</span>L * x3 * w % Mo)</span><br><span class="line">                &#123;</span><br><span class="line">                    x1 = A[j + k];</span><br><span class="line">                    x2 = <span class="number">1L</span>L * x3 * A[j + k + i1] % Mo;</span><br><span class="line">                    A[j + k] = (x1 + x2) % Mo;</span><br><span class="line">                    A[j + k + i1] = (x1 - x2 + Mo) % Mo;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">DFT</span><span class="params">(Vec &amp;A)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        NTT(A, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">IDFT</span><span class="params">(Vec &amp;A)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        NTT(A, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">int</span> t = Inv(<span class="keyword">int</span>(A.size()));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> &amp;x : A) x = <span class="number">1l</span>l * x * t % Mo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> NTT;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Poly</span><br><span class="line">&#123;</span><br><span class="line">    Vec <span class="keyword">operator</span> * (Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size() + b.size() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n);</span><br><span class="line">        a.resize(n1); DFT(a); b.resize(n1); DFT(b);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n1; i++) a[i] = <span class="number">1l</span>l * a[i] * b[i] % Mo;</span><br><span class="line">        IDFT(a); a.resize(n);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a[n - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Poly;</span><br><span class="line">Vec a, b, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j; i &lt;= n; i++) &#123;<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;j); a.push_back(j);&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j; i &lt;= m; i++) &#123;<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;j); b.push_back(j);&#125;</span><br><span class="line">    ans = a * a;</span><br><span class="line">    print(ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-3-多项式求逆"><a href="#3-2-3-多项式求逆" class="headerlink" title="3.2.3. 多项式求逆"></a>3.2.3. 多项式求逆</h3><p>给定一个多项式 $F(x)$ ，请求出一个多项式 $G(x)$， 满足 $F(x) * G(x) \equiv 1 ( \mathrm{mod:} x^n )$。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> Poly</span><br><span class="line">&#123;</span><br><span class="line">    Vec <span class="keyword">operator</span> *(Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size() + b.size() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n);</span><br><span class="line">        a.resize(n1); DFT(a); b.resize(n1); DFT(b);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n1; i++) a[i] = <span class="number">1l</span>l * a[i] * b[i] % Mo;</span><br><span class="line">        IDFT(a); a.resize(n);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> ~ (Vec a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n), x1 = <span class="number">0</span>;</span><br><span class="line">        a.resize(n1);</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n1, <span class="number">0</span>)</span></span>;</span><br><span class="line">        b[<span class="number">0</span>] = Inv(a[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n1; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec x(i), y(i);</span><br><span class="line">            copy(a.begin(), a.begin() + i, x.begin());</span><br><span class="line">            copy(b.begin(), b.begin() + i, y.begin());</span><br><span class="line">            x1 = i &lt;&lt; <span class="number">1</span>;</span><br><span class="line">            x.resize(x1); DFT(x);</span><br><span class="line">            y.resize(x1); DFT(y);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> ii = <span class="number">0</span>; ii &lt; x1; ii++)</span><br><span class="line">                x[ii] = <span class="number">1l</span>l * y[ii] * (<span class="number">2</span> - <span class="number">1L</span>L*x[ii]*y[ii]%Mo + Mo) % Mo;</span><br><span class="line">            IDFT(x);</span><br><span class="line">            x.resize(i);</span><br><span class="line">            <span class="built_in">std</span>::copy(x.begin(), x.begin() + i, b.begin());</span><br><span class="line">        &#125;</span><br><span class="line">        b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">fix</span><span class="params">(Vec a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        a.resize(b);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a[n - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n,; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j; i &lt;= n; i++) &#123;<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;j); a.push_back(j);&#125;</span><br><span class="line">    ans = ~a;</span><br><span class="line">    print(ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-4-多项式Exp和Ln"><a href="#3-2-4-多项式Exp和Ln" class="headerlink" title="3.2.4. 多项式Exp和Ln"></a>3.2.4. 多项式Exp和Ln</h3><p>多项式求Exp：给出 $n−1$ 次多项式 $A(x)$，求一个 $\bmod{:x^n}$下的多项式 $B(x)$，满足 $B(x) \equiv \text e^{A(x)}$.保证$a_0 = 0$.</p>
<p>多项式求Ln：给出 $n−1$ 次多项式 $A(x)$，求一个 $\bmod{:x^n}$ 下的多项式 $B(x)$，满足 $B(x) \equiv \ln A(x)$.保证$a_0 = 1$.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; (x += y) &gt;= Mo &amp;&amp; (x -= Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; (x -= y) &lt; <span class="number">0</span> &amp;&amp; (x += Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &gt;= Mo ? x - Mo : x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + Mo : x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mod</span><span class="params">(<span class="keyword">int</span> &amp;x)</span> </span>&#123; x &gt;= Mo &amp;&amp; (x -= Mo); x &lt; <span class="number">0</span> &amp;&amp; (x += Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> mo = Mo)</span> </span>&#123;<span class="keyword">return</span> <span class="number">1l</span>l * x * y % mo; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> NTT <span class="comment">// 略</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Poly</span><br><span class="line">&#123;</span><br><span class="line">    Vec <span class="keyword">operator</span> +(Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(max(a.size(), b.size()));</span><br><span class="line">        a.resize(n); b.resize(n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) add(a[i], b[i]);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> -(Vec a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : a) x = dec(-x);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> + (Vec a, <span class="keyword">int</span> b)</span><br><span class="line">    &#123;</span><br><span class="line">        add(a[<span class="number">0</span>], b);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> *(Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size() + b.size() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n);</span><br><span class="line">        a.resize(n1); DFT(a); b.resize(n1); DFT(b);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n1; i++) a[i] = <span class="number">1l</span>l * a[i] * b[i] % Mo;</span><br><span class="line">        IDFT(a); a.resize(n);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> ~ (Vec a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n), x1 = <span class="number">0</span>;</span><br><span class="line">        a.resize(n1);</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n1, <span class="number">0</span>)</span></span>;</span><br><span class="line">        b[<span class="number">0</span>] = inv(a[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n1; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec x(i), y(i);</span><br><span class="line">            copy(a.begin(), a.begin() + i, x.begin());</span><br><span class="line">            copy(b.begin(), b.begin() + i, y.begin());</span><br><span class="line">            x1 = i &lt;&lt; <span class="number">1</span>;</span><br><span class="line">            x.resize(x1); DFT(x);</span><br><span class="line">            y.resize(x1); DFT(y);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> ii = <span class="number">0</span>; ii &lt; x1; ii++)</span><br><span class="line">                x[ii] = <span class="number">1l</span>l * y[ii] * (<span class="number">2</span> - <span class="number">1L</span>L*x[ii]*y[ii]%Mo + Mo) % Mo;</span><br><span class="line">            IDFT(x);</span><br><span class="line">            x.resize(i);</span><br><span class="line">            <span class="built_in">std</span>::copy(x.begin(), x.begin() + i, b.begin());</span><br><span class="line">        &#125;</span><br><span class="line">        b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">fix</span><span class="params">(Vec a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        a.resize(b);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">der</span><span class="params">(Vec a, <span class="keyword">bool</span> tf = <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">1</span>) <span class="keyword">return</span> Vec(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n - <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) b[i - <span class="number">1</span>] = <span class="number">1l</span>l * i * a[i] % Mo;</span><br><span class="line">        <span class="keyword">if</span>(tf) b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">Inte</span><span class="params">(Vec a, <span class="keyword">bool</span> tf = <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) b[i] = <span class="number">1l</span>l * inv(i) * a[i - <span class="number">1</span>] % Mo;</span><br><span class="line">        <span class="keyword">if</span>(tf) b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">Ln</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        assert(a[<span class="number">0</span>] == <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">return</span> Inte(fix(der(a) * ~a, n));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">Exp</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        assert(a[<span class="number">0</span>] == <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n);</span><br><span class="line">        a.resize(n1);</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n1, <span class="number">0</span>)</span></span>;</span><br><span class="line">        b[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n1; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec x = (-Ln(fix(b, i)) + fix(a, i) + <span class="number">1</span>) * fix(b, i);</span><br><span class="line">            copy(x.begin(), x.begin() + i, b.begin());</span><br><span class="line">        &#125;</span><br><span class="line">        b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a[n - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-5-多项式多点求值和快速插值"><a href="#3-2-5-多项式多点求值和快速插值" class="headerlink" title="3.2.5. 多项式多点求值和快速插值"></a>3.2.5. 多项式多点求值和快速插值</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SZ(o) int(o.size())</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Vec;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Mo = <span class="number">998244353</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; (x += y) &gt;= Mo &amp;&amp; (x -= Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; (x -= y) &lt; <span class="number">0</span> &amp;&amp; (x += Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &gt;= Mo ? x - Mo : x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + Mo : x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mod</span><span class="params">(<span class="keyword">int</span> &amp;x)</span> </span>&#123; x &gt;= Mo &amp;&amp; (x -= Mo); x &lt; <span class="number">0</span> &amp;&amp; (x += Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> mo = Mo)</span> </span>&#123;<span class="keyword">return</span> <span class="number">1l</span>l * x * y % mo; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">pow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k, <span class="keyword">int</span> mo = Mo)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; k; k &gt;&gt;= <span class="number">1</span>, x = <span class="number">1l</span>l * x * x % mo)</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) ans = <span class="number">1l</span>l * ans * x % mo;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> mo = Mo)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">pow</span>(x, mo - <span class="number">2</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> NTT <span class="comment">// 略</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Poly</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Vec <span class="title">fix</span><span class="params">(Vec a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        a.resize(b);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> - (Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(max(a.size(), b.size()));</span><br><span class="line">        a.resize(n); b.resize(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) dec(a[i], b[i]);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> *(Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size() + b.size() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n);</span><br><span class="line">        a.resize(n1); DFT(a); b.resize(n1); DFT(b);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n1; i++) a[i] = <span class="number">1L</span>L * a[i] * b[i] % Mo;</span><br><span class="line">        IDFT(a); a.resize(n);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> ~ (Vec a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = SZ(a);</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n), x1 = <span class="number">0</span>;</span><br><span class="line">        a.resize(n1);</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n1, <span class="number">0</span>)</span></span>;</span><br><span class="line">        b[<span class="number">0</span>] = Inv(a[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n1; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec x(i), y(i);</span><br><span class="line">            copy(a.begin(), a.begin() + i, x.begin());</span><br><span class="line">            copy(b.begin(), b.begin() + i, y.begin());</span><br><span class="line">            x1 = i &lt;&lt; <span class="number">1</span>;</span><br><span class="line">            x.resize(x1); DFT(x);</span><br><span class="line">            y.resize(x1); DFT(y);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> ii = <span class="number">0</span>; ii &lt; x1; ii++)</span><br><span class="line">                x[ii] = <span class="number">1l</span>l * y[ii] * (<span class="number">2</span> - <span class="number">1L</span>L*x[ii]*y[ii]%Mo + Mo) % Mo;</span><br><span class="line">            IDFT(x);</span><br><span class="line">            x.resize(i);</span><br><span class="line">            <span class="built_in">std</span>::copy(x.begin(), x.begin() + i, b.begin());</span><br><span class="line">        &#125;</span><br><span class="line">        b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> / (Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size() - b.size() + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(n &lt;= <span class="number">0</span>) <span class="keyword">return</span> Vec(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        reverse(a.begin(), a.end());</span><br><span class="line">        reverse(b.begin(), b.end());</span><br><span class="line">        a.resize(n); b.resize(n);</span><br><span class="line">        a = fix(a * ~b, n);</span><br><span class="line">        reverse(a.begin(), a.end());</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> % (Vec a, Vec b) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(b.size() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> fix(a - a / b * b, n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = SZ(a);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a[n - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Poly;</span><br><span class="line">Vec a, b, ans, ans1, ans2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> GetVal<span class="comment">//多项式多点求值、快速插值</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500001</span>;</span><br><span class="line">    <span class="keyword">int</span> x[N]; <span class="comment">//x为多点插值的点</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        Vec x;</span><br><span class="line">        node *lc, *rc;</span><br><span class="line">    &#125;po[N*<span class="number">4</span>], *tt, *rt = po;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">qr</span><span class="params">(Vec a, <span class="keyword">int</span> x)</span> <span class="comment">//多项式求值</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sz = SZ(a), y = <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sz; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            add(ret, mul(a[i], y));</span><br><span class="line">            y = mul(y, x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(node *&amp;o, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        o = ++tt;</span><br><span class="line">        <span class="keyword">if</span>(l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            o-&gt;x.clear();</span><br><span class="line">            o-&gt;x.push_back((Mo-x[l]) % Mo);</span><br><span class="line">            o-&gt;x.push_back(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        calc(o-&gt;lc, l, mid);</span><br><span class="line">        calc(o-&gt;rc, mid+<span class="number">1</span>, r);</span><br><span class="line">        o-&gt;x = o-&gt;lc-&gt;x * o-&gt;rc-&gt;x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(node *o,Vec f,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            x[l] = qr(f, x[l]);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(f.size() &lt;= <span class="number">512</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i &lt;= r; i++) x[i] = qr(f, x[i]);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        solve(o-&gt;lc, f%o-&gt;lc-&gt;x, l, mid);</span><br><span class="line">        solve(o-&gt;rc, f%o-&gt;rc-&gt;x, mid+<span class="number">1</span>, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">val</span><span class="params">(Vec f, <span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        tt = po;</span><br><span class="line">        calc(rt, <span class="number">1</span>, m);</span><br><span class="line">        solve(rt, f, <span class="number">1</span>, m);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> y[N], tx[N];<span class="comment">//快速插值</span></span><br><span class="line">    <span class="function">Vec <span class="title">solve2</span><span class="params">(node *o, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(r - l &lt; <span class="number">512</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec ret;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i &lt;= r; i++) ret.push_back(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i &lt;= r; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> va = mul(y[i], Inv(x[i]));</span><br><span class="line">                Vec a = o-&gt;x;</span><br><span class="line">                <span class="keyword">int</span> n = SZ(a);</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = n<span class="number">-1</span>; j; j--)</span><br><span class="line">                &#123;</span><br><span class="line">                    add(ret[j<span class="number">-1</span>], mul(a[j], va));</span><br><span class="line">                    add(a[j<span class="number">-1</span>], mul(a[j], tx[i]));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(l==r)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec ret;</span><br><span class="line">            ret.push_back(mul(y[l], Inv(x[l])));</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (l+r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        Vec a = solve2(o-&gt;lc, l, mid) * o-&gt;rc-&gt;x;</span><br><span class="line">        Vec b = solve2(o-&gt;rc, mid+<span class="number">1</span>, r) * o-&gt;lc-&gt;x;</span><br><span class="line">        <span class="keyword">if</span>(SZ(a) &gt; SZ(b))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = SZ(b)<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--) add(a[i], b[i]);</span><br><span class="line">            <span class="keyword">return</span> a;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = SZ(a)<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--) add(b[i], a[i]);</span><br><span class="line">            <span class="keyword">return</span> b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">lagrange</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(tx+<span class="number">1</span>, x+<span class="number">1</span>, n &lt;&lt; <span class="number">2</span>);</span><br><span class="line">        tt = po;</span><br><span class="line">        calc(rt, <span class="number">1</span>, n);</span><br><span class="line">        Vec f;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, sz = SZ(rt-&gt;x); i &lt; sz; i++)</span><br><span class="line">            f.push_back(mul(rt-&gt;x[i], i));</span><br><span class="line">        solve(rt, f, <span class="number">1</span>, n);</span><br><span class="line">        <span class="keyword">return</span> solve2(rt, <span class="number">1</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//多项式多点求值</span></span><br><span class="line"><span class="comment">//    int n, m; scanf("%d%d", &amp;n, &amp;m);</span></span><br><span class="line"><span class="comment">//    a.resize(n+1);</span></span><br><span class="line"><span class="comment">//    for(int i = 0; i &lt;= n; i++) scanf("%d", &amp;a[i]);</span></span><br><span class="line"><span class="comment">//    for(int i = 1; i &lt;= m; i++) scanf("%d", GetVal::x+i);</span></span><br><span class="line"><span class="comment">//    GetVal::val(a, m);</span></span><br><span class="line"><span class="comment">//    for(int i = 1; i &lt;= m; i++) printf("%d\n", GetVal::x[i]);</span></span><br><span class="line">    <span class="comment">//多项式快速插值</span></span><br><span class="line"><span class="comment">//    int n;</span></span><br><span class="line"><span class="comment">//    scanf("%d", &amp;n);</span></span><br><span class="line"><span class="comment">//    for(int i = 1; i &lt;= n; i++) scanf("%d%d", GetVal::x+i, GetVal::y+i);</span></span><br><span class="line"><span class="comment">//    ans = GetVal::lagrange(n);</span></span><br><span class="line"><span class="comment">//    print(ans);</span></span><br><span class="line">    <span class="comment">// 拉格朗日插值模版题</span></span><br><span class="line">    <span class="keyword">int</span> n, k, t;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, GetVal::x+i, GetVal::y+i);</span><br><span class="line">    ans = GetVal::lagrange(n);</span><br><span class="line">    t = GetVal::qr(ans, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, t);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-6-多项式全家桶"><a href="#3-2-6-多项式全家桶" class="headerlink" title="3.2.6. 多项式全家桶"></a>3.2.6. 多项式全家桶</h3><p>多项式除法与取模：给定一个 $n$ 次多项式 $F(x)$ 和一个 $m$ 次多项式 $G(x)$ ，请求出多项式 $Q(x)$, $R(x)$，满足以下条件：$Q(x)$ 次数为 $n-m$，$R(x)$ 次数小于 $m$; $F(x) = Q(x) * G(x) + R(x)$</p>
<p>多项式开根：给定一个$n−1$次多项式$A(x)$，求一个在$\bmod\ x^n$意义下的多项式$B(x)$，使得$B^2(x) \equiv A(x) \ (\bmod\ x^n)$。保证$a_0 = 1$.</p>
<p>多项式快速幂：给定一个$n-1$次多项式$A(x)$，求一个在$\bmod\ x^n$意义下的多项式$B(x)$，使得$B(x) \equiv A^k(x) \ (\bmod\ x^n)$。保证$a_0 = 1$.</p>
<p>多项式三角函数：给定一个$n-1$次多项式$A(x)$，求一个$\bmod{:x^n}$下的多项式$F(x)$，满足$F(x)\equiv\sin{A(x)}$或$F(x)\equiv\cos{A(x)}$。保证$a_0 = 0$.</p>
<p>多项式多点求值：给定一个 $n$ 次多项式 $f(x)$ ，现在请你对于 $i \in [1,m]$ ，求出 $f(a_i)$。第一行两个正整数 $n,m$ 表示多项式的次数及你要求的点值的数量。第二行 $n+1$个非负整数，由低到高地给出多项式的系数。第三行 $m$ 个非负整数，表示 $a_i$</p>
<p>多项式快速插值：给出 $n$ 个点 $(x_i, y_i)$，求一个 $x-1$ 次的多项式 $f(x)$，使得 $f(x_i)\equiv y_i\pmod{998244353}$.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Vec;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Mo = <span class="number">998244353</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; (x += y) &gt;= Mo &amp;&amp; (x -= Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; (x -= y) &lt; <span class="number">0</span> &amp;&amp; (x += Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &gt;= Mo ? x - Mo : x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + Mo : x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mod</span><span class="params">(<span class="keyword">int</span> &amp;x)</span> </span>&#123; x &gt;= Mo &amp;&amp; (x -= Mo); x &lt; <span class="number">0</span> &amp;&amp; (x += Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> mo = Mo)</span> </span>&#123;<span class="keyword">return</span> <span class="number">1l</span>l * x * y % mo; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getmod</span><span class="params">(<span class="keyword">int</span> mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> b = <span class="number">0</span>; <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c = getchar()));</span><br><span class="line">    <span class="keyword">for</span>(; <span class="built_in">isdigit</span>(c); c = getchar())</span><br><span class="line">    &#123;</span><br><span class="line">        b = b * <span class="number">10</span> + c - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span>(b &gt;= mod) b %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">int</span>(b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">pow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k, <span class="keyword">int</span> mo = Mo)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; k; k &gt;&gt;= <span class="number">1</span>, x = <span class="number">1l</span>l * x * x % mo)</span><br><span class="line">        <span class="keyword">if</span> (k &amp; <span class="number">1</span>) ans = <span class="number">1l</span>l * ans * x % mo;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> mo = Mo)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">pow</span>(x, mo - <span class="number">2</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">BSGS</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mp;</span><br><span class="line">    <span class="keyword">int</span> m = <span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; b = <span class="number">1l</span>l * b * a % p, i++) mp[b] = i;</span><br><span class="line">    a = <span class="built_in">pow</span>(a, m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">1</span>; i &lt; m; j = <span class="number">1l</span>l * j * a % p, i++)</span><br><span class="line">        <span class="keyword">if</span> (mp.count(j) &amp;&amp; i * m &gt;= mp[j]) <span class="keyword">return</span> i * m - mp[j];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">root</span><span class="params">(<span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Vec fac;</span><br><span class="line">    <span class="keyword">int</span> x = p - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= x; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(x % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            fac.emplace_back(i);</span><br><span class="line">            <span class="keyword">while</span> (x % i == <span class="number">0</span>) x /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x &gt; <span class="number">1</span>) fac.emplace_back(x);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= (p - <span class="number">1</span>); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">bool</span> tf = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> j : fac)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">pow</span>(i, (p - <span class="number">1</span>) / j, p) == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                tf = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(tf) <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">degree</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = BSGS(<span class="number">3</span>, a, p);</span><br><span class="line">    assert(y &gt;= <span class="number">0</span> &amp;&amp; y % b == <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> z = <span class="built_in">pow</span>(<span class="number">3</span>, y / b);</span><br><span class="line">    <span class="keyword">return</span> min(z, p - z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> NTT</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">extend</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; n &lt; x; n &lt;&lt;= <span class="number">1</span>) ;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(Vec &amp;A, <span class="keyword">bool</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(A.size()), k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(; (<span class="number">1</span> &lt;&lt; k) &lt; n; k++);</span><br><span class="line">        <span class="function">Vec <span class="title">rev</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            rev[i] = rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span> | (i &amp; <span class="number">1</span>) &lt;&lt; (k - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span>(i &lt; rev[i]) swap(A[i], A[rev[i]]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> i1 = i &gt;&gt; <span class="number">1</span>, w = <span class="built_in">pow</span>(<span class="number">3</span>, (Mo - <span class="number">1</span>) / i);</span><br><span class="line">            <span class="keyword">if</span>(x) w = Inv(w);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> x1, x2, x3 = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; i1; ++k, x3 = <span class="number">1L</span>L * x3 * w % Mo)</span><br><span class="line">                &#123;</span><br><span class="line">                    x1 = A[j + k];</span><br><span class="line">                    x2 = <span class="number">1L</span>L * x3 * A[j + k + i1] % Mo;</span><br><span class="line">                    A[j + k] = (x1 + x2) % Mo;</span><br><span class="line">                    A[j + k + i1] = (x1 - x2 + Mo) % Mo;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">DFT</span><span class="params">(Vec &amp;A)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        NTT(A, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">IDFT</span><span class="params">(Vec &amp;A)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        NTT(A, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">int</span> t = Inv(<span class="keyword">int</span>(A.size()));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> &amp;x : A) x = <span class="number">1l</span>l * x * t % Mo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> NTT;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Poly</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">Vec <span class="title">fix</span><span class="params">(Vec a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        a.resize(b);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> +(Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(max(a.size(), b.size()));</span><br><span class="line">        a.resize(n); b.resize(n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) add(a[i], b[i]);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> + (Vec a, <span class="keyword">int</span> b)</span><br><span class="line">    &#123;</span><br><span class="line">        add(a[<span class="number">0</span>], b);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> + (<span class="keyword">int</span> b, Vec a)</span><br><span class="line">    &#123;</span><br><span class="line">        add(a[<span class="number">0</span>], b);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> - (Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(max(a.size(), b.size()));</span><br><span class="line">        a.resize(n); b.resize(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) dec(a[i], b[i]);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> - (Vec a, <span class="keyword">int</span> b)</span><br><span class="line">    &#123;</span><br><span class="line">        dec(a[<span class="number">0</span>], b);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> -(Vec a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : a) x = dec(-x);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> - (<span class="keyword">int</span> b, Vec a)</span><br><span class="line">    &#123;</span><br><span class="line">        a = -a;</span><br><span class="line">        add(a[<span class="number">0</span>], b);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> *(Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size() + b.size() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n);</span><br><span class="line">        a.resize(n1); DFT(a); b.resize(n1); DFT(b);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n1; i++) a[i] = <span class="number">1l</span>l * a[i] * b[i] % Mo;</span><br><span class="line">        IDFT(a); a.resize(n);</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> * (Vec a, <span class="keyword">int</span> b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : a) x = <span class="number">1l</span>l * x * b % Mo;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vec <span class="keyword">operator</span> * (<span class="keyword">int</span> b, Vec a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x : a) x = <span class="number">1l</span>l * x * b % Mo;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> ~ (Vec a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n), x1 = <span class="number">0</span>;</span><br><span class="line">        a.resize(n1);</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n1, <span class="number">0</span>)</span></span>;</span><br><span class="line">        b[<span class="number">0</span>] = Inv(a[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n1; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec x(i), y(i);</span><br><span class="line">            copy(a.begin(), a.begin() + i, x.begin());</span><br><span class="line">            copy(b.begin(), b.begin() + i, y.begin());</span><br><span class="line">            x1 = i &lt;&lt; <span class="number">1</span>;</span><br><span class="line">            x.resize(x1); DFT(x);</span><br><span class="line">            y.resize(x1); DFT(y);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> ii = <span class="number">0</span>; ii &lt; x1; ii++)</span><br><span class="line">                x[ii] = <span class="number">1l</span>l * y[ii] * (<span class="number">2</span> - <span class="number">1L</span>L*x[ii]*y[ii]%Mo + Mo) % Mo;</span><br><span class="line">            IDFT(x);</span><br><span class="line">            x.resize(i);</span><br><span class="line">            <span class="built_in">std</span>::copy(x.begin(), x.begin() + i, b.begin());</span><br><span class="line">        &#125;</span><br><span class="line">        b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vec <span class="keyword">operator</span> / (Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size() - b.size() + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(n &lt;= <span class="number">0</span>) <span class="keyword">return</span> Vec(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        reverse(a.begin(), a.end());</span><br><span class="line">        reverse(b.begin(), b.end());</span><br><span class="line">        a.resize(n); b.resize(n);</span><br><span class="line">        a = fix(a * ~b, n);</span><br><span class="line">        reverse(a.begin(), a.end());</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vec <span class="keyword">operator</span> / (Vec a, <span class="keyword">int</span> b) &#123;</span><br><span class="line">        <span class="keyword">return</span> a * Inv(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vec <span class="keyword">operator</span> % (Vec a, Vec b) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(b.size() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> fix(a - a / b * b, n);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vec <span class="keyword">operator</span> &lt;&lt;(Vec a, <span class="keyword">int</span> b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="function">Vec <span class="title">B</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - b; i++) B[i + b] = a[i];</span><br><span class="line">        <span class="keyword">return</span> B;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Vec <span class="keyword">operator</span> &gt;&gt;(Vec a, <span class="keyword">int</span> b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="function">Vec <span class="title">B</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - b; i++) B[i] = a[i + b];</span><br><span class="line">        <span class="keyword">return</span> B;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Vec <span class="title">der</span><span class="params">(Vec a, <span class="keyword">bool</span> tf = <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">1</span>) <span class="keyword">return</span> Vec(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n - <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) b[i - <span class="number">1</span>] = <span class="number">1l</span>l * i * a[i] % Mo;</span><br><span class="line">        <span class="keyword">if</span>(tf) b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Vec <span class="title">Inte</span><span class="params">(Vec a, <span class="keyword">bool</span> tf = <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) b[i] = <span class="number">1l</span>l * Inv(i) * a[i - <span class="number">1</span>] % Mo;</span><br><span class="line">        <span class="keyword">if</span>(tf) b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Vec <span class="title">Sqrt</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n);</span><br><span class="line">        a.resize(n1);</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n1, <span class="number">0</span>)</span></span>;</span><br><span class="line">        b[<span class="number">0</span>] = degree(a[<span class="number">0</span>], <span class="number">2</span>, Mo);</span><br><span class="line">        <span class="keyword">int</span> t = Inv(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n1; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec x(i), y(i);</span><br><span class="line">            copy(a.begin(), a.begin() + i, x.begin());</span><br><span class="line">            copy(b.begin(), b.begin() + i, y.begin());</span><br><span class="line">            Vec z = ~y;</span><br><span class="line">            <span class="keyword">int</span> x1 = i &lt;&lt; <span class="number">1</span>;</span><br><span class="line">            x.resize(x1); DFT(x);</span><br><span class="line">            y.resize(x1); DFT(y);</span><br><span class="line">            z.resize(x1); DFT(z);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> ii = <span class="number">0</span>; ii &lt; x1; ii++)</span><br><span class="line">            &#123;</span><br><span class="line">                y[ii] = <span class="number">1l</span>l * y[ii] * y[ii] % Mo;</span><br><span class="line">                x[ii] = <span class="number">1l</span>l * (x[ii] + y[ii]) * t % Mo * z[ii] % Mo;</span><br><span class="line">            &#125;</span><br><span class="line">            IDFT(x);</span><br><span class="line">            x.resize(i);</span><br><span class="line">            copy(x.begin(), x.begin() + i, b.begin());</span><br><span class="line">        &#125;</span><br><span class="line">        b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Vec <span class="title">Ln</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        assert(a[<span class="number">0</span>] == <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">return</span> Inte(fix(der(a) * ~a, n));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">Exp</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        assert(a[<span class="number">0</span>] == <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">int</span> n1 = extend(n);</span><br><span class="line">        a.resize(n1);</span><br><span class="line">        <span class="function">Vec <span class="title">b</span><span class="params">(n1, <span class="number">0</span>)</span></span>;</span><br><span class="line">        b[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n1; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec x = (-Ln(fix(b, i)) + fix(a, i) + <span class="number">1</span>) * fix(b, i);</span><br><span class="line">            copy(x.begin(), x.begin() + i, b.begin());</span><br><span class="line">        &#125;</span><br><span class="line">        b.resize(n);</span><br><span class="line">        <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">root</span><span class="params">(Vec a, <span class="keyword">int</span> b)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">return</span> b == <span class="number">1</span> ? a : b == <span class="number">2</span> ? Sqrt(a) : Exp(Ln(a) / b); </span><br><span class="line">    &#125;</span><br><span class="line">    Vec <span class="keyword">operator</span> ^ (Vec a, <span class="keyword">int</span> b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">int</span> x = <span class="number">0</span>, y;</span><br><span class="line">        <span class="keyword">while</span>(x &lt; n &amp;&amp; a[x] == <span class="number">0</span>) x++;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1l</span>l * x * b &gt;= n) <span class="keyword">return</span> Vec(n, <span class="number">0</span>);</span><br><span class="line">        a = a &gt;&gt; x; y = a[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">return</span> (Exp(Ln(a) * b) * <span class="built_in">pow</span>(y, b)) &lt;&lt; (x * b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">sin</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        assert(a[<span class="number">0</span>] == <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> x = degree(Mo - <span class="number">1</span>, <span class="number">2</span>, Mo);</span><br><span class="line">        Vec b = Exp(x * a);</span><br><span class="line">        <span class="keyword">return</span> (b - ~b) / ((<span class="keyword">long</span> <span class="keyword">long</span>)<span class="number">2</span> * x % Mo);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">cos</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        assert(a[<span class="number">0</span>] == <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> x = degree(Mo - <span class="number">1</span>, <span class="number">2</span>, Mo);</span><br><span class="line">        Vec b = Exp(x * a);</span><br><span class="line">        <span class="keyword">return</span> (b + ~b) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">tan</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        assert(a[<span class="number">0</span>] == <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">return</span> fix(<span class="built_in">sin</span>(a) * ~<span class="built_in">cos</span>(a), n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(Vec a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="keyword">int</span>(a.size());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a[n - <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Poly;</span><br><span class="line">Vec a, b, ans, ans1, ans2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> GetVal<span class="comment">//多项式多点求值、快速插值</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100001</span>;</span><br><span class="line">    <span class="keyword">int</span> x[N]; <span class="comment">//x为多点插值的点</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        Vec x;</span><br><span class="line">        node *lc, *rc;</span><br><span class="line">    &#125;po[N*<span class="number">4</span>], *tt, *rt = po;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">qr</span><span class="params">(Vec a, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sz = <span class="keyword">int</span>(a.size()), y = <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sz; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            add(ret, mul(a[i], y));</span><br><span class="line">            y = mul(y, x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(node *&amp;o, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        o = ++tt;</span><br><span class="line">        <span class="keyword">if</span>(l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            o-&gt;x.clear();</span><br><span class="line">            o-&gt;x.push_back((Mo-x[l]) % Mo);</span><br><span class="line">            o-&gt;x.push_back(<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        calc(o-&gt;lc, l, mid);</span><br><span class="line">        calc(o-&gt;rc, mid+<span class="number">1</span>, r);</span><br><span class="line">        o-&gt;x = o-&gt;lc-&gt;x * o-&gt;rc-&gt;x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(node *o,Vec f,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            x[l] = qr(f, x[l]);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(f.size() &lt;= <span class="number">512</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i &lt;= r; i++) x[i] = qr(f, x[i]);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        solve(o-&gt;lc, f%o-&gt;lc-&gt;x, l, mid);</span><br><span class="line">        solve(o-&gt;rc, f%o-&gt;rc-&gt;x, mid+<span class="number">1</span>, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">val</span><span class="params">(Vec f, <span class="keyword">int</span> m)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        tt = po;</span><br><span class="line">        calc(rt, <span class="number">1</span>, m);</span><br><span class="line">        solve(rt, f, <span class="number">1</span>, m);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> y[N], tx[N];<span class="comment">//快速插值</span></span><br><span class="line">    <span class="function">Vec <span class="title">solve2</span><span class="params">(node *o, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(r - l &lt; <span class="number">512</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec ret;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i &lt;= r; i++) ret.push_back(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = l; i &lt;= r; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> va = mul(y[i], Inv(x[i]));</span><br><span class="line">                Vec a = o-&gt;x;</span><br><span class="line">                <span class="keyword">int</span> n = (<span class="keyword">int</span>)a.size();</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = n<span class="number">-1</span>; j; j--)</span><br><span class="line">                &#123;</span><br><span class="line">                    add(ret[j<span class="number">-1</span>], mul(a[j], va));</span><br><span class="line">                    add(a[j<span class="number">-1</span>], mul(a[j], tx[i]));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            Vec ret;</span><br><span class="line">            ret.push_back(mul(y[l], Inv(x[l])));</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        Vec a = solve2(o-&gt;lc,l,mid) * o-&gt;rc-&gt;x;</span><br><span class="line">        Vec b = solve2(o-&gt;rc,mid+<span class="number">1</span>,r) * o-&gt;lc-&gt;x;</span><br><span class="line">        <span class="keyword">if</span>(a.size() &gt; b.size())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = (<span class="keyword">int</span>)b.size()<span class="number">-1</span> ;i &gt;= <span class="number">0</span>; i--) add(a[i], b[i]);</span><br><span class="line">            <span class="keyword">return</span> a;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=(<span class="keyword">int</span>)a.size()<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--) add(b[i], a[i]);</span><br><span class="line">            <span class="keyword">return</span> b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">lagrange</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">memcpy</span>(tx+<span class="number">1</span>, x+<span class="number">1</span>, n&lt;&lt;<span class="number">2</span>);</span><br><span class="line">        tt = po;</span><br><span class="line">        calc(rt, <span class="number">1</span>, n);</span><br><span class="line">        Vec f;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, sz = (<span class="keyword">int</span>)rt-&gt;x.size(); i &lt; sz; i++)</span><br><span class="line">            f.push_back(mul(rt-&gt;x[i],i));</span><br><span class="line">        solve(rt, f, <span class="number">1</span>, n);</span><br><span class="line">        <span class="keyword">return</span> solve2(rt, <span class="number">1</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//多项式乘法</span></span><br><span class="line"><span class="comment">//    int n, m; scanf("%d%d", &amp;n, &amp;m);</span></span><br><span class="line"><span class="comment">//    for(int i = 0, j; i &lt;= n; i++) &#123;scanf("%d", &amp;j); a.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    for(int i = 0, j; i &lt;= m; i++) &#123;scanf("%d", &amp;j); b.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    ans = a * b;</span></span><br><span class="line"><span class="comment">//    print(ans);</span></span><br><span class="line">    <span class="comment">//多项式求逆</span></span><br><span class="line"><span class="comment">//    int n; scanf("%d", &amp;n);</span></span><br><span class="line"><span class="comment">//    for(int i = 1, j; i &lt;= n; i++) &#123;scanf("%d", &amp;j); a.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    ans = ~a;</span></span><br><span class="line"><span class="comment">//    print(ans);</span></span><br><span class="line">    <span class="comment">//多项式除法</span></span><br><span class="line"><span class="comment">//    int n, m; scanf("%d%d", &amp;n, &amp;m);</span></span><br><span class="line"><span class="comment">//    for(int i = 0, j; i &lt;= n; i++) &#123;scanf("%d", &amp;j); a.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    for(int i = 0, j; i &lt;= m; i++) &#123;scanf("%d", &amp;j); b.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    ans1 = a / b; ans2 = a % b;</span></span><br><span class="line"><span class="comment">//    print(ans1);</span></span><br><span class="line"><span class="comment">//    print(ans2);</span></span><br><span class="line">    <span class="comment">//多项式快速幂</span></span><br><span class="line"><span class="comment">//    freopen("ksm.in", "r", stdin);</span></span><br><span class="line"><span class="comment">//    freopen("ksm.out", "w", stdout);</span></span><br><span class="line"><span class="comment">//    int n, m; scanf("%d", &amp;n); m = getmod(998244353);</span></span><br><span class="line"><span class="comment">//    a.resize(n);</span></span><br><span class="line"><span class="comment">//    for(int i = 0; i &lt; n; i++) scanf("%d", &amp;a[i]);</span></span><br><span class="line"><span class="comment">//    ans = a ^ m;</span></span><br><span class="line"><span class="comment">//    print(ans);</span></span><br><span class="line">    <span class="comment">//多项式对数函数</span></span><br><span class="line"><span class="comment">//    int n; scanf("%d", &amp;n);</span></span><br><span class="line"><span class="comment">//    for(int i = 1, j; i &lt;= n; i++) &#123;scanf("%d", &amp;j); a.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    ans = Ln(a);</span></span><br><span class="line"><span class="comment">//    print(ans);</span></span><br><span class="line">    <span class="comment">//多项式指数函数</span></span><br><span class="line"><span class="comment">//    int n; scanf("%d", &amp;n);</span></span><br><span class="line"><span class="comment">//    for(int i = 1, j; i &lt;= n; i++) &#123;scanf("%d", &amp;j); a.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    ans = Exp(a);</span></span><br><span class="line"><span class="comment">//    print(ans);</span></span><br><span class="line">    <span class="comment">//多项式开根</span></span><br><span class="line"><span class="comment">//    int n; scanf("%d", &amp;n);</span></span><br><span class="line"><span class="comment">//    for(int i = 1, j; i &lt;= n; i++) &#123;scanf("%d", &amp;j); a.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    ans = Sqrt(a);</span></span><br><span class="line"><span class="comment">//    print(ans);</span></span><br><span class="line">    <span class="comment">//多项式三角函数</span></span><br><span class="line"><span class="comment">//    int n, m; scanf("%d%d", &amp;n, &amp;m);</span></span><br><span class="line"><span class="comment">//    for(int i = 1, j; i &lt;= n; i++) &#123;scanf("%d", &amp;j); a.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    if(m == 1) ans = cos(a); else ans = sin(a);</span></span><br><span class="line"><span class="comment">//    print(ans);</span></span><br><span class="line">    <span class="comment">//分治FFT</span></span><br><span class="line"><span class="comment">//    int n; scanf("%d", &amp;n); a.push_back(0);</span></span><br><span class="line"><span class="comment">//    for(int i = 1, j; i &lt; n; i++) &#123;scanf("%d", &amp;j); a.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    ans = ~(1 - a); print(ans);</span></span><br><span class="line">    <span class="comment">//多项式多点求值</span></span><br><span class="line"><span class="comment">//    int n, m; scanf("%d%d", &amp;n, &amp;m);</span></span><br><span class="line"><span class="comment">//    a.resize(n+1);</span></span><br><span class="line"><span class="comment">//    for(int i = 0; i &lt;= n; i++) scanf("%d", &amp;a[i]);</span></span><br><span class="line"><span class="comment">//    for(int i = 1; i &lt;= m; i++) scanf("%d", GetVal::x+i);</span></span><br><span class="line"><span class="comment">//    GetVal::val(a, m);</span></span><br><span class="line"><span class="comment">//    for(int i = 1; i &lt;= m; i++) printf("%d\n", GetVal::x[i]);</span></span><br><span class="line">    <span class="comment">//多项式快速插值</span></span><br><span class="line"><span class="comment">//    int n;</span></span><br><span class="line"><span class="comment">//    scanf("%d", &amp;n);</span></span><br><span class="line"><span class="comment">//    for(int i = 1; i &lt;= n; i++) scanf("%d%d", GetVal::x+i, GetVal::y+i);</span></span><br><span class="line"><span class="comment">//    ans = GetVal::lagrange(n);</span></span><br><span class="line"><span class="comment">//    print(ans);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-2-7-任意模数NTT-MTT求逆"><a href="#3-2-7-任意模数NTT-MTT求逆" class="headerlink" title="3.2.7. 任意模数NTT - MTT求逆"></a>3.2.7. 任意模数NTT - MTT求逆</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll,ll&gt; pll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Vec;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">pii <span class="title">exgcd</span><span class="params">(<span class="keyword">const</span> ll x,<span class="keyword">const</span> ll y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!y) <span class="keyword">return</span>&#123;<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    pll c = exgcd(y, x%y);</span><br><span class="line">    <span class="keyword">return</span>&#123;c.second, c.first - (x/y) * c.second&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SZ(o) (int(o.size()))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> FFT</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">double</span> r, i;</span><br><span class="line">        Complex(<span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">double</span> y = <span class="number">0</span>) : r(x), i(y) &#123;&#125;</span><br><span class="line">        Complex <span class="keyword">operator</span>+ (<span class="keyword">const</span> Complex &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Complex(r+b.r, i+b.i);</span><br><span class="line">        &#125;</span><br><span class="line">        Complex <span class="keyword">operator</span>- (<span class="keyword">const</span> Complex &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Complex(r-b.r, i-b.i);</span><br><span class="line">        &#125;</span><br><span class="line">        Complex <span class="keyword">operator</span>* (<span class="keyword">const</span> Complex &amp;b) <span class="keyword">const</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Complex(r*b.r - i*b.i, r*b.i + i*b.r)</span><br><span class="line">        &#125;</span><br><span class="line">        Complex <span class="keyword">operator</span>! () <span class="keyword">const</span> &#123;<span class="keyword">return</span> Complex(r, -i);&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> base = <span class="number">1</span>;</span><br><span class="line">    Vec rev = &#123; <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="built_in">vector</span>&lt;Complex&gt; roots = &#123; &#123; <span class="number">0</span>, <span class="number">0</span> &#125;, &#123; <span class="number">1</span>, <span class="number">0</span> &#125; &#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ensure_base</span><span class="params">(<span class="keyword">int</span> nbase)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nbase &lt;= base) <span class="keyword">return</span>;</span><br><span class="line">        rev.resize(<span class="number">1</span> &lt;&lt; nbase);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; nbase); i++)</span><br><span class="line">            rev[i] = (rev[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>) + ((i&amp;<span class="number">1</span>)&lt;&lt;(nbase<span class="number">-1</span>));</span><br><span class="line">        roots.resize(<span class="number">1</span> &lt;&lt; nbase);</span><br><span class="line">        <span class="keyword">for</span>(; base &lt; nbase; base++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">double</span> angle = <span class="number">2</span> * pi / (<span class="number">1</span> &lt;&lt; (base + <span class="number">1</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span> &lt;&lt; (base - <span class="number">1</span>); i &lt; (<span class="number">1</span> &lt;&lt; base); i++) &#123;</span><br><span class="line">                roots[i &lt;&lt; <span class="number">1</span>] = roots[i];</span><br><span class="line">                <span class="keyword">double</span> angle_i = angle * (<span class="number">2</span> * i + <span class="number">1</span> - (<span class="number">1</span> &lt;&lt; base));</span><br><span class="line">                roots[(i &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>] = Complex(<span class="built_in">cos</span>(angle_i), <span class="built_in">sin</span>(angle_i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(<span class="built_in">vector</span>&lt;Complex&gt; &amp;a, <span class="keyword">int</span> n = <span class="number">-1</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">-1</span>) n = SZ(a);</span><br><span class="line">        <span class="keyword">int</span> zeros = __builtin_ctz(n);</span><br><span class="line">        ensure_base(zeros);</span><br><span class="line">        <span class="keyword">int</span> shift = base - zeros;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">if</span>(i &lt; (rev[i] &gt;&gt; shift)) swap(a[i], a[rev[i] &gt;&gt; shift]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; n; k &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">2</span> * k)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    Complex z = a[i + j + k] * roots[j + k];</span><br><span class="line">                    a[i + j + k] = a[i + j] - z;</span><br><span class="line">                    a[i + j] = a[i + j] + z;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;Complex&gt; fa, fb;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">multiply</span><span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;a, <span class="keyword">const</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> need = SZ(a) + SZ(b) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> nbase = need &gt; <span class="number">1</span> ? <span class="number">32</span> - __builtin_clz(need - <span class="number">1</span>) : <span class="number">0</span>;</span><br><span class="line">        ensure_base(nbase);</span><br><span class="line">        <span class="keyword">int</span> sz = <span class="number">1</span> &lt;&lt; nbase;</span><br><span class="line">        <span class="keyword">if</span> (sz &gt; (<span class="keyword">int</span>) fa.size()) fa.resize(sz);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sz; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = (i &lt; (<span class="keyword">int</span>) a.size() ? a[i] : <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">int</span> y = (i &lt; (<span class="keyword">int</span>) b.size() ? b[i] : <span class="number">0</span>);</span><br><span class="line">            fa[i] = Complex(x, y);</span><br><span class="line">        &#125;</span><br><span class="line">        fft(fa, sz);</span><br><span class="line">        <span class="function">Complex <span class="title">r</span><span class="params">(<span class="number">0</span>, <span class="number">-0.25</span> / sz)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= (sz &gt;&gt; <span class="number">1</span>); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> j = (sz - i) &amp; (sz - <span class="number">1</span>);</span><br><span class="line">            Complex z = (fa[j] * fa[j] - !(fa[i] * fa[i])) * r;</span><br><span class="line">            <span class="keyword">if</span> (i != j) fa[j] = (fa[i] * fa[i] - !(fa[j] * fa[j])) * r;</span><br><span class="line">            fa[i] = z;</span><br><span class="line">        &#125;</span><br><span class="line">        fft(fa, sz);</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">res</span><span class="params">(need)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; need; i++) res[i] = fa[i].r + <span class="number">0.5</span>;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">multiply_mod</span><span class="params">(<span class="keyword">const</span> Vec &amp;a, <span class="keyword">const</span> Vec &amp;b, <span class="keyword">int</span> m, <span class="keyword">int</span> eq = <span class="number">0</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> need = SZ(a) + SZ(b) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> nbase = need &gt; <span class="number">1</span> ? <span class="number">32</span> - __builtin_clz(need - <span class="number">1</span>) : <span class="number">0</span>;</span><br><span class="line">        ensure_base(nbase);</span><br><span class="line">        <span class="keyword">int</span> sz = <span class="number">1</span> &lt;&lt; nbase;</span><br><span class="line">        <span class="keyword">if</span>(sz &gt; SZ(fa)) fa.resize(sz);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SZ(a); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = (a[i] % m + m) % m;</span><br><span class="line">            fa[i] = Complex(x &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">15</span>) - <span class="number">1</span>), x &gt;&gt; <span class="number">15</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        fill(fa.begin() + a.size(), fa.begin() + sz, Complex &#123;<span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">        fft(fa, sz);</span><br><span class="line">        <span class="keyword">if</span>(sz &gt; SZ(fb)) fb.resize(sz);</span><br><span class="line">        <span class="keyword">if</span>(eq) copy(fa.begin(), fa.begin() + sz, fb.begin());</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SZ(b); i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> x = (b[i] % m + m) % m;</span><br><span class="line">                fb[i] = Complex(x &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">15</span>) - <span class="number">1</span>), x &gt;&gt; <span class="number">15</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            fill(fb.begin() + b.size(), fb.begin() + sz, Complex &#123;<span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">            fft(fb, sz);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">double</span> ratio = <span class="number">0.25</span> / sz;</span><br><span class="line">        Complex r2(0, -1), r3(ratio, 0), r4(0, -ratio), r5(0, 1);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= (sz &gt;&gt; <span class="number">1</span>); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> j = (sz - i) &amp; (sz - <span class="number">1</span>);</span><br><span class="line">            Complex a1 = (fa[i] + !fa[j]), a2 = (fa[i] - !fa[j]) * r2;</span><br><span class="line">            Complex b1 = (fb[i] + !fb[j])*r3, b2 = (fb[i] - !fb[j])*r4;</span><br><span class="line">            <span class="keyword">if</span>(i != j)</span><br><span class="line">            &#123;</span><br><span class="line">                Complex c1 = (fa[j] + !fa[i]), c2 = (fa[j] - !fa[i]) * r2;</span><br><span class="line">                Complex d1 = (fb[j] + !fb[i])*r3, d2 = (fb[j] - !fb[i])*r4;</span><br><span class="line">                fa[i] = c1 * d1 + c2 * d2 * r5;</span><br><span class="line">                fb[i] = c1 * d2 + c2 * d1;</span><br><span class="line">            &#125;</span><br><span class="line">            fa[j] = a1 * b1 + a2 * b2 * r5;</span><br><span class="line">            fb[j] = a1 * b2 + a2 * b1;</span><br><span class="line">        &#125;</span><br><span class="line">        fft(fa, sz); fft(fb, sz);</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">res</span><span class="params">(need)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; need; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ll aa = fa[i].r + <span class="number">0.5</span>, bb = fb[i].r + <span class="number">0.5</span>, cc = fa[i].i + <span class="number">0.5</span>;</span><br><span class="line">            res[i] = (aa + ((bb % m) &lt;&lt; <span class="number">15</span>) + ((cc % m) &lt;&lt; <span class="number">30</span>)) % m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Vec <span class="title">getInv</span><span class="params">(<span class="keyword">const</span> Vec &amp;a)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">    	<span class="keyword">if</span>(SZ(a) == <span class="number">1</span>)</span><br><span class="line">    	&#123;</span><br><span class="line">        	<span class="keyword">const</span> <span class="keyword">int</span> inv = exgcd(a[<span class="number">0</span>], MOD).first;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">1</span>, inv &lt; <span class="number">0</span> ? inv + MOD : inv);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">const</span> <span class="keyword">int</span> n = SZ(a), sb = (n + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    	Vec b; b.assign(a.begin(), a.begin() + sb);</span><br><span class="line">    	b = getInv(b);</span><br><span class="line">    	Vec c = FFT::multiply_mod(b, b, MOD);</span><br><span class="line">    	c.resize(n);</span><br><span class="line">    	c = FFT::multiply_mod(a, c, MOD);</span><br><span class="line">    	b.resize(n); c.resize(n);</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) c[i] = (<span class="number">2l</span>l * b[i] - c[i] + MOD) % MOD;</span><br><span class="line">    	<span class="keyword">return</span> c;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> Poly</span><br><span class="line">&#123;</span><br><span class="line">    Vec <span class="keyword">operator</span> * (Vec a, Vec b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a == b) <span class="keyword">return</span> FFT::multiply_mod(a, b, MOD, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> FFT::multiply_mod(a, b, MOD);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">	Vec operator * (Vec a, Vec b)</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">    	return FFT::multiply(a, b);</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">    Vec <span class="keyword">operator</span> ~ (Vec a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> FFT::getInv(a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(Vec v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sz = SZ(v);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sz - <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, v[i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, v[sz<span class="number">-1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Poly;</span><br><span class="line"></span><br><span class="line">Vec a, b, ans;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    Vec a(n), v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> &amp;x: a) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">    v = ~a; print(v);</span><br><span class="line"><span class="comment">//    int n, m; scanf("%d%d%d", &amp;n, &amp;m, &amp;MOD);</span></span><br><span class="line"><span class="comment">//    for(int i = 0, j; i &lt;= n; i++) &#123;scanf("%d", &amp;j); a.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    for(int i = 0, j; i &lt;= m; i++) &#123;scanf("%d", &amp;j); b.push_back(j);&#125;</span></span><br><span class="line"><span class="comment">//    ans = a * b; print(ans);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-3-高精度模版"><a href="#3-3-高精度模版" class="headerlink" title="3.3. 高精度模版"></a>3.3. 高精度模版</h2><h3 id="3-3-1-普通高精乘"><a href="#3-3-1-普通高精乘" class="headerlink" title="3.3.1. 普通高精乘"></a>3.3.1. 普通高精乘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">int</span> m;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*------以下为重载部分------*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HP</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> len,zheng;<span class="comment">//len：长度 zheng：正负标记0为负1为正</span></span><br><span class="line">    LL v[<span class="number">50010</span>];</span><br><span class="line">    HP()&#123;len=<span class="number">0</span>; <span class="built_in">memset</span>(v,<span class="number">0</span>,<span class="keyword">sizeof</span>(v));zheng=<span class="number">1</span>;&#125;</span><br><span class="line">    HP(<span class="keyword">long</span> <span class="keyword">long</span> x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(x &gt;= <span class="number">0</span>) zheng = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;x = -x; zheng = <span class="number">0</span>;&#125;</span><br><span class="line">        len = <span class="number">0</span>; <span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</span><br><span class="line">        <span class="keyword">while</span>(x)</span><br><span class="line">        &#123;</span><br><span class="line">            v[++len]=x%<span class="number">10</span>;</span><br><span class="line">            x/=<span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    HP <span class="keyword">operator</span> * (LL x) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        HP c;</span><br><span class="line">        c.len = len;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++) c.v[i] = v[i] * x;</span><br><span class="line">        <span class="keyword">while</span>(x) &#123;c.len++; x /= <span class="number">10</span>;&#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= c.len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            c.v[i + <span class="number">1</span>] += c.v[i] / <span class="number">10</span>;</span><br><span class="line">            c.v[i] %= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!c.v[c.len]) c.len--;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">HP <span class="keyword">operator</span> *(HP a, HP b)</span><br><span class="line">&#123;</span><br><span class="line">    HP c; c.len = a.len + b.len;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= c.len; i++) c.v[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= a.len; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= b.len; j++) c.v[i+j<span class="number">-1</span>] += a.v[i] * b.v[j];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; c.len; i++) &#123; c.v[i+<span class="number">1</span>] += c.v[i]/<span class="number">10</span>; c.v[i] %= <span class="number">10</span>; &#125;</span><br><span class="line">    <span class="keyword">while</span>(!c.v[c.len] &amp;&amp; c.len &gt; <span class="number">1</span>) c.len--;</span><br><span class="line">    <span class="keyword">if</span>(a.zheng != b.zheng) c.zheng = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> c.zheng = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line">istream&amp; <span class="keyword">operator</span> &gt;&gt; (istream &amp;in, HP &amp;a)<span class="comment">//方便使用cin</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">char</span> lin[<span class="number">50010</span>]; <span class="keyword">int</span> len;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, lin+<span class="number">1</span>);</span><br><span class="line">    len = a.len = (<span class="keyword">int</span>)<span class="built_in">strlen</span>(lin+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(lin[<span class="number">1</span>] == <span class="string">'-'</span>) &#123;a.zheng=<span class="number">0</span>; a.len--;&#125;</span><br><span class="line">    <span class="keyword">else</span> a.zheng = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= a.len; i++) a.v[i] = lin[len-i+<span class="number">1</span>] - <span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">return</span> in;</span><br><span class="line">&#125;</span><br><span class="line">ostream&amp; <span class="keyword">operator</span> &lt;&lt; (ostream &amp;out, <span class="keyword">const</span> HP &amp;a)<span class="comment">//方便使用cout</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!a.len)<span class="comment">//一定要注意答案是0得情况</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"0"</span>;</span><br><span class="line">        <span class="keyword">return</span> out;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!a.zheng) <span class="built_in">cout</span> &lt;&lt; <span class="string">"-"</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = a.len ; i &gt;= <span class="number">1</span>; i--) <span class="built_in">printf</span>(<span class="string">"%lld"</span>,a.v[i]);</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*------以上为重载部分------*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 加减部分和下面的“全家桶”一样</span></span><br><span class="line"></span><br><span class="line">HP a, b, c;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    c = a * b; <span class="built_in">cout</span> &lt;&lt; c &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-2-FFT高精度全家桶"><a href="#3-3-2-FFT高精度全家桶" class="headerlink" title="3.3.2. FFT高精度全家桶"></a>3.3.2. FFT高精度全家桶</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXLEN = <span class="number">2e6</span> + <span class="number">1e5</span>;</span><br><span class="line"><span class="keyword">int</span> m;</span><br><span class="line"><span class="comment">//const long long mod = 40961, G = 3, Ginv = (mod+1)/3;</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> mod = <span class="number">998244353</span>, G = <span class="number">3</span>, Ginv = (mod+<span class="number">1</span>)/<span class="number">3</span>;</span><br><span class="line"><span class="keyword">int</span> r[MAXLEN];</span><br><span class="line"><span class="function">LL <span class="title">ksm</span><span class="params">(LL a,LL b,LL mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = a * a % mod) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ans = ans * a % mod;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(<span class="keyword">int</span> limit, LL *l, <span class="keyword">int</span> opt)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; limit; i++)</span><br><span class="line">    <span class="keyword">if</span>(i &lt; r[i]) swap(l[i], l[r[i]]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; limit; mid &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LL wn, len = mid&lt;&lt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(opt == <span class="number">1</span>) wn = ksm(G, (mod<span class="number">-1</span>)/len, mod);</span><br><span class="line">        <span class="keyword">else</span> wn = ksm(Ginv, (mod<span class="number">-1</span>)/len, mod);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; limit; j += len)</span><br><span class="line">        &#123;</span><br><span class="line">            LL w = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = j; k &lt; mid+j; k++, (w *= wn) %= mod)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">int</span> x = (<span class="keyword">int</span>)l[k] , y = w * l[k+mid] % mod;</span><br><span class="line">                l[k] = (x+y) % mod;</span><br><span class="line">                l[k+mid] = (x - y + mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(opt == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LL inv = ksm(limit, mod<span class="number">-2</span>, mod);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= limit; i++) l[i] = l[i] * inv % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*------以下为重载部分------*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HP</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> len,zheng;<span class="comment">//len：长度 zheng：正负标记0为负1为正</span></span><br><span class="line">    LL v[MAXLEN];</span><br><span class="line">    HP()&#123;len=<span class="number">0</span>; <span class="built_in">memset</span>(v,<span class="number">0</span>,<span class="keyword">sizeof</span>(v));zheng=<span class="number">1</span>;&#125;</span><br><span class="line">    HP(<span class="keyword">long</span> <span class="keyword">long</span> x)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(x &gt;= <span class="number">0</span>) zheng = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;x = -x; zheng = <span class="number">0</span>;&#125;</span><br><span class="line">        len = <span class="number">0</span>; <span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</span><br><span class="line">        <span class="keyword">while</span>(x)</span><br><span class="line">        &#123;</span><br><span class="line">            v[++len]=x%<span class="number">10</span>;</span><br><span class="line">            x/=<span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> HP &amp;b) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(len != b.len) <span class="keyword">return</span> len &lt; b.len;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = len; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(v[i] != b.v[i]) <span class="keyword">return</span> v[i] &lt; b.v[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> HP &amp;b) <span class="keyword">const</span><span class="comment">//正数</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(len != b.len) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = len; i &gt;= <span class="number">1</span>; --i) <span class="keyword">if</span>(v[i] != b.v[i]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;= (<span class="keyword">const</span> HP &amp;b) <span class="keyword">const</span><span class="comment">//正数</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(*<span class="keyword">this</span> &lt; b || *<span class="keyword">this</span> == b) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    HP <span class="keyword">operator</span> * (LL x) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        HP c;</span><br><span class="line">        c.len = len;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++) c.v[i] = v[i] * x;</span><br><span class="line">        <span class="keyword">while</span>(x) &#123;c.len++; x /= <span class="number">10</span>;&#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= c.len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            c.v[i + <span class="number">1</span>] += c.v[i] / <span class="number">10</span>;</span><br><span class="line">            c.v[i] %= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!c.v[c.len]) c.len--;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">ostream&amp; <span class="keyword">operator</span> &lt;&lt; (ostream &amp;out, <span class="keyword">const</span> HP &amp;a);</span><br><span class="line">istream&amp; <span class="keyword">operator</span> &gt;&gt; (istream &amp;in, HP &amp;a);</span><br><span class="line">HP <span class="keyword">operator</span> - (HP a, HP b);</span><br><span class="line">HP <span class="keyword">operator</span> + (HP a, HP b);</span><br><span class="line">HP <span class="keyword">operator</span> * (HP a, HP b);</span><br><span class="line"></span><br><span class="line">HP <span class="keyword">operator</span> + (HP a, HP b)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!a.zheng &amp;&amp; !b.zheng) &#123;</span><br><span class="line">        a.zheng = b.zheng=<span class="number">1</span>; HP c = a + b; c.zheng = <span class="number">0</span>; <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!a.zheng &amp;&amp; b.zheng) &#123;a.zheng = b.zheng=<span class="number">1</span>; <span class="keyword">return</span> b - a;&#125;</span><br><span class="line">    <span class="keyword">if</span>(a.zheng &amp;&amp; !b.zheng) &#123;a.zheng = b.zheng=<span class="number">1</span>; <span class="keyword">return</span> a - b;&#125;</span><br><span class="line">    <span class="keyword">int</span> len = max(a.len, b.len) + <span class="number">1</span>;</span><br><span class="line">    HP c; c.len = len;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++) c.v[i] = a.v[i] + b.v[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(c.v[i] &gt;= <span class="number">10</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            c.v[i+<span class="number">1</span>]++;</span><br><span class="line">            c.v[i] -= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(c.len &amp;&amp; !c.v[c.len]) c.len--;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line">HP <span class="keyword">operator</span> - (HP a,HP b)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!a.zheng &amp;&amp; !b.zheng) &#123;a.zheng = b.zheng = <span class="number">1</span>; <span class="keyword">return</span> b - a;&#125;</span><br><span class="line">    <span class="keyword">if</span>(!a.zheng &amp;&amp; b.zheng) &#123; </span><br><span class="line">        a.zheng = <span class="number">1</span>; HP c = a + b; c.zheng = <span class="number">0</span>; <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(a.zheng &amp;&amp; !b.zheng) &#123;b.zheng = <span class="number">1</span>; HP c = a + b; <span class="keyword">return</span> c;&#125;</span><br><span class="line">    <span class="keyword">if</span>(a.zheng &amp;&amp; b.zheng &amp;&amp; a &lt; b) &#123; HP c = b-a; c.zheng=<span class="number">0</span>; <span class="keyword">return</span> c;&#125;</span><br><span class="line">    <span class="keyword">int</span> len = max(a.len, b.len);</span><br><span class="line">    HP c; c.len = len;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++) c.v[i] = a.v[i] - b.v[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= c.len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(c.v[i] &lt; <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            c.v[i+<span class="number">1</span>]--;</span><br><span class="line">            c.v[i] += <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(c.len &amp;&amp; !c.v[c.len]) c.len--;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line">HP <span class="keyword">operator</span> *(HP a, HP b)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> limit = <span class="number">1</span>, l = <span class="number">0</span>;</span><br><span class="line">    HP c;</span><br><span class="line">    a.len--; b.len--;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= a.len; i++) a.v[i] = a.v[i+<span class="number">1</span>]; a.v[a.len+<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= b.len; i++) b.v[i] = b.v[i+<span class="number">1</span>]; b.v[b.len+<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(limit &lt;= a.len + b.len) &#123;limit &lt;&lt;= <span class="number">1</span>; l++;&#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= limit; i++) </span><br><span class="line">        r[i] = (r[i&gt;&gt;<span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i&amp;<span class="number">1</span>) &lt;&lt; (l<span class="number">-1</span>));</span><br><span class="line">    NTT(limit, a.v, <span class="number">1</span>); NTT(limit, b.v, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= limit; i++) a.v[i] = a.v[i] * b.v[i] % mod;</span><br><span class="line">    NTT(limit, a.v, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= limit; i++) c.v[i] = a.v[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= limit; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(c.v[i] &gt;= <span class="number">10</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            c.v[i+<span class="number">1</span>] += c.v[i] / <span class="number">10</span>;</span><br><span class="line">            c.v[i] %= <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">if</span>(i+<span class="number">1</span> &gt; limit) limit++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = limit; i &gt;= <span class="number">0</span>; i--) <span class="keyword">if</span>(c.v[i] == <span class="number">0</span>) limit--; <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">    c.len = limit+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = c.len; i &gt;= <span class="number">1</span>; i--) c.v[i] = c.v[i<span class="number">-1</span>]; c.v[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= c.len; i++) swap(c.v[i], c.v[c.len-i+<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span>(a.zheng != b.zheng) c.zheng=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> c.zheng = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HP <span class="keyword">operator</span> / (HP a,<span class="keyword">long</span> <span class="keyword">long</span> b)</span><br><span class="line">&#123;</span><br><span class="line">    HP c; <span class="keyword">int</span> d=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = a.len; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        c.v[++c.len] = (d * <span class="number">10</span> + a.v[i]) / b;</span><br><span class="line">        d = (<span class="keyword">int</span>)(d * <span class="number">10</span> + a.v[i]) % b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= c.len/<span class="number">2</span>; i++) swap(c.v[i], c.v[c.len-i+<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span>(!a.len || !b || (a.zheng &amp;&amp; b&gt;<span class="number">0</span>) || (!a.zheng &amp;&amp; b&lt;<span class="number">0</span>)) c.zheng = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> c.zheng = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(c.v[c.len] == <span class="number">0</span> &amp;&amp; c.len &gt; <span class="number">1</span>) c.len--;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line">HP <span class="keyword">operator</span> % (HP a,<span class="keyword">long</span> <span class="keyword">long</span> b)</span><br><span class="line">&#123;</span><br><span class="line">    HP c;</span><br><span class="line">    c=a-a/b*HP(b);</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line">HP <span class="keyword">operator</span> / (<span class="keyword">const</span> HP &amp;a, <span class="keyword">const</span> HP &amp;b)</span><br><span class="line">&#123;</span><br><span class="line">    int i, j; HP d(0),c;</span><br><span class="line">    <span class="keyword">for</span>(i=a.len;i&gt;<span class="number">0</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!(d.len==<span class="number">1</span> &amp;&amp; d.v[<span class="number">1</span>]==<span class="number">0</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=d.len;j&gt;<span class="number">0</span>;j--) d.v[j+<span class="number">1</span>]=d.v[j];</span><br><span class="line">            ++d.len;</span><br><span class="line">        &#125;</span><br><span class="line">        d.v[<span class="number">1</span>]=a.v[i];c.v[i]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(b &lt;= d)</span><br><span class="line">        &#123;</span><br><span class="line">            d=d-b;</span><br><span class="line">            c.v[i]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    c.len=a.len;</span><br><span class="line">    <span class="keyword">while</span>((c.len&gt;<span class="number">1</span>)&amp;&amp;(c.v[c.len]==<span class="number">0</span>)) c.len--;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br><span class="line">HP <span class="keyword">operator</span> % (<span class="keyword">const</span> HP &amp;a, <span class="keyword">const</span> HP &amp;b)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j; <span class="function">HP <span class="title">d</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(i = a.len; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!(d.len==<span class="number">1</span>&amp;&amp;d.v[<span class="number">1</span>]==<span class="number">0</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=d.len;j&gt;<span class="number">0</span>;j--) d.v[j+<span class="number">1</span>]=d.v[j];</span><br><span class="line">            ++d.len;</span><br><span class="line">        &#125;</span><br><span class="line">        d.v[<span class="number">1</span>] = a.v[i];</span><br><span class="line">        <span class="keyword">while</span>(b &lt;= d) d = d - b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line">istream&amp; <span class="keyword">operator</span> &gt;&gt; (istream &amp;in, HP &amp;a)<span class="comment">//方便使用cin</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">char</span> lin[MAXLEN]; <span class="keyword">int</span> len;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, lin+<span class="number">1</span>);</span><br><span class="line">    len = a.len = (<span class="keyword">int</span>)<span class="built_in">strlen</span>(lin+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(lin[<span class="number">1</span>] == <span class="string">'-'</span>) &#123;a.zheng=<span class="number">0</span>; a.len--;&#125;</span><br><span class="line">    <span class="keyword">else</span> a.zheng = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= a.len; i++) a.v[i] = lin[len-i+<span class="number">1</span>] - <span class="string">'0'</span>;</span><br><span class="line">    <span class="keyword">return</span> in;</span><br><span class="line">&#125;</span><br><span class="line">ostream&amp; <span class="keyword">operator</span> &lt;&lt; (ostream &amp;out, <span class="keyword">const</span> HP &amp;a)<span class="comment">//方便使用cout</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!a.len)<span class="comment">//一定要注意答案是0得情况</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"0"</span>;</span><br><span class="line">        <span class="keyword">return</span> out;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!a.zheng)<span class="built_in">cout</span>&lt;&lt;<span class="string">"-"</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = a.len ; i &gt;= <span class="number">1</span>; i--) <span class="built_in">printf</span>(<span class="string">"%lld"</span>,a.v[i]);</span><br><span class="line">    <span class="keyword">return</span> out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*------以上为重载部分------*/</span></span><br><span class="line"><span class="function">HP <span class="title">ksm</span><span class="params">(HP a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    HP ans=HP(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>,a=a*a)</span><br><span class="line">    <span class="keyword">if</span>(b&amp;<span class="number">1</span>)ans=ans*a;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">HP <span class="title">Max</span><span class="params">(HP a,HP b)</span> <span class="comment">// yych</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a.zheng==<span class="number">1</span>&amp;&amp;b.zheng==<span class="number">0</span>) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(a.zheng==<span class="number">0</span>&amp;&amp;b.zheng==<span class="number">1</span>) <span class="keyword">return</span> b;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a.zheng==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(a&lt;b) <span class="keyword">return</span> b;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> a;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(a&lt;b) <span class="keyword">return</span> a;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">HP <span class="title">Min</span><span class="params">(HP a,HP b)</span> <span class="comment">//yych</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a.zheng==<span class="number">1</span>&amp;&amp;b.zheng==<span class="number">0</span>) <span class="keyword">return</span> b;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(a.zheng==<span class="number">0</span>&amp;&amp;b.zheng==<span class="number">1</span>) <span class="keyword">return</span> a;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a.zheng==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(a&lt;b) <span class="keyword">return</span> a;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> b;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(a&lt;b) <span class="keyword">return</span> b;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">HP a, b, c;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    c = a + b; <span class="built_in">cout</span> &lt;&lt; c &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    c = a - b; <span class="built_in">cout</span> &lt;&lt; c &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    c = a * b; <span class="built_in">cout</span> &lt;&lt; c &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    c = a / b; <span class="built_in">cout</span> &lt;&lt; c &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    c = a % b; <span class="built_in">cout</span> &lt;&lt; c &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-4-整数的拆分问题"><a href="#3-4-整数的拆分问题" class="headerlink" title="3.4. 整数的拆分问题"></a>3.4. 整数的拆分问题</h2><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4651" target="_blank" rel="noopener">hdu4651 Partition</a></p>
<h3 id="3-4-1-前置芝士：五边形数"><a href="#3-4-1-前置芝士：五边形数" class="headerlink" title="3.4.1. 前置芝士：五边形数"></a>3.4.1. 前置芝士：五边形数</h3><p>五边形数$f(n)=\frac{n(3n-1)}{2}$：$1,5,12,22,35,51,70,…$</p>
<p>广义五边形数：$f(0),f(1),f(-1),f(2),f(-2),…$：即$0,1,2,5,7,12,…$</p>
<p>定义欧拉函数：<br>$$<br>\varphi(x)=\prod_{n=1}^{\infty}(1-x^n)<br>$$<br>五边形数定理：<br>$$<br>\begin{aligned}<br>\varphi(x)&amp;=(1-x)(1-x^2)(1-x^3)…\cr<br>&amp;=1-x-x^2+x^5+x^7-x^{12}-x^{15}+x^{22}+x^{26}-…<br>\end{aligned}<br>$$<br>展开后留下来的次方项恰为广义五边形数，且由奇数生成的五边形数次方项系数为-1、偶数生成的次方项系数为1.</p>
<p>考虑整数拆分的生成函数：<br>$$<br>\prod_{i=1}^{\infty}\left(\sum_{j=0}^{\infty}x^{ij}\right)=\frac{1}{\varphi(x)}<br>$$</p>
<p>$$<br>(1-x-x^2+x^5+x^7-x^{12}-x^{15}+…)(1+p_1x+p_2x^2+p_3x^3+\cdots)=1<br>$$</p>
<p>$$<br>p_n=p_{n-1}+p_{n-2}-p_{n-5}-p_{n-7}+p_{n-12}+\cdots<br>$$</p>
<h3 id="3-4-2-利用多项式求逆"><a href="#3-4-2-利用多项式求逆" class="headerlink" title="3.4.2. 利用多项式求逆"></a>3.4.2. 利用多项式求逆</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 多项式求逆模版见前面</span></span><br><span class="line"><span class="comment">// 直接递推出广义五边形数再对其生成函数求逆</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; ; i &gt; <span class="number">0</span> ? i = -i : i = -(--i))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> now = i * (<span class="number">3</span> * i - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(now &gt; n) <span class="keyword">break</span>;</span><br><span class="line">        f[++tot] = now;</span><br><span class="line">    &#125;</span><br><span class="line">    a.resize(n+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= tot; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i % <span class="number">4</span> == <span class="number">1</span> || i % <span class="number">4</span> == <span class="number">2</span>) a[f[i]] = Mo - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> a[f[i]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    a = ~a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n); init();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-3-dp预处理五边形数"><a href="#3-4-3-dp预处理五边形数" class="headerlink" title="3.4.3. dp预处理五边形数"></a>3.4.3. dp预处理五边形数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans[MAXN], tmp[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t = <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">-1000</span>; i &lt;= <span class="number">1000</span>; i++) tmp[i+t] = i * (<span class="number">3</span>*i<span class="number">-1</span>) / <span class="number">2</span>;</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(tmp[j+t] &lt;= i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(j&amp;<span class="number">1</span>) ans[i] += ans[i-tmp[j+t]];</span><br><span class="line">                <span class="keyword">else</span> ans[i] -= ans[i-tmp[j+t]];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(tmp[t-j] &lt;= i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(j&amp;<span class="number">1</span>) ans[i] += ans[i-tmp[t-j]];</span><br><span class="line">                <span class="keyword">else</span> ans[i] -= ans[i-tmp[t-j]];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ans[i] = (ans[i] % MOD + MOD) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n); init();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-4-变式-每个数不能大于等于k次"><a href="#3-4-4-变式-每个数不能大于等于k次" class="headerlink" title="3.4.4. 变式-每个数不能大于等于k次"></a>3.4.4. 变式-每个数不能大于等于k次</h3><p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4658" target="_blank" rel="noopener">hdu4658</a></p>
<p>$$<br>\begin{aligned}<br>F(x)&amp;=\prod_{i=1}^{\infty}\left(\sum_{j=0}^{k-1}x^{ij}\right)\cr<br>&amp;=\prod_{i=1}^{\infty}\left(\frac{1-x^{ik}}{1-x^i}\right)\cr<br>&amp;=\frac{\varphi(x^k)}{\varphi(x)}=\varphi(x^k)P(x)\cr<br>\end{aligned}<br>$$</p>
<p>$$<br>\varphi(x^k)=1-x^k-x^{2k}+x^{5k}+x^{7k}-x^{12k}-x^{15k}+\cdots<br>$$</p>
<p>$$<br>\therefore F(x)=(1-x^k-x^{2k}+x^{5k}+x^{7k}-x^{12k}-x^{15k}+…)(p_0+p_1x+p_2x^2+p_3x^3+\cdots)<br>$$</p>
<p>$$<br>F_n=p_n-p_{n-k}-p_{n-2k}+p_{n-5k}+\cdots<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1e5</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> T, n, k;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans[MAXN], tmp[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t = <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">-1000</span>; i &lt;= <span class="number">1000</span>; i++) tmp[i+t] = i * (<span class="number">3</span> * i - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    ans[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(tmp[j+t] &lt;= i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(j&amp;<span class="number">1</span>) ans[i] += ans[i-tmp[j+t]];</span><br><span class="line">                <span class="keyword">else</span> ans[i] -= ans[i-tmp[j+t]];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">if</span>(tmp[t-j] &lt;= i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(j&amp;<span class="number">1</span>) ans[i] += ans[i-tmp[t-j]];</span><br><span class="line">                <span class="keyword">else</span> ans[i] -= ans[i-tmp[t-j]];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ans[i] = (ans[i] % MOD + MOD) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = ans[n];</span><br><span class="line">    <span class="keyword">int</span> t = <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; ; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k*tmp[j+t] &lt;= n)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(j&amp;<span class="number">1</span>) ret -= ans[n-k*tmp[j+t]];</span><br><span class="line">            <span class="keyword">else</span> ret += ans[n-k*tmp[j+t]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span>(k*tmp[t-j] &lt;= n)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(j&amp;<span class="number">1</span>) ret -= ans[n-k*tmp[t-j]];</span><br><span class="line">            <span class="keyword">else</span> ret += ans[n-k*tmp[t-j]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ((ret % MOD) + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, solve(n, k));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-5-生成函数"><a href="#3-5-生成函数" class="headerlink" title="3.5. 生成函数"></a>3.5. 生成函数</h2><h3 id="3-5-1-背包问题与生成函数"><a href="#3-5-1-背包问题与生成函数" class="headerlink" title="3.5.1. 背包问题与生成函数"></a>3.5.1. 背包问题与生成函数</h3><p><a href="https://www.luogu.com.cn/problem/SP8372" target="_blank" rel="noopener">SP8372 Triple Sums</a></p>
<p>题目大意：$N$个整数$A_1,A_2,\dots,A_N$,对所有的$S$，求满足$A_i+A_j+A_k = S$且$i &lt; j &lt; k$的$(i,j,k)$对数. $N \le 40000, |A_i| \le 20000$</p>
<p>思路：先考虑去掉$i &lt; j &lt; k$的限制，则构造生成函数 $A(x)=\sum a_i\cdot x^{a_i}$ 。考虑到$a_i$中存在负数，我们先把所有的 $a_i$ 加上 $20000$，最后的答案就是 $A^3(x)$ 系数非 $0$ 次项减去 $60000$。再考虑容斥定理：对于每种选择，重复两个的情况有 $3$ 种：$12$重，$13$重，$23$重，重复三个的情况有 $1$ 种。而每个重复两个的情况，均包含了一次重复三个的情况。构造生成函数 $B(x)=\sum 2a_i\cdot x^{2a_i}$ ，$C(x)=\sum 3a_i\cdot x^{3a_i}$ ，则重复两个情况的方案生成函数：$A(x)\cdot B(x)$ ，重复三个情况的方案生成函数：$C(x)$ 。由于存在顺序问题，应当再除以一个 $3$ 的全排列：<br>$$<br>\therefore ans=\frac{A^3(x)-3A(x)\cdot B(x)+2C(x)}{6}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 省略FFT模版</span></span><br><span class="line"><span class="comment">// 注意答案涉及到long long范围，不可用NTT！</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXX = <span class="number">4e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> v[MAXX];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) v[i] += <span class="number">20000</span>;</span><br><span class="line">    sort(v+<span class="number">1</span>, v+<span class="number">1</span>+n);</span><br><span class="line">    <span class="keyword">int</span> M = v[n];</span><br><span class="line">    a.resize(M+<span class="number">1</span>); b.resize(<span class="number">2</span>*M+<span class="number">1</span>); c.resize(<span class="number">3</span>*M+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a[v[i]]++; b[<span class="number">2</span>*v[i]]++;</span><br><span class="line">        c[<span class="number">3</span>*v[i]]++;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = (a * a * a - a * b * <span class="number">3</span> + c * <span class="number">2</span>) / <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> sz = (<span class="keyword">int</span>)ans.size(), i = <span class="number">0</span>; i &lt; sz; i++)</span><br><span class="line">        <span class="keyword">if</span>(ans[i]) <span class="built_in">printf</span>(<span class="string">"%d : %lld\n"</span>, i - <span class="number">60000</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<div style="page-break-after: always; break-after: page;"></div>

<h1 id="4-黑科技"><a href="#4-黑科技" class="headerlink" title="4. 黑科技"></a>4. 黑科技</h1><h2 id="4-1-读入优化"><a href="#4-1-读入优化" class="headerlink" title="4.1. 读入优化"></a>4.1. 读入优化</h2><h3 id="4-1-1-快速度入挂"><a href="#4-1-1-快速度入挂" class="headerlink" title="4.1.1. 快速度入挂"></a>4.1.1. 快速度入挂</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> f = <span class="number">1</span>, x = <span class="number">0</span>; <span class="keyword">char</span> ch = getchar();</span><br><span class="line">    <span class="keyword">while</span>(ch &gt; <span class="string">'9'</span> || ch &lt; <span class="string">'0'</span>) &#123;<span class="keyword">if</span>(ch == <span class="string">'-'</span>) f = <span class="number">-1</span>; ch = getchar();&#125;</span><br><span class="line">    <span class="keyword">while</span>(ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) &#123;x = (x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="number">48</span>); ch = getchar();&#125;</span><br><span class="line">    <span class="keyword">return</span> f * x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-1-2-大整数取模"><a href="#4-1-2-大整数取模" class="headerlink" title="4.1.2. 大整数取模"></a>4.1.2. 大整数取模</h3><h4 id="4-1-2-1-读入时取模"><a href="#4-1-2-1-读入时取模" class="headerlink" title="4.1.2.1. 读入时取模"></a>4.1.2.1. 读入时取模</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getmod</span><span class="params">(<span class="keyword">int</span> mo)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">0</span>; <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isdigit</span>(c = getchar()));</span><br><span class="line">    <span class="keyword">for</span>(; <span class="built_in">isdigit</span>(c); c = getchar())</span><br><span class="line">    &#123;</span><br><span class="line">        b = b * <span class="number">10</span> + c - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span>(b &gt;= mo) b %= mo;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-1-2-2-读入后取模"><a href="#4-1-2-2-读入后取模" class="headerlink" title="4.1.2.2. 读入后取模"></a>4.1.2.2. 读入后取模</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">Int</span><span class="params">(ll p, <span class="keyword">char</span> *ch)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> pos = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch[pos])) pos++;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch[pos]))</span><br><span class="line">    &#123;</span><br><span class="line">       res = (res * <span class="number">10</span> + ch[pos] - <span class="string">'0'</span>) % p;</span><br><span class="line">        pos++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-2-STL的神奇应用"><a href="#4-2-STL的神奇应用" class="headerlink" title="4.2. STL的神奇应用"></a>4.2. STL的神奇应用</h2><h3 id="4-2-1-哈希表"><a href="#4-2-1-哈希表" class="headerlink" title="4.2.1. 哈希表"></a>4.2.1. 哈希表</h3><h4 id="4-2-1-1-手写哈希表"><a href="#4-2-1-1-手写哈希表" class="headerlink" title="4.2.1.1. 手写哈希表"></a>4.2.1.1. 手写哈希表</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用法和 unorder_map 一样（除了 tb[k]=p 改成 tb.add(k,p)）</span></span><br><span class="line"><span class="comment">// 支持 a = tb[tmp] 的用法</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HASHMOD 233333</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> HASHSIZE 1000000</span></span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> head[HASHMOD];</span><br><span class="line">    <span class="keyword">int</span> key[HASHSIZE + <span class="number">10</span>], val[HASHSIZE + <span class="number">10</span>], nxt[HASHSIZE + <span class="number">10</span>], cnt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(head, <span class="number">0</span>, <span class="keyword">sizeof</span>(head));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">count</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> k)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = head[k % HASHMOD]; i; i = nxt[i])</span><br><span class="line">            <span class="keyword">if</span> (key[i] == k) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> <span class="keyword">operator</span>[](<span class="keyword">const</span> <span class="keyword">int</span> k) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = head[k % HASHMOD]; i; i = nxt[i])</span><br><span class="line">            <span class="keyword">if</span> (key[i] == k) <span class="keyword">return</span> val[i];</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p = k % HASHMOD;</span><br><span class="line">        nxt[++cnt] = head[p];</span><br><span class="line">        key[cnt] = k;</span><br><span class="line">        val[cnt] = v;</span><br><span class="line">        head[p] = cnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;tb;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-1-2-unordered-map哈希函数加速"><a href="#4-2-1-2-unordered-map哈希函数加速" class="headerlink" title="4.2.1.2. unordered-map哈希函数加速"></a>4.2.1.2. unordered-map哈希函数加速</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">custom_hash</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">uint64_t</span> <span class="title">splitmix64</span><span class="params">(<span class="keyword">uint64_t</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// http://xorshift.di.unimi.it/splitmix64.c</span></span><br><span class="line">        x += <span class="number">0x9e3779b97f4a7c15</span>;</span><br><span class="line">        x = (x ^ (x &gt;&gt; <span class="number">30</span>)) * <span class="number">0xbf58476d1ce4e5b9</span>;</span><br><span class="line">        x = (x ^ (x &gt;&gt; <span class="number">27</span>)) * <span class="number">0x94d049bb133111eb</span>;</span><br><span class="line">        <span class="keyword">return</span> x ^ (x &gt;&gt; <span class="number">31</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">size_t</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">uint64_t</span> x)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">uint64_t</span> FIXED_RANDOM = </span><br><span class="line">            chrono::steady_clock::now().time_since_epoch().count();</span><br><span class="line">        <span class="keyword">return</span> splitmix64(x + FIXED_RANDOM);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/*    </span></span><br><span class="line"><span class="comment">    这样写实测差别不大</span></span><br><span class="line"><span class="comment">    size_t operator()(uint64_t x) const</span></span><br><span class="line"><span class="comment">    &#123;</span></span><br><span class="line"><span class="comment">        return splitmix64(x);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">*/</span>    </span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>, custom_hash&gt; um;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-1-3-pair-lt-int-int-gt-的哈希函数重载"><a href="#4-2-1-3-pair-lt-int-int-gt-的哈希函数重载" class="headerlink" title="4.2.1.3. pair&lt;int, int&gt; 的哈希函数重载"></a>4.2.1.3. pair&lt;int, int&gt; 的哈希函数重载</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hashfunc</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> U&gt;</span><br><span class="line">    <span class="function"><span class="keyword">size_t</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="keyword">const</span> pair&lt;T, U&gt; &amp;i)</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hash&lt;T&gt;()(i.first) ^ hash&lt;U&gt;()(i.second);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">unordered_map</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;, <span class="keyword">int</span> , hashfunc &gt; mp;</span><br></pre></td></tr></table></figure>



<h2 id="4-3-BM线性递推"><a href="#4-3-BM线性递推" class="headerlink" title="4.3. BM线性递推"></a>4.3. BM线性递推</h2><h3 id="4-3-1-膜质数"><a href="#4-3-1-膜质数" class="headerlink" title="4.3.1. 膜质数"></a>4.3.1. 膜质数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SZ(x) ((int)(x).size())</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,a,n) for (int i=a;i&lt;n;i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; VI;</span><br><span class="line"><span class="keyword">const</span> ll mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="function">ll <span class="title">powmod</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span>; a %= mod; assert(b&gt;=<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, (a *= a) %= mod) <span class="keyword">if</span>(b&amp;<span class="number">1</span>) (res *= a) %= mod;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> linear_seq</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">40010</span>;</span><br><span class="line">    ll res[N],base[N],_c[N],_d[N],_md[N];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Md;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(ll *a, ll *b, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k+k; i++) _c[i]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) <span class="keyword">if</span>(a[i])</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; j++) (_c[i+j] += a[i] * b[j]) %= mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = k+k<span class="number">-1</span>; i &gt;= k; i--) <span class="keyword">if</span>(_c[i])</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; SZ(Md); j++) </span><br><span class="line">            (_c[i-k+Md[j]] -= _c[i] * _md[Md[j]]) %= mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) a[i]=_c[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(ll n, VI a, VI b)</span> <span class="comment">// a 系数 b 初值 b[n+1]=a[0]*b[n]+...</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll ans=<span class="number">0</span>, pnt=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> k = SZ(a);</span><br><span class="line">        assert(SZ(a) == SZ(b));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) _md[k<span class="number">-1</span>-i] = -a[i];</span><br><span class="line">        _md[k]=<span class="number">1</span>; Md.clear();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) <span class="keyword">if</span>(_md[i] != <span class="number">0</span>) Md.push_back(i);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) res[i] = base[i] = <span class="number">0</span>;</span><br><span class="line">        res[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>((<span class="number">1l</span>l&lt;&lt;pnt) &lt;= n) pnt++;</span><br><span class="line">        <span class="keyword">for</span>(ll p = pnt; p &gt;= <span class="number">0</span>; p--)</span><br><span class="line">        &#123;</span><br><span class="line">            mul(res, res, k);</span><br><span class="line">            <span class="keyword">if</span>((n&gt;&gt;p) &amp; <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = k<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--) res[i+<span class="number">1</span>] = res[i]; res[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; SZ(Md); j++)</span><br><span class="line">                    (res[Md[j]] -= res[k] * _md[Md[j]]) %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) (ans += res[i] * b[i]) %= mod;</span><br><span class="line">        <span class="keyword">if</span>(ans&lt;<span class="number">0</span>) ans += mod;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">VI <span class="title">BM</span><span class="params">(VI s)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        VI C(1, 1), B(1, 1);</span><br><span class="line">        <span class="keyword">int</span> L = <span class="number">0</span>, m = <span class="number">1</span>, b = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> n = <span class="number">0</span>; n &lt; SZ(s); n++)</span><br><span class="line">        &#123;</span><br><span class="line">            ll d = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= L; i++) (d += (ll)C[i]*s[n-i]) %= mod;</span><br><span class="line">            <span class="keyword">if</span>(d == <span class="number">0</span>) m++;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">2</span>*L &lt;= n)</span><br><span class="line">            &#123;</span><br><span class="line">                VI T = C;</span><br><span class="line">                ll c = mod - d * powmod(b, mod<span class="number">-2</span>) % mod;</span><br><span class="line">                <span class="keyword">while</span>(SZ(C) &lt; SZ(B) + m) C.push_back(<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SZ(B); i++) </span><br><span class="line">                    C[i+m] = (C[i+m] + c*B[i]) % mod;</span><br><span class="line">                L = n+<span class="number">1</span>-L; B = T; b = <span class="keyword">int</span>(d); m = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                ll c = mod - d * powmod(b, mod<span class="number">-2</span>) % mod;</span><br><span class="line">                <span class="keyword">while</span>(SZ(C) &lt; SZ(B) + m) C.push_back(<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SZ(B); i++) C[i+m] = </span><br><span class="line">                    (C[i+m] + c*B[i]) % mod;</span><br><span class="line">                ++m;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> C;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">gao</span><span class="params">(VI a,ll n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        VI c = BM(a);</span><br><span class="line">        c.erase(c.begin());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SZ(c); i++) c[i] = (mod-c[i])%mod;</span><br><span class="line">        <span class="comment">// for(int i = 0; i &lt; c.size(); i++) printf("%d ", c[i]); </span></span><br><span class="line">        <span class="comment">// putchar(10);</span></span><br><span class="line">        <span class="keyword">return</span> solve(n, c, VI(a.begin(), a.begin()+SZ(c)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">32150</span>;</span><br><span class="line"><span class="keyword">int</span> a[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    VI v;</span><br><span class="line"><span class="comment">// 使用方法1：将序列推入vector后调用gao</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, x; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">        v.push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, linear_seq::gao(v, m));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用方法2：已知系数和初值，直接调用solve</span></span><br><span class="line"><span class="comment">// 系数从a0开始、初值从b0开始，下一个数类似对角线相乘</span></span><br><span class="line"><span class="comment">//    ll n; int k;</span></span><br><span class="line"><span class="comment">//    scanf("%lld%d", &amp;n, &amp;k);</span></span><br><span class="line"><span class="comment">//    VI v1, v2;</span></span><br><span class="line"><span class="comment">//    v2.resize(k); v1.resize(k);</span></span><br><span class="line"><span class="comment">//    for(int i = 0; i &lt; k; i++) scanf("%d", &amp;v1[i]);</span></span><br><span class="line"><span class="comment">//    for(int i = 0; i &lt; k; i++) scanf("%d", &amp;v2[i]);</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//    printf("%d\n", linear_seq::solve(n, v1, v2));</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-2-广义BM-膜任意数"><a href="#4-3-2-广义BM-膜任意数" class="headerlink" title="4.3.2. 广义BM-膜任意数"></a>4.3.2. 广义BM-膜任意数</h3><p>例题：<a href="https://ac.nowcoder.com/acm/contest/889/A" target="_blank" rel="noopener">2019牛客多校第九场 A</a></p>
<p>求$\sum_{i=0}^{n}F_i^m\ (mod\ 1000000000)$，其中$F_i$是斐波那契数列的第$i$项。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> SZ(x) ((int)(x).size())</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;ll&gt; VI;</span><br><span class="line"><span class="function">ll <span class="title">powmod</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll res = <span class="number">1</span>; a %= mod; assert(b&gt;=<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, (a *= a) %= mod) <span class="keyword">if</span>(b&amp;<span class="number">1</span>) (res *= a) %= mod;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> linear_seq &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">10010</span>;</span><br><span class="line">    <span class="keyword">using</span> int64 = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line">    <span class="keyword">using</span> vec = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;int64&gt;;</span><br><span class="line">    ll res[N],base[N],_c[N],_md[N];</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Md;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(ll *a, ll *b, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k+k; i++) _c[i]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) <span class="keyword">if</span>(a[i])</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; j++) (_c[i+j] += a[i] * b[j]) %= mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = k+k<span class="number">-1</span>; i &gt;= k; i--) <span class="keyword">if</span>(_c[i])</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; SZ(Md); j++) </span><br><span class="line">            (_c[i-k+Md[j]] -= _c[i] * _md[Md[j]]) %= mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) a[i]=_c[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(ll n, VI a, VI b)</span> <span class="comment">// a 系数 b 初值 b[n+1]=a[0]*b[n]+...</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll ans=<span class="number">0</span>, pnt=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> k = SZ(a);</span><br><span class="line">        assert(SZ(a) == SZ(b));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) _md[k<span class="number">-1</span>-i] = -a[i];</span><br><span class="line">        _md[k]=<span class="number">1</span>; Md.clear();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) <span class="keyword">if</span>(_md[i] != <span class="number">0</span>) Md.push_back(i);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) res[i] = base[i] = <span class="number">0</span>;</span><br><span class="line">        res[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>((<span class="number">1l</span>l&lt;&lt;pnt) &lt;= n) pnt++;</span><br><span class="line">        <span class="keyword">for</span>(ll p = pnt; p &gt;= <span class="number">0</span>; p--)</span><br><span class="line">        &#123;</span><br><span class="line">            mul(res, res, k);</span><br><span class="line">            <span class="keyword">if</span>((n&gt;&gt;p) &amp; <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = k<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--) res[i+<span class="number">1</span>] = res[i]; res[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; SZ(Md); j++)</span><br><span class="line">                    (res[Md[j]] -= res[k] * _md[Md[j]]) %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) (ans += res[i] * b[i]) %= mod;</span><br><span class="line">        <span class="keyword">if</span>(ans&lt;<span class="number">0</span>) ans += mod;</span><br><span class="line">        <span class="keyword">return</span> (<span class="keyword">int</span>)ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">VI <span class="title">BM</span><span class="params">(VI s)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        VI C(1, 1), B(1, 1);</span><br><span class="line">        <span class="keyword">int</span> L = <span class="number">0</span>, m = <span class="number">1</span>, b = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> n = <span class="number">0</span>; n &lt; SZ(s); n++)</span><br><span class="line">        &#123;</span><br><span class="line">            ll d = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= L; i++) (d += (ll)C[i]*s[n-i]) %= mod;</span><br><span class="line">            <span class="keyword">if</span>(d == <span class="number">0</span>) m++;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">2</span>*L &lt;= n)</span><br><span class="line">            &#123;</span><br><span class="line">                VI T = C;</span><br><span class="line">                ll c = mod - d * powmod(b, mod<span class="number">-2</span>) % mod;</span><br><span class="line">                <span class="keyword">while</span>(SZ(C) &lt; SZ(B) + m) C.push_back(<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SZ(B); i++) </span><br><span class="line">                    C[i+m] = (C[i+m] + c*B[i]) % mod;</span><br><span class="line">                L = n+<span class="number">1</span>-L; B = T; b = <span class="keyword">int</span>(d); m = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                ll c = mod - d * powmod(b, mod<span class="number">-2</span>) % mod;</span><br><span class="line">                <span class="keyword">while</span>(SZ(C) &lt; SZ(B) + m) C.push_back(<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SZ(B); i++) </span><br><span class="line">                    C[i+m] = (C[i+m] + c*B[i]) % mod;</span><br><span class="line">                ++m;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> C;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">extand</span><span class="params">(vec &amp;a, <span class="keyword">size_t</span> d, int64 value = <span class="number">0</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (d &lt;= a.size()) <span class="keyword">return</span>;</span><br><span class="line">        a.resize(d, value);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(int64 a, int64 b, int64 &amp;g, int64 &amp;x, int64 &amp;y)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!b) &#123;x = <span class="number">1</span>; y = <span class="number">0</span>; g = a;&#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            exgcd(b, a%b, g, y, x);</span><br><span class="line">            y -= x * (a / b);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> int64 <span class="title">crt</span><span class="params">(<span class="keyword">const</span> vec &amp;c, <span class="keyword">const</span> vec &amp;m)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = SZ(c);</span><br><span class="line">        int64 M = <span class="number">1</span>, ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) M *= m[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            int64 x, y, g, tm = M / m[i];</span><br><span class="line">            exgcd(tm, m[i], g, x, y);</span><br><span class="line">            ans = (ans + tm * x * c[i] % M) % M;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (ans + M) % M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> vec <span class="title">ReedsSloane</span><span class="params">(<span class="keyword">const</span> vec &amp;s, int64 mod)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> inverse = [](int64 a, int64 m)</span><br><span class="line">        &#123;</span><br><span class="line">            int64 d, x, y;</span><br><span class="line">            exgcd(a, m, d, x, y);</span><br><span class="line">            <span class="keyword">return</span> d == <span class="number">1</span> ? (x % m + m) % m : <span class="number">-1</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">auto</span> L = [](<span class="keyword">const</span> vec &amp;a, <span class="keyword">const</span> vec &amp;b)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> da = (a.size() &gt; <span class="number">1</span> || (a.size() == <span class="number">1</span> &amp;&amp; a[<span class="number">0</span>])) ? </span><br><span class="line">                SZ(a) - <span class="number">1</span> : <span class="number">-1000</span>;</span><br><span class="line">            <span class="keyword">int</span> db = (b.size() &gt; <span class="number">1</span> || (b.size() == <span class="number">1</span> &amp;&amp; b[<span class="number">0</span>])) ? </span><br><span class="line">                SZ(b) : <span class="number">-1000</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">std</span>::max(da, db + <span class="number">1</span>);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">auto</span> prime_power = [&amp;](<span class="keyword">const</span> vec &amp;s, int64 mod, int64 p, int64 e)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;vec&gt; a(e), b(e), an(e), bn(e), ao(e), bo(e);</span><br><span class="line">            vec t(e), u(e), r(e), to(e, 1), uo(e), pw(e + 1);;</span><br><span class="line">            pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = pw[<span class="number">0</span>] = <span class="number">1</span>; i &lt;= e; ++i) pw[i] = pw[i - <span class="number">1</span>] * p;</span><br><span class="line">            <span class="keyword">for</span> (int64 i = <span class="number">0</span>; i &lt; e; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                a[i] = &#123;pw[i]&#125;; an[i] = &#123;pw[i]&#125;;</span><br><span class="line">                b[i] = &#123;<span class="number">0</span>&#125;; bn[i] = &#123;s[<span class="number">0</span>] * pw[i] % mod&#125;;</span><br><span class="line">                t[i] = s[<span class="number">0</span>] * pw[i] % mod;</span><br><span class="line">                <span class="keyword">if</span> (t[i] == <span class="number">0</span>) &#123;t[i] = <span class="number">1</span>; u[i] = e;&#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">for</span>(u[i] = <span class="number">0</span>; t[i] % p == <span class="number">0</span>; t[i] /= p, ++u[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">size_t</span> k = <span class="number">1</span>; k &lt; SZ(s); k++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> g = <span class="number">0</span>; g &lt; e; ++g)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (L(an[g], bn[g]) &gt; L(a[g], b[g]))</span><br><span class="line">                    &#123;</span><br><span class="line">                        ao[g] = a[e<span class="number">-1</span>-u[g]];</span><br><span class="line">                        bo[g] = b[e<span class="number">-1</span>-u[g]];</span><br><span class="line">                        to[g] = t[e<span class="number">-1</span>-u[g]];</span><br><span class="line">                        uo[g] = u[e<span class="number">-1</span>-u[g]];</span><br><span class="line">                        r[g] = k - <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                a = an; b = bn;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> o = <span class="number">0</span>; o &lt; e; ++o)</span><br><span class="line">                &#123;</span><br><span class="line">                    int64 d = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; a[o].size() &amp;&amp; i &lt;= k; i++) &#123;</span><br><span class="line">                        d = (d + a[o][i] * s[k - i]) % mod;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(d == <span class="number">0</span>) &#123;t[o] = <span class="number">1</span>; u[o] = e;&#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">for</span>(u[o] = <span class="number">0</span>, t[o] = d; t[o] % p == <span class="number">0</span>; t[o] /= p)</span><br><span class="line">                            ++u[o];</span><br><span class="line">                        <span class="keyword">int</span> g = <span class="keyword">int</span>(e - <span class="number">1</span> - u[o]);</span><br><span class="line">                        <span class="keyword">if</span>(L(a[g], b[g]) == <span class="number">0</span>)</span><br><span class="line">                        &#123;</span><br><span class="line">                            extand(bn[o], k + <span class="number">1</span>);</span><br><span class="line">                            bn[o][k] = (bn[o][k] + d) % mod;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                        &#123;</span><br><span class="line">                            int64 coef = t[o] * inverse(to[g], mod) % mod</span><br><span class="line">                                * pw[u[o] - uo[g]] % mod;</span><br><span class="line">                            <span class="keyword">int</span> m = <span class="keyword">int</span>(k - r[g]);</span><br><span class="line">                            extand(an[o], ao[g].size() + m);</span><br><span class="line">                            extand(bn[o], bo[g].size() + m);</span><br><span class="line">                            <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; ao[g].size(); i++)</span><br><span class="line">                            &#123;</span><br><span class="line">                                an[o][i + m] -= coef * ao[g][i] % mod;</span><br><span class="line">                                <span class="keyword">if</span> (an[o][i + m] &lt; <span class="number">0</span>) an[o][i + m] += mod;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">while</span> (an[o].size() &amp;&amp; an[o].back() == <span class="number">0</span>)</span><br><span class="line">                                an[o].pop_back();</span><br><span class="line">                            <span class="keyword">for</span>(<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; bo[g].size(); i++)</span><br><span class="line">                            &#123;</span><br><span class="line">                                bn[o][i + m] -= coef * bo[g][i] % mod;</span><br><span class="line">                                <span class="keyword">if</span>(bn[o][i + m] &lt; <span class="number">0</span>) bn[o][i + m] -= mod;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">while</span>(bn[o].size() &amp;&amp; bn[o].back() == <span class="number">0</span>)</span><br><span class="line">                                bn[o].pop_back();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">std</span>::make_pair(an[<span class="number">0</span>], bn[<span class="number">0</span>]);</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::tuple&lt;int64, int64, <span class="keyword">int</span>&gt;&gt; fac;</span><br><span class="line">        <span class="keyword">for</span>(int64 i = <span class="number">2</span>; i * i &lt;= mod; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (mod % i == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                int64 cnt = <span class="number">0</span>, pw = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">while</span> (mod % i == <span class="number">0</span>) &#123;mod /= i; ++cnt; pw *= i;&#125;</span><br><span class="line">                fac.emplace_back(pw, i, cnt);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (mod &gt; <span class="number">1</span>) fac.emplace_back(mod, mod, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;vec&gt; as;</span><br><span class="line">        <span class="keyword">size_t</span> n = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;&amp;x: fac)</span><br><span class="line">        &#123;</span><br><span class="line">            int64 mod, p, e;</span><br><span class="line">            vec a, b;</span><br><span class="line">            <span class="built_in">std</span>::tie(mod, p, e) = x;</span><br><span class="line">            <span class="keyword">auto</span> ss = s;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;&amp;x: ss) x %= mod;</span><br><span class="line">            <span class="built_in">std</span>::tie(a, b) = prime_power(ss, mod, p, e);</span><br><span class="line">            as.emplace_back(a);</span><br><span class="line">            n = <span class="built_in">std</span>::max(n, a.size());</span><br><span class="line">        &#125;</span><br><span class="line">        vec a(n), c(as.size()), m(as.size());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">size_t</span> j = <span class="number">0</span>; j &lt; as.size(); ++j)</span><br><span class="line">            &#123;</span><br><span class="line">                m[j] = <span class="built_in">std</span>::get&lt;<span class="number">0</span>&gt;(fac[j]);</span><br><span class="line">                c[j] = i &lt; as[j].size() ? as[j][i] : <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            a[i] = crt(c, m);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">gao</span><span class="params">(VI a, ll n, ll mod, <span class="keyword">bool</span> prime = <span class="literal">true</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        VI c;</span><br><span class="line">        <span class="keyword">if</span>(prime) c = BM(a);</span><br><span class="line">        <span class="keyword">else</span> c = ReedsSloane(a, mod);</span><br><span class="line">        c.erase(c.begin());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SZ(c); i++) c[i] = (mod - c[i]) % mod;</span><br><span class="line">        <span class="comment">// for(int i = 0; i &lt; SZ(c); i++) printf("%lld ", c[i]); </span></span><br><span class="line">        <span class="comment">// putchar(10);</span></span><br><span class="line">        <span class="keyword">return</span> solve(n, c, VI(a.begin(), a.begin()+SZ(c)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll n, m; <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">vector</span>&lt;ll&gt; v; v.pb(<span class="number">0</span>); v.pb(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; <span class="number">1000</span>; ++i) v.pb((v[i<span class="number">-1</span>] + v[i<span class="number">-2</span>]) % mod);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">1000</span>; ++i) v[i] = powmod(v[i],m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">1000</span>; ++i) v[i] = (v[i<span class="number">-1</span>] + v[i]) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, linear_seq::gao(v,n,mod,<span class="literal">false</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-3-常系数齐次线性递推"><a href="#4-3-3-常系数齐次线性递推" class="headerlink" title="4.3.3. 常系数齐次线性递推"></a>4.3.3. 常系数齐次线性递推</h3><p>求一个满足 $k$ 阶齐次线性递推数列 ${a_i}$ 的第 $n$ 项，即：<br>$$<br>a_n=\sum_{i=1}^{k}f_i\cdot a_{n-i}<br>$$<br>注：以下算法中的 $solve()$ 函数可嵌套到上面的BM中替代其 $solve()$ 函数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Vec;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> Mo = <span class="number">998244353</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; (x += y) &gt;= Mo &amp;&amp; (x -= Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; (x -= y) &lt; <span class="number">0</span> &amp;&amp; (x += Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &gt;= Mo ? x - Mo : x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dec</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &lt; <span class="number">0</span> ? x + Mo : x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Mod</span><span class="params">(<span class="keyword">int</span> &amp;x)</span> </span>&#123; x &gt;= Mo &amp;&amp; (x -= Mo); x &lt; <span class="number">0</span> &amp;&amp; (x += Mo); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> mo = Mo)</span> </span>&#123;<span class="keyword">return</span> <span class="number">1l</span>l * x * y % mo; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">pow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k, <span class="keyword">int</span> mo = Mo)</span> <span class="comment">// 普通快速幂模版</span></span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> mo = Mo)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">pow</span>(x, mo - <span class="number">2</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> NTT <span class="comment">// 省略NTT模版</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> NTT;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Poly <span class="comment">// 需要用到的多项式模版</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> Vec <span class="title">fix</span><span class="params">(Vec a, <span class="keyword">int</span> b)</span></span></span><br><span class="line">    Vec operator - (Vec a, Vec b)</span><br><span class="line">    Vec <span class="keyword">operator</span> *(Vec a, Vec b)</span><br><span class="line">    Vec <span class="keyword">operator</span> ~ (Vec a)</span><br><span class="line">    Vec <span class="keyword">operator</span> / (Vec a, Vec b)</span><br><span class="line">    Vec <span class="keyword">operator</span> % (Vec a, Vec b)</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(Vec a)</span></span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Poly;</span><br><span class="line">Vec a;</span><br><span class="line"></span><br><span class="line"><span class="function">Vec <span class="title">ksm</span><span class="params">(Vec a, <span class="keyword">int</span> b, Vec c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">Vec <span class="title">res</span><span class="params">(<span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = a * a % c) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) res = res * a % c;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n, Vec a, Vec b)</span> <span class="comment">// a 系数 b 初值 b[n+1]=a[0]*b[n]...</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = (<span class="keyword">int</span>)a.size();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) a[i] = (Mo - a[i]) % Mo;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) b[i] = (b[i] + Mo) % Mo;</span><br><span class="line">    reverse(a.begin(), a.end());</span><br><span class="line">    a.push_back(<span class="number">1</span>);</span><br><span class="line">    a = ksm(Vec(&#123;<span class="number">0</span>, <span class="number">1</span>&#125;), n, a);</span><br><span class="line">    a.resize(k);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) add(ans, mul(a[i], b[i]));</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    Vec f(k), a(k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) f[i] = read();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) a[i] = read();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, solve(n, f, a));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-4-斐波那契循环节"><a href="#4-4-斐波那契循环节" class="headerlink" title="4.4. 斐波那契循环节"></a>4.4. 斐波那契循环节</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment">  注释部分为F(i)=2F(i-1)+F(i-2)的代码</span></span><br><span class="line"><span class="comment">  前几项：0 1 2 5 12 29 70 169 408</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">ll <span class="title">gcd</span> <span class="params">(ll a, ll b)</span> </span>&#123; <span class="keyword">return</span> b ? gcd (b, a % b) : a; &#125;</span><br><span class="line">    <span class="function">ll <span class="title">Pow</span> <span class="params">(ll a, ll b, ll c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll resl = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(; b; b &gt;&gt;= <span class="number">1</span>, a = a * a % c) <span class="keyword">if</span> (b &amp; <span class="number">1</span>) resl = resl * a % c;</span><br><span class="line">        <span class="keyword">return</span> resl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">namespace</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tot;</span><br><span class="line">        <span class="keyword">bool</span> num[N];</span><br><span class="line">        ll pri[N];</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">PrimeGenerate</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(!num[i]) pri[++tot] = i;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * pri[j] &lt; N; j += <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    num[i * pri[j]] = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">if</span>(i % pri[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="comment">// Generate Primes in O (n)</span></span><br><span class="line">    &#125;<span class="comment">// Prime Generate</span></span><br><span class="line">&#125;<span class="comment">// Basis Operation</span></span><br><span class="line"><span class="keyword">namespace</span></span><br><span class="line">&#123;</span><br><span class="line">    ll mod;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">int</span> r, c;</span><br><span class="line">        ll m[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">        Matrix () &#123; <span class="built_in">memset</span>(m, <span class="number">0</span>, <span class="keyword">sizeof</span>(m)); &#125;</span><br><span class="line">        Matrix (<span class="keyword">int</span> n, <span class="keyword">int</span> m) :Matrix() &#123; r = n; c = m; &#125;</span><br><span class="line">        Matrix (<span class="keyword">int</span> n) :Matrix() &#123; r = c = n; m[<span class="number">0</span>][<span class="number">0</span>] = m[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1l</span>l; &#125;</span><br><span class="line">        Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix &amp;o) <span class="keyword">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            Matrix res = Matrix(r, o.c);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; o.c; j++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; c; k++)</span><br><span class="line">                    &#123;</span><br><span class="line">                        res.m[i][j] += <span class="number">1l</span>l * m[i][k] * o.m[k][j] % mod;</span><br><span class="line">                        <span class="keyword">if</span>(res.m[i][j] &gt; mod) res.m[i][j] -= mod;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        Matrix <span class="keyword">operator</span> ^ (ll o) <span class="keyword">const</span></span><br><span class="line">        &#123;</span><br><span class="line">            Matrix a = *<span class="keyword">this</span>, resl = Matrix(r);</span><br><span class="line">            <span class="keyword">for</span>(; o; o &gt;&gt;= <span class="number">1</span>, a = a * a) <span class="keyword">if</span> (o &amp; <span class="number">1</span>) resl = resl * a;</span><br><span class="line">            <span class="keyword">return</span> resl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">ll <span class="title">Fib</span><span class="params">(ll n, ll Mod)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span> || n == <span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        mod = Mod; n -= <span class="number">1</span>;</span><br><span class="line">        Matrix a = Matrix(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">        a.m[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        Matrix b = Matrix(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">        b.m[<span class="number">0</span>][<span class="number">0</span>] = b.m[<span class="number">1</span>][<span class="number">0</span>] = b.m[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">          b.m[0][0] = 2;</span></span><br><span class="line"><span class="comment">          b.m[1][0] = b.m[0][1] = 1;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        a = (b ^ n) * a;</span><br><span class="line">        <span class="keyword">return</span> a.m[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">//Get The Fibnacci Sequence !</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">char</span> ch[N*<span class="number">300</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Read</span><span class="params">()</span> </span>&#123; <span class="built_in">scanf</span>(<span class="string">"%s"</span>, ch); &#125;</span><br><span class="line">    <span class="function">ll <span class="title">Int</span><span class="params">(ll p)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch[pos])) pos++;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch[pos]))</span><br><span class="line">        &#123;</span><br><span class="line">            res = (res * <span class="number">10</span> + ch[pos] - <span class="string">'0'</span>) % p;</span><br><span class="line">            pos++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="comment">// Big Integer</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span></span><br><span class="line">&#123;</span><br><span class="line">    ll Fac[N]; <span class="keyword">int</span> cnt;</span><br><span class="line">    <span class="function">ll <span class="title">Judge</span><span class="params">(ll k, ll p)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(ll i = <span class="number">1</span>; i * i &lt;= k; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(k % i) <span class="keyword">continue</span>;</span><br><span class="line">            Fac[cnt++] = i;</span><br><span class="line">            <span class="keyword">if</span>(i * i &lt; k) Fac[cnt++] = k / i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::sort(Fac, Fac + cnt);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt; i++) </span><br><span class="line">            <span class="keyword">if</span>(Fib(Fac[i] + <span class="number">5</span>, p) == <span class="number">5</span>) <span class="keyword">return</span> Fac[i];</span><br><span class="line">        <span class="comment">// 判断 Fib(Fac[i]+5) 是否等于 Fib(5)=5%p</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">          for(int i = 0; i &lt; cnt; i++) </span></span><br><span class="line"><span class="comment">              if(Fib(Fac[i] + 3, p) == 5) return Fac[i];</span></span><br><span class="line"><span class="comment">          // 判断 F(Fac[i]+3) 是否等于 F(3)=5</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> ll Rest[<span class="number">6</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">20</span>&#125;; <span class="comment">// 前5个数的循环节</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">      const ll Rest[6] = &#123;0, 1, 2, 8, 4, 12&#125;;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="function">ll <span class="title">g</span><span class="params">(ll p)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(p &lt;= <span class="number">5</span>) <span class="keyword">return</span> Rest[p];</span><br><span class="line">        <span class="keyword">if</span>(Pow(<span class="number">5</span>, (p - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, p) == <span class="number">1</span>) <span class="keyword">return</span> Judge(p<span class="number">-1</span>, p);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> Judge ((p + <span class="number">1</span>) &lt;&lt; <span class="number">1</span>, p);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">Get</span><span class="params">(ll p)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        PrimeGenerate();</span><br><span class="line">        ll tmp, pre;</span><br><span class="line">        ll lcm = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tot &amp;&amp; pri[i] * pri[i] &lt;= p; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(p % pri[i]) <span class="keyword">continue</span>; pre = p / pri[i];</span><br><span class="line">            <span class="keyword">while</span>(p % pri[i] == <span class="number">0</span>) p /= pri[i];</span><br><span class="line">            tmp = g(pri[i]) * (pre / p);</span><br><span class="line">            lcm = lcm / gcd(lcm, tmp) * tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(p &gt; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            tmp = g(p);</span><br><span class="line">            lcm = lcm * tmp / gcd(lcm, tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> lcm;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// Get the Mod Sum;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Read(); <span class="keyword">long</span> <span class="keyword">long</span> Mod, A, M;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;Mod);</span><br><span class="line">    M = Get(Mod); <span class="comment">// M即为最小循环节</span></span><br><span class="line">    A = Int(M);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, Fib(A, Mod));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color4">ACM</a>
        		</li>
      		
		</ul>
	</div>

      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/数学模版//" class="article-tag-list-link color5">数学模版</a>
        		</li>
      		
		</ul>
	</div>


      
        <p class="article-more-link">
          <a class="article-more-a" href="/2020/03/11/%E6%95%B0%E5%AD%A6%E6%A8%A1%E7%89%88/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
  


          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2020 GoatWu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: true,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(195),t.exports=r(191)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(203);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="​",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}if(yiliaConfig&&yiliaConfig.toc_hide_index){document.querySelectorAll(".toc-number").forEach(function(t){t.style.display="none"})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(382)),d=e(p),y=r(128),g=e(y),b=r(190),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(381),r(391),r(198),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(210),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(202);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(208),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(209)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){
if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(204))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(206),g=r(205),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){
return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(207),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(330),r(269),r(271),r(270),r(273),r(275),r(280),r(274),r(272),r(282),r(281),r(277),r(278),r(276),r(268),r(279),r(283),r(284),r(236),r(238),r(237),r(286),r(285),r(256),r(266),r(267),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(317),r(322),r(329),r(320),r(312),r(313),r(318),r(323),r(325),r(308),r(309),r(310),r(311),r(314),r(315),r(316),r(319),r(321),r(324),r(326),r(327),r(328),r(231),r(233),r(232),r(235),r(234),r(220),r(218),r(224),r(221),r(227),r(229),r(217),r(223),r(214),r(228),r(212),r(226),r(225),r(219),r(222),r(211),r(213),r(216),r(215),r(230),r(155),r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.0cf68a.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.e37972.js")}()</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友链</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">ACM</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">数学模版</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">比赛题解</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接1</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接2</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接3</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接4</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接5</a>
            </li>
          
            <li class="search-li">
              <a href="http://localhost:4000/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接6</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">&lt;center&gt;XMU ACMer&lt;center/&gt;&lt;br/&gt;</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>